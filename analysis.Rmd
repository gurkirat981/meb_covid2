---
title: "Analysis of MEB COVID Survey 2"
author: "MEB Team"
date: "29 December 2021"
output:
  pdf_document: default
  html_document:
    df_print: paged
---
\Large 

Notes:

1. This document contains aggregate graphs for all survey questions weighted by share of IAS officers in each state.

2. Questions 13 which asked "Dealing with any pandemic of this scale is a collective responsibility and everyone has a part to play. However, in the final analysis, who do you think must shoulder a greater share of responsibility for any shortcomings?" has been
excluded from the analysis because we received only partial responses.

3. Questions 4,5 and 6 can be depicted at the time of design using a map of India with colour markers indicating the percentage of responses that each state received

4. Sample: Number of responses from serving officers = 452,  Number of responses from former officers = 96

5. Of the serving officers who responded to this survey, 147 (33%) had also filled last year's survey while 305 officers (67%) responded to our survey for the first time.

6. Of the former officers who responded to this survey, 25 (26%) also participated in our survey last year while 71 (74%) filled our survey for the first time this year.

\newpage
\tableofcontents 

```{r setup, include=FALSE} 
knitr::opts_chunk$set(echo = FALSE)

library(cowplot)
library(tidyverse)
library(ggplot2)
library(MASS)
library(ggrepel)
library(RColorBrewer)
library(stargazer)
library(DeclareDesign)
library(texreg)
library(car)
library(lubridate)
library(scales)
library(cowplot)
library(writexl)
library(janitor)
library(gridExtra)
library(grid)
library(ggpubr)
```

```{r, include=FALSE}
#Importing data
raw_dta <- read_csv("meb2data_9dec.csv", col_names = FALSE)
```

```{r, include=FALSE}
#Clean up: deleting extra columns, merging the state related questions, deleting the old state columns, removing all incomplete answers, adding two filters to ensure only responses by currently serving IAS officers
processed_dta<-raw_dta[-c(1,2),-c(2, 5:8,15,140,141)]%>%
  unite('Merged1', X19:X55, remove=FALSE, na.rm=TRUE) %>% 
  unite('Merged2', X56:X92, remove = FALSE, na.rm=TRUE) %>%
  unite('Merged3',X93:X129, remove=FALSE, na.rm=TRUE) %>% 
  dplyr::select(-c(X19:X55)) %>%
  dplyr::select(-c(X56:X92)) %>%
  dplyr::select(-c(X93:X129)) %>%
  filter(!is.na(X139))%>% #This is to filter out incomplete responses.
  filter(X10=="Yes") %>% 
  separate(Merged1, c('Merged1.1', 'Merged1.2'), sep = "([_])") %>%
  separate(Merged2, c('Merged2.1', 'Merged2.2'), sep = "([_])") 
```

```{r, include=FALSE}
#Checking for outliers 
#Batch outliers
hist(as.numeric(raw_dta$X11), col="#ccf5ff", border=F, xlab="Year of Joining", ylab = "Frequency", main= "Distribution of IAS Batches")
#None

#Respondents who sped through the survey (min time = 3 minutes)
processed_dta$time_spent<-mdy_hms(processed_dta$X4, tz="Asia/Kolkata")- mdy_hms(processed_dta$X3, tz="Asia/Kolkata")
processed_dta<-processed_dta %>%
  mutate(speeders=ifelse(time_spent<3, 1, 0)) 
#Decided not to exclude anyone on this basis

#The number of NA responses for each question in the processed data
processed_dta %>% 
  dplyr::select(everything()) %>% 
  summarise_all(funs(sum(is.na(.))))
#Column X136 has 69 NAs, all others have zero.
```

```{r}
#Demographics
lastyear_former<-processed_dta$X14[processed_dta$X13=="No, I am a former IAS officer"]
cadre_former<- processed_dta$X12[processed_dta$X13=="No, I am a former IAS officer"]
former<-data.frame(lastyear_former,  cadre_former)

former<-former %>% 
  group_by(cadre_former) %>% 
  summarise(Yes = sum(lastyear_former=="Yes"),               
            No = sum(lastyear_former=="No"), 
            "Yes Percent"= round(Yes/sum(Yes, No)*100,2), 
            "No Percent"= round(No/sum(Yes, No)*100,2)) 

lastyear_serving<-processed_dta$X14[processed_dta$X13=="Yes, currently serving"]
cadre_serving<- processed_dta$X12[processed_dta$X13=="Yes, currently serving"]
serving<-data.frame(lastyear_serving,  cadre_serving)

serving<-serving %>% 
  group_by(cadre_serving) %>% 
  summarise(Yes = sum(lastyear_serving=="Yes"),               
            No = sum(lastyear_serving=="No"), 
            "Yes Percent"= round(Yes/sum(Yes, No)*100,2), 
            "No Percent"= round(No/sum(Yes, No)*100,2))
```

```{r, include=FALSE}
#Definining new themes to be used for our ggplots later 
newtheme <- theme_bw() +
  theme(panel.border = element_rect(color = "darkgrey", size = 2), 
        panel.grid.major = element_blank()
        
        )

disaggtheme <- theme_bw() +
  theme(panel.border = element_rect(color = "darkgrey", size = 2), 
        panel.grid.major = element_blank(), 
        axis.text=element_text(size=20),
        axis.title=element_text(size=20), 
        plot.title=element_text(size=25, face="bold"), 
        legend.title = element_blank(),
        legend.text = element_text(size=27, 
    margin = margin(b = 10, unit = "pt"))
        )
```

```{r, include=FALSE}
#Recoding answer options from character strings to numeric values for the processed_dta 
#Q7 (X16) #Q8 (X17) #Q9 (X18) #Q13 (X130) #Q15 (X132)  #Q16 (X133) #Q17 (X134) #Q18 (X135) #Q20 (X137) #Q21 (X138) #Q22 (X139)
#Deleting Q19 (X136) since this is the error question 

processed_dta<-processed_dta %>% 
  mutate(X16 = ifelse(X16== "The second Covid-19 surge was expected and should have seen much more advance planning.", 1, 2)) %>% 
  mutate(X17 = ifelse(X17 =="Even proposals for advance planning received little purchase in the last one year.",1,
                      ifelse(X17 =="Planning got lost mid-way due to signals that we have managed the pandemic well.", 2,
                             ifelse(X17 == "Systematic advance planning has never been part of our ethos.", 3, 4)))) %>%
  mutate(X18 = ifelse(X18 == "Building health system preparedness was not adequately prioritised.",1,
                      ifelse(X18=="Health system preparedness increased but was overwhelmed by the unprecedented scale of the infection.", 2, 
                             ifelse(X18=="Health system preparedness increased substantially and performed adequately.", 3, 4)))) %>%                            
  mutate(X130 = ifelse(X130=="Resources and autonomy can always be generated if only the system were to positively acknowledge initiative and motivation as a rule.", 1, 2)) %>% 
  mutate(X131 =ifelse(X131=="Knowing the risks involved, such events should not have been scheduled at all.",1,
                      ifelse(X131=="The risks from these events were too high. They could have been managed better (perhaps by staggering the events or by curtailing participation).", 2,
                             ifelse(X131=="The surge was caused by a natural progression of the virus. Prohibiting these events would not have prevented this surge.", 3,4)))) %>% 
  mutate(X132 = ifelse(X132=="Given the lack of consensus in our democracy, any other course of action would have resulted in unnecessary chaos and confusion among the public.", 1, 2)) %>% 
  mutate (X133= ifelse (X133 == "During the pandemic, policy has exhibited a rational response to changing evidence and information about the pandemic.", 1, 
                      ifelse(X133 == "Even though the pandemic posed unique challenges, policy making could still be characterised as ad hoc, responding to political imperatives, public pressure and judicial pronouncements.", 2, 3))) %>%
  mutate (X134 = ifelse (X134 == "India has successfully followed this nationally laid down trajectory of vaccine implementation.", 1, 
                       ifelse(X134 == "Our vaccination efforts have been adequate in following this trajectory though some states could have done better.", 2, 
                              ifelse(X134 == "Our vaccination policy implementation has been less than satisfactory because of poor performance at state level.", 3, 4)))) %>% 
  mutate (X135 = ifelse (X135 == "We could at least use our networks to render some assistance at an individual level.", 1, 
                       ifelse(X135 == "We should have done so much more to improve the system when we had the time.", 2, 
                              ifelse(X135 == "We were as deprived and helpless as the ordinary citizen, in the face of this utter collapse of the health care system.", 3, 4)))) %>%
  mutate (X137 = ifelse (X137 == "The government’s fiscal situation did not permit such measures.", 1, 
                       ifelse(X137 == "The pandemic’s limited initial impact led to a view that mass vaccination would not be urgently required in India.", 2, 
                              ifelse(X137 == "The private sector in India does not inspire confidence.", 3, 4)))) %>% 
  mutate (X138 = ifelse (X138 == "Slightly agree", 1, 
                       ifelse(X138 == "Slightly disagree", 2, 
                              ifelse(X138 == "Strongly agree", 3, 4)))) %>%
  mutate (X139 = ifelse (X139 == "By focussing on failures in pandemic management, the media has exaggerated the sense of failure and despair.", 1, 
                       ifelse(X139 == "The media has failed to capture the full scale and intensity of the disaster.", 2, 3))) %>% 
  dplyr::select(-X136)
```

```{r, include=FALSE}
#Data Wrangling
set.seed(24102020)
#Creating a dataset of currently serving officers with columns indicating (1) the allocated state (2) their SDG classification and (3) the age of the officers
full_serving <- processed_dta %>% 
  filter(X13=="Yes, currently serving") 

#New code for AGMUT and  AM allocation, done by creating subsets 
#Creating a subset of just AGMUT responses to allocate states to 
agmut_fullserving <- full_serving %>% 
  subset(X12=="AGMUT") %>% 
  mutate(state=sample(c(rep("Delhi",10), rep("Arunachal Pradesh",5),  rep("Mizoram",4), rep("Goa",3), rep("DNH and DD",2) ,rep("Chandigarh",1), rep("Andaman and Nicobar Islands",1), rep("Lakshadweep Islands",1), rep("Puducherry",1)), size = length(which(full_serving$X12=="AGMUT")), replace = FALSE))

#Creating a subset of just AM responses to allocate states to 
am_fullserving <- full_serving %>% 
  subset(X12=="Assam Meghalaya") %>% 
  mutate(state=sample(c(rep("Assam",10), rep("Meghalaya", 5))))

#Creating a subset of all responses except from AGMUT and AM to merge
nocombined_full_serving <- full_serving %>% 
  subset(!X12=="AGMUT") %>% 
  subset(!X12=="Assam Meghalaya")

#Merging the three above subsets to get the desired full_serving dataset with correct state allocations and adding a column indicating the SDG classification and age bracket 
full_serving <- nocombined_full_serving %>% 
  mutate(state=X12) %>% 
  add_row(am_fullserving) %>% 
  add_row(agmut_fullserving) %>% 
  mutate(sdg = ifelse(state== "Uttar Pradesh" | state=="Bihar" | state =="Assam", "Aspirant", 
                       ifelse(state=="Puducherry"|state=="Tamil Nadu"| state=="Chandigarh"| state=="Himachal Pradesh"|state=="Kerala", "Frontrunner", "Performer"))) %>% 
   mutate(age = ifelse(X11>2011, "2012 and after", "2011 and before"))

#Creating a dataset of former IAS officers and adding the same three columns as above to help with merging the two datasets 
full_former<-processed_dta %>% 
  filter(X13=="No, I am a former IAS officer") %>% 
  mutate(state = NA) %>% #state and sdg are kept NA for now. However we can make these allocations if needed
  mutate(sdg = NA) %>% 
  mutate(age ="Former officer")
```

```{r}
#Creating subsets

#SDG subsets
#Dataset of aspirant states 
fullsdg_aspirant <- full_serving %>% 
  filter(sdg == "Aspirant") #46 observations 

#Dataset of performer states
fullsdg_performer <- full_serving %>% 
  filter(sdg == "Performer") #313 observations

#Dataset of frontrunner states
fullsdg_frunner <- full_serving %>% 
  filter(sdg == "Frontrunner") #65 observations 

#Age subsets
#Dataset of young officers
fullage_young <- full_serving %>% 
  filter(age == "2012 and after") #231

#Dataset with old officers
fullage_old <- full_serving %>% 
  filter(age == "2011 and before") #193

#Dataset of all respondents, former and currently serving with columns for state, sdg and age 
full_respondents<- full_serving %>% 
  add_row(full_former)
```

```{r, include=FALSE}
#Creating a dataset with the averages for each answer choice for all questions
#Used to check with Survey Monkey 
summary_nogroup<-full_serving %>% 
  dplyr::select(c(X16, X17, X18, X130, X131, X132, X133, X134, X135, X137, X138, X139)) %>% 
  summarise(X16ones=sum(X16==1)/length(X16), X16twos=sum(X16==2)/length(X16),
            X17ones=sum(X17==1)/length(X17), X17twos=sum(X17==2)/length(X17), X17threes=sum(X17==3)/length(X17), X17fours=sum(X17==4)/length(X17),
            X18ones=sum(X18==1)/length(X18), X18twos=sum(X18==2)/length(X18), X18threes=sum(X18==3)/length(X18), X18fours=sum(X18==4)/length(X18), 
            X130ones=sum(X130==1)/length(X130), X130twos=sum(X130==2)/length(X130),
            X131ones=sum(X131==1)/length(X131), X131twos=sum(X131==2)/length(X131), X131threes=sum(X131==3)/length(X131), X131fours=sum(X131==4)/length(X131), 
            X132ones=sum(X132==1)/length(X132), X132twos=sum(X132==2)/length(X132),
            X133ones=sum(X133==1)/length(X133), X133twos=sum(X133==2)/length(X133), X133threes=sum(X133==3)/length(X133),
            X134ones=sum(X134==1)/length(X134), X134twos=sum(X134==2)/length(X134), X134threes=sum(X134==3)/length(X134), X134fours=sum(X134==4)/length(X134), 
            X135ones=sum(X135==1)/length(X135), X135twos=sum(X135==2)/length(X135), X135threes=sum(X135==3)/length(X135), X135fours=sum(X135==4)/length(X135),
            X137ones=sum(X137==1)/length(X137), X137twos=sum(X137==2)/length(X137), X137threes=sum(X137==3)/length(X137), X137fours=sum(X137==4)/length(X137),
            X138ones=sum(X138==1)/length(X138), X138twos=sum(X138==2)/length(X138), X138threes=sum(X138==3)/length(X138), X138fours=sum(X138==4)/length(X138),
            X139ones=sum(X139==1)/length(X139), X139twos=sum(X139==2)/length(X139), X139threes=sum(X139==3)/length(X139))%>% 
  ungroup()
```

```{r, include=FALSE}
#Creating a dataset with the averages for each answer choice for all questions grouped by the state 
summary_state<-full_serving %>% 
  dplyr::select(c(X16, X17, X18, X130, X131, X132, X133, X134, X135, X137, X138, X139, state)) %>% 
  group_by(state) %>% 
  summarise(X16ones=sum(X16==1)/length(state), X16twos=sum(X16==2)/length(state),
            X17ones=sum(X17==1)/length(state), X17twos=sum(X17==2)/length(state), X17threes=sum(X17==3)/length(state), X17fours=sum(X17==4)/length(state),
            X18ones=sum(X18==1)/length(state), X18twos=sum(X18==2)/length(state), X18threes=sum(X18==3)/length(state), X18fours=sum(X18==4)/length(state), 
            X130ones=sum(X130==1)/length(state), X130twos=sum(X130==2)/length(state),
            X131ones=sum(X131==1)/length(state), X131twos=sum(X131==2)/length(state), X131threes=sum(X131==3)/length(state), X131fours=sum(X131==4)/length(state), 
            X132ones=sum(X132==1)/length(state), X132twos=sum(X132==2)/length(state),
            X133ones=sum(X133==1)/length(state), X133twos=sum(X133==2)/length(state), X133threes=sum(X133==3)/length(state),
            X134ones=sum(X134==1)/length(state), X134twos=sum(X134==2)/length(state), X134threes=sum(X134==3)/length(state), X134fours=sum(X134==4)/length(state), 
            X135ones=sum(X135==1)/length(state), X135twos=sum(X135==2)/length(state), X135threes=sum(X135==3)/length(state), X135fours=sum(X135==4)/length(state),
            X137ones=sum(X137==1)/length(state), X137twos=sum(X137==2)/length(state), X137threes=sum(X137==3)/length(state), X137fours=sum(X137==4)/length(state),
            X138ones=sum(X138==1)/length(state), X138twos=sum(X138==2)/length(state), X138threes=sum(X138==3)/length(state), X138fours=sum(X138==4)/length(state),
            X139ones=sum(X139==1)/length(state), X139twos=sum(X139==2)/length(state), X139threes=sum(X139==3)/length(state)) %>% 
  ungroup()
```

```{r, include=FALSE}
#For young officers: creating a dataset with the averages for each answer choice for all questions grouped by the state 
summary_state_young<-fullage_young %>% 
  dplyr::select(c(X16, X17, X18, X130, X131, X132, X133, X134, X135, X137, X138, X139, state)) %>% 
  group_by(state) %>% 
  summarise(X16ones=sum(X16==1)/length(state), X16twos=sum(X16==2)/length(state),
            X17ones=sum(X17==1)/length(state), X17twos=sum(X17==2)/length(state), X17threes=sum(X17==3)/length(state), X17fours=sum(X17==4)/length(state),
            X18ones=sum(X18==1)/length(state), X18twos=sum(X18==2)/length(state), X18threes=sum(X18==3)/length(state), X18fours=sum(X18==4)/length(state), 
            X130ones=sum(X130==1)/length(state), X130twos=sum(X130==2)/length(state),
            X131ones=sum(X131==1)/length(state), X131twos=sum(X131==2)/length(state), X131threes=sum(X131==3)/length(state), X131fours=sum(X131==4)/length(state), 
            X132ones=sum(X132==1)/length(state), X132twos=sum(X132==2)/length(state),
            X133ones=sum(X133==1)/length(state), X133twos=sum(X133==2)/length(state), X133threes=sum(X133==3)/length(state),
            X134ones=sum(X134==1)/length(state), X134twos=sum(X134==2)/length(state), X134threes=sum(X134==3)/length(state), X134fours=sum(X134==4)/length(state), 
            X135ones=sum(X135==1)/length(state), X135twos=sum(X135==2)/length(state), X135threes=sum(X135==3)/length(state), X135fours=sum(X135==4)/length(state),
            X137ones=sum(X137==1)/length(state), X137twos=sum(X137==2)/length(state), X137threes=sum(X137==3)/length(state), X137fours=sum(X137==4)/length(state),
            X138ones=sum(X138==1)/length(state), X138twos=sum(X138==2)/length(state), X138threes=sum(X138==3)/length(state), X138fours=sum(X138==4)/length(state),
            X139ones=sum(X139==1)/length(state), X139twos=sum(X139==2)/length(state), X139threes=sum(X139==3)/length(state)) %>% 
  ungroup() %>% 
  add_row(state="Andaman and Nicobar Islands") %>% 
  add_row(state="Chandigarh") %>% 
  add_row(state="Lakshadweep Islands") %>%
  add_row(state="Puducherry") %>% 
  add_row(state="Mizoram") %>% 
  arrange(state) 
#There are no young officers from A and N Islands, Chandigarh, Lakshadweep Islands, Puducherry and Mizoram. The summary produced for young officers, thus, is five rows shorter. In order to cbind this dataset with other (like ias_processed_dta) for weight calculations, we have added these states with NAs to match the number of rows across datasets. This is done for all summaries for young and old officers.
```

```{r, include=FALSE}
#For old officers: creating a dataset with the averages for each answer choice for all questions grouped by the state 
summary_state_old<-fullage_old %>% 
  dplyr::select(c(X16, X17, X18, X130, X131, X132, X133, X134, X135, X137, X138, X139, state)) %>% 
  group_by(state) %>% 
  summarise(X16ones=sum(X16==1)/length(state), X16twos=sum(X16==2)/length(state),
            X17ones=sum(X17==1)/length(state), X17twos=sum(X17==2)/length(state), X17threes=sum(X17==3)/length(state), X17fours=sum(X17==4)/length(state),
            X18ones=sum(X18==1)/length(state), X18twos=sum(X18==2)/length(state), X18threes=sum(X18==3)/length(state), X18fours=sum(X18==4)/length(state), 
            X130ones=sum(X130==1)/length(state), X130twos=sum(X130==2)/length(state),
            X131ones=sum(X131==1)/length(state), X131twos=sum(X131==2)/length(state), X131threes=sum(X131==3)/length(state), X131fours=sum(X131==4)/length(state), 
            X132ones=sum(X132==1)/length(state), X132twos=sum(X132==2)/length(state),
            X133ones=sum(X133==1)/length(state), X133twos=sum(X133==2)/length(state), X133threes=sum(X133==3)/length(state),
            X134ones=sum(X134==1)/length(state), X134twos=sum(X134==2)/length(state), X134threes=sum(X134==3)/length(state), X134fours=sum(X134==4)/length(state), 
            X135ones=sum(X135==1)/length(state), X135twos=sum(X135==2)/length(state), X135threes=sum(X135==3)/length(state), X135fours=sum(X135==4)/length(state),
            X137ones=sum(X137==1)/length(state), X137twos=sum(X137==2)/length(state), X137threes=sum(X137==3)/length(state), X137fours=sum(X137==4)/length(state),
            X138ones=sum(X138==1)/length(state), X138twos=sum(X138==2)/length(state), X138threes=sum(X138==3)/length(state), X138fours=sum(X138==4)/length(state),
            X139ones=sum(X139==1)/length(state), X139twos=sum(X139==2)/length(state), X139threes=sum(X139==3)/length(state)) %>% 
  ungroup() %>% 
  add_row(state="Nagaland") %>% 
  arrange(state) 
#There are no old officers from Nagaland. The summary produced for old officers, thus, is one row shorter. In order to cbind this dataset with other (like ias_processed_dta) for weight calculations, we have added these states with NAs to match the number of rows across datasets. This is done for all summaries for young and old officers.
```

```{r, include=FALSE}
#For former officers: creating a dataset with the averages for each answer choice for all questions grouped by the state 
summary_state_former<-full_former %>% 
  dplyr::select(c(X16, X17, X18, X130, X131, X132, X133, X134, X135, X137, X138, X139, state)) %>% 
  summarise(X16ones=sum(X16==1)/length(X16), X16twos=sum(X16==2)/length(X16),
            X17ones=sum(X17==1)/length(X17), X17twos=sum(X17==2)/length(X17), X17threes=sum(X17==3)/length(X17), X17fours=sum(X17==4)/length(X17),
            X18ones=sum(X18==1)/length(X18), X18twos=sum(X18==2)/length(X18), X18threes=sum(X18==3)/length(X18), X18fours=sum(X18==4)/length(X18), 
            X130ones=sum(X130==1)/length(X130), X130twos=sum(X130==2)/length(X130),
            X131ones=sum(X131==1)/length(X131), X131twos=sum(X131==2)/length(X131), X131threes=sum(X131==3)/length(X131), X131fours=sum(X131==4)/length(X131), 
            X132ones=sum(X132==1)/length(X132), X132twos=sum(X132==2)/length(X132),
            X133ones=sum(X133==1)/length(X133), X133twos=sum(X133==2)/length(X133), X133threes=sum(X133==3)/length(X133),
            X134ones=sum(X134==1)/length(X134), X134twos=sum(X134==2)/length(X134), X134threes=sum(X134==3)/length(X134), X134fours=sum(X134==4)/length(X134), 
            X135ones=sum(X135==1)/length(X135), X135twos=sum(X135==2)/length(X135), X135threes=sum(X135==3)/length(X135), X135fours=sum(X135==4)/length(X135),
            X137ones=sum(X137==1)/length(X137), X137twos=sum(X137==2)/length(X137), X137threes=sum(X137==3)/length(X137), X137fours=sum(X137==4)/length(X137),
            X138ones=sum(X138==1)/length(X138), X138twos=sum(X138==2)/length(X138), X138threes=sum(X138==3)/length(X138), X138fours=sum(X138==4)/length(X138),
            X139ones=sum(X139==1)/length(X139), X139twos=sum(X139==2)/length(X139), X139threes=sum(X139==3)/length(X139)) %>% 
  ungroup()
```

```{r, include=FALSE}
#Importing IAS data from TCPD
ias_raw_dta<-read.csv("ias-profile.csv")
```

```{r, include=FALSE}
#Creating a dataset where each row is a different state and each column is the allocation year. Additional columns indicating total number of officers, number of officers pre and post 2012, and their respective proportions are given. 
ias_processed_dta<-ias_raw_dta %>% 
  filter(Retired=="TRUE") %>%  
  mutate(State = Cadre) 
ias_processed_dta$State<-as.character(ias_processed_dta$State)

#Dividing combined cadres in the same way we allocated them in our survey data 
agmut_ias<-ias_processed_dta %>% 
  subset(State=="A G M U T") %>% 
  mutate(State=sample(c(rep("Arunachal Pradesh", 60), rep("Goa", 33), rep("Mizoram", 46),rep("Andaman and Nicobar Islands", 22), rep("Chandigarh", 13), rep("DNH and DD", 9), rep("Delhi", 108),  rep("Lakshadweep Islands",4), rep("Puducherry", 20)), replace = FALSE))

am_ias<-ias_processed_dta %>% 
  subset(State=="Assam Meghalya") %>% 
  mutate(State=sample(c(rep("Assam",136), rep("Meghalaya", 58))))

mt_ias<-ias_processed_dta %>% 
  subset(State=="Manipur-Tripura") %>% 
  mutate(State=sample(c(rep("Manipur",2), rep("Tripura", 2))))

nocombined_ias<-ias_processed_dta %>% 
  subset(!State=="A G M U T") %>% 
  subset(!State=="Assam Meghalya") %>% 
  subset(!State=="Manipur-Tripura")

ias_processed_dta<-nocombined_ias %>% 
  add_row(agmut_ias) %>% 
  add_row(am_ias) %>%
  add_row(mt_ias) %>% 
  mutate(State = ifelse(State=="Chhasttisgarh", "Chhattisgarh", ifelse(State== "Maharastra", "Maharashtra", State))) %>% 
  dplyr::select(c(State, Allotment_Year)) %>% 
  group_by(State) %>% 
  summarise(Y1982=sum(Allotment_Year=="1982"),
            Y1983=sum(Allotment_Year=="1983"),
            Y1984=sum(Allotment_Year=="1984"),
            Y1985=sum(Allotment_Year=="1985"),
            Y1986=sum(Allotment_Year=="1986"),
            Y1987=sum(Allotment_Year=="1987"),
            Y1988=sum(Allotment_Year=="1988"),
            Y1989=sum(Allotment_Year=="1989"),
            Y1990=sum(Allotment_Year=="1990"),
            Y1991=sum(Allotment_Year=="1991"),
            Y1992=sum(Allotment_Year=="1992"),
            Y1993=sum(Allotment_Year=="1993"),
            Y1994=sum(Allotment_Year=="1994"),
            Y1995=sum(Allotment_Year=="1995"),
            Y1996=sum(Allotment_Year=="1996"),
            Y1997=sum(Allotment_Year=="1997"),
            Y1998=sum(Allotment_Year=="1998"),
            Y1999=sum(Allotment_Year=="1999"),
            Y2000=sum(Allotment_Year=="2000"),
            Y2001=sum(Allotment_Year=="2001"),
            Y2002=sum(Allotment_Year=="2002"),
            Y2003=sum(Allotment_Year=="2003"),
            Y2004=sum(Allotment_Year=="2004"),
            Y2005=sum(Allotment_Year=="2005"),
            Y2006=sum(Allotment_Year=="2006"),
            Y2007=sum(Allotment_Year=="2007"),
            Y2008=sum(Allotment_Year=="2008"),
            Y2009=sum(Allotment_Year=="2009"),
            Y2010=sum(Allotment_Year=="2010"),
            Y2011=sum(Allotment_Year=="2011"),
            Y2012=sum(Allotment_Year=="2012"),
            Y2013=sum(Allotment_Year=="2013"),
            Y2014=sum(Allotment_Year=="2014"),
            Y2015=sum(Allotment_Year=="2015"),
            Y2016=sum(Allotment_Year=="2016"),
            Y2017=sum(Allotment_Year=="2017"),
            Y2018=sum(Allotment_Year=="2018"),
            Y2019=sum(Allotment_Year=="2019"),
            Y2020=sum(Allotment_Year=="2020"),.groups='drop') %>% 
  ungroup() %>% 
  mutate(pre2012=rowSums(.[2:31])) %>% #1982 to 2011
  mutate(post2012=rowSums(.[32:40])) %>% #2012 to 2020
  mutate(total= rowSums(.[41:42])) %>% 
  mutate (state_weight = total/sum(total)) %>% 
  #bind_rows(summarise_all(.,~if(is.numeric(.)) sum(.) else("Total"))) %>% 
  mutate(sdg = ifelse(State == "Uttar Pradesh" | State == "Bihar" | State == "Assam", "Aspirant", 
                       ifelse(State=="Puducherry"|State=="Tamil Nadu"| State=="Chandigarh"| State=="Himachal Pradesh"|State =="Kerala", "Frontrunner", "Performer"))) %>% 
  mutate(state_young_weight = post2012/ sum(post2012)) %>% 
  mutate(state_old_weight = pre2012/ sum(pre2012)) 

ias_processed_dta <- ias_processed_dta %>% 
  mutate(sdg_weight = ifelse(sdg == "Aspirant", total/sum(ias_processed_dta$total[ias_processed_dta$sdg=="Aspirant"]), 
                             ifelse(sdg == "Frontrunner", total/sum(ias_processed_dta$total[ias_processed_dta$sdg=="Frontrunner"]), total/sum(ias_processed_dta$total[ias_processed_dta$sdg=="Performer"]))))
```

```{r, include=FALSE}
#Adding state weights and age weights to summary_state to create a new dataset called summary_state_analysis
summary_state_analysis<-summary_state %>% 
  mutate(state_weight=ias_processed_dta$state_weight) %>% 
  mutate(sdg_weight=ias_processed_dta$sdg_weight) 

summary_state_analysis_young<-summary_state_young %>% 
  mutate(state_young_weight = ias_processed_dta$post2012/ sum(ias_processed_dta$post2012))

summary_state_analysis_old<-summary_state_old  %>% 
  mutate(state_old_weight = ias_processed_dta$pre2012/ sum(ias_processed_dta$pre2012))
```

```{r, include=FALSE}
#Calculating averages for question 4 (previously "Merged 1")
q4_state_answers1 <- full_serving %>% 
  dplyr::select (state, Merged1.1) %>% 
  mutate (Merged = Merged1.1) %>% 
  dplyr:: select(-Merged1.1)

state_answers_q4 <- full_serving %>% 
  dplyr::select (state, Merged1.2) %>% 
  mutate (Merged = Merged1.2) %>% 
  dplyr:: select (-Merged1.2) %>% 
  add_row(q4_state_answers1) 

summary_q4 <- state_answers_q4 %>% 
  group_by(state) %>% 
  na.omit() %>% 
  summarise(q4_anislands=sum(Merged =="Andaman and Nicobar Islands")/length(state),
            q4_andhra=sum(Merged =="Andhra Pradesh")/length(state), 
            q4_arunachal=sum(Merged =="Arunachal Pradesh")/length(state),
            q4_assam=sum(Merged =="Assam")/length(state),
            q4_bihar=sum(Merged =="Bihar")/length(state),
            q4_chandigarh=sum(Merged =="Chandigarh")/length(state),
            q4_chhattisgarh=sum(Merged =="Chhattisgarh")/length(state),
            q4_dnhdd=sum(Merged =="Dadra and Nagar Haveli and Daman and Dui")/length(state),
            q4_goa=sum(Merged =="Goa")/length(state),
            q4_gujarat=sum(Merged =="Gujarat")/length(state),
            q4_haryana=sum(Merged =="Haryana")/length(state),
            q4_hp=sum(Merged =="Himachal Pradesh")/length(state),
            q4_jk=sum(Merged =="Jammu and Kashmir")/length(state),
            q4_jharkhand=sum(Merged =="Jharkhand")/length(state),
            q4_karnataka=sum(Merged =="Karnataka")/length(state),
            q4_kerala=sum(Merged =="Kerala")/length(state),
            q4_ladakh=sum(Merged =="Ladakh")/length(state),
            q4_lakshadweep=sum(Merged =="Lakshadweep")/length(state),
            q4_mp=sum(Merged =="Madhya Pradesh")/length(state),
            q4_maharashtra=sum(Merged =="Maharashtra")/length(state),
            q4_manipur=sum(Merged =="Manipur")/length(state),
            q4_meghalaya=sum(Merged =="Meghalaya")/length(state),
            q4_mizoram=sum(Merged =="Mizoram")/length(state),
            q4_nagaland=sum(Merged =="Nagaland")/length(state),
            q4_delhi=sum(Merged =="NCT of Delhi")/length(state),
            q4_none=sum(Merged =="No state has performed well")/length(state),
            q4_odisha=sum(Merged =="Odisha")/length(state),
            q4_puducherry=sum(Merged =="Puducherry")/length(state),
            q4_punjab=sum(Merged =="Punjab")/length(state),
            q4_rajasthan=sum(Merged =="Rajasthan")/length(state),
            q4_sikkim=sum(Merged =="Sikkim")/length(state),
            q4_tn=sum(Merged =="Tamil Nadu")/length(state),
            q4_telangana=sum(Merged =="Telangana")/length(state),
            q4_tripura=sum(Merged =="Tripura")/length(state),
            q4_up=sum(Merged =="Uttar Pradesh")/length(state),
            q4_uttarakhand=sum(Merged =="Uttarakhand")/length(state),
            q4_wb=sum(Merged =="West Bengal")/length(state),.groups='drop') %>% 
  ungroup() %>% 
  mutate(total=rowSums(select_if(., is.numeric), na.rm = TRUE))

summary_q4 <- summary_q4 %>% 
  mutate(state_weight=ias_processed_dta$state_weight) %>% 
  mutate(sdg_weight=ias_processed_dta$sdg_weight)
```

```{r, include=FALSE}
#For young officers only: calculating averages for question 4 
q4_state_answers1_young <- fullage_young %>% 
  dplyr::select (state, Merged1.1) %>% 
  mutate (Merged = Merged1.1) %>% 
  dplyr:: select(-Merged1.1)

state_answers_q4_young <- fullage_young %>% 
  dplyr::select (state, Merged1.2) %>% 
  mutate (Merged = Merged1.2) %>% 
  dplyr:: select (-Merged1.2) %>% 
  add_row(q4_state_answers1_young)

summary_q4_young <- state_answers_q4_young %>% 
  group_by(state) %>% 
  na.omit() %>% 
  summarise(q4_anislands=sum(Merged =="Andaman and Nicobar Islands")/length(state),
            q4_andhra=sum(Merged =="Andhra Pradesh")/length(state), 
            q4_arunachal=sum(Merged =="Arunachal Pradesh")/length(state),
            q4_assam=sum(Merged =="Assam")/length(state),
            q4_bihar=sum(Merged =="Bihar")/length(state),
            q4_chandigarh=sum(Merged =="Chandigarh")/length(state),
            q4_chhattisgarh=sum(Merged =="Chhattisgarh")/length(state),
            q4_dnhdd=sum(Merged =="Dadra and Nagar Haveli and Daman and Dui")/length(state),
            q4_goa=sum(Merged =="Goa")/length(state),
            q4_gujarat=sum(Merged =="Gujarat")/length(state),
            q4_haryana=sum(Merged =="Haryana")/length(state),
            q4_hp=sum(Merged =="Himachal Pradesh")/length(state),
            q4_jk=sum(Merged =="Jammu and Kashmir")/length(state),
            q4_jharkhand=sum(Merged =="Jharkhand")/length(state),
            q4_karnataka=sum(Merged =="Karnataka")/length(state),
            q4_kerala=sum(Merged =="Kerala")/length(state),
            q4_ladakh=sum(Merged =="Ladakh")/length(state),
            q4_lakshadweep=sum(Merged =="Lakshadweep")/length(state),
            q4_mp=sum(Merged =="Madhya Pradesh")/length(state),
            q4_maharashtra=sum(Merged =="Maharashtra")/length(state),
            q4_manipur=sum(Merged =="Manipur")/length(state),
            q4_meghalaya=sum(Merged =="Meghalaya")/length(state),
            q4_mizoram=sum(Merged =="Mizoram")/length(state),
            q4_nagaland=sum(Merged =="Nagaland")/length(state),
            q4_delhi=sum(Merged =="NCT of Delhi")/length(state),
            q4_none=sum(Merged =="No state has performed well")/length(state),
            q4_odisha=sum(Merged =="Odisha")/length(state),
            q4_puducherry=sum(Merged =="Puducherry")/length(state),
            q4_punjab=sum(Merged =="Punjab")/length(state),
            q4_rajasthan=sum(Merged =="Rajasthan")/length(state),
            q4_sikkim=sum(Merged =="Sikkim")/length(state),
            q4_tn=sum(Merged =="Tamil Nadu")/length(state),
            q4_telangana=sum(Merged =="Telangana")/length(state),
            q4_tripura=sum(Merged =="Tripura")/length(state),
            q4_up=sum(Merged =="Uttar Pradesh")/length(state),
            q4_uttarakhand=sum(Merged =="Uttarakhand")/length(state),
            q4_wb=sum(Merged =="West Bengal")/length(state),.groups='drop') %>% 
  ungroup() %>% 
  mutate(total=rowSums(select_if(., is.numeric), na.rm = TRUE)) %>% 
  add_row(state="Andaman and Nicobar Islands") %>% 
  add_row(state="Chandigarh") %>% 
  add_row(state="Lakshadweep Islands") %>%
  add_row(state="Puducherry") %>% 
  add_row(state="Mizoram") %>% 
  arrange(state) 
#There are no young officers from A and N Islands, Chandigarh, Lakshadweep Islands, Puducherry and Mizoram. The summary produced for young officers, thus, is five rows shorter. In order to cbind this dataset with other (like ias_processed_dta) for weight calculations, we have added these states with NAs to match the number of rows across datasets. This is done for all summaries for young and old officers.
summary_q4_young <- summary_q4_young %>% 
  mutate(state_young_weight=ias_processed_dta$state_young_weight)
```

```{r, include=FALSE}
#For old officers only: calculating averages for question 4 
q4_state_answers1_old <- fullage_old %>% 
  dplyr::select (state, Merged1.1) %>% 
  mutate (Merged = Merged1.1) %>% 
  dplyr:: select(-Merged1.1)

state_answers_q4_old <- fullage_old %>% 
  dplyr::select (state, Merged1.2) %>% 
  mutate (Merged = Merged1.2) %>% 
  dplyr:: select (-Merged1.2) %>% 
  add_row(q4_state_answers1_old) 

summary_q4_old <- state_answers_q4_old %>% 
  group_by(state) %>% 
  na.omit() %>% 
  summarise(q4_anislands=sum(Merged =="Andaman and Nicobar Islands")/length(state),
            q4_andhra=sum(Merged =="Andhra Pradesh")/length(state), 
            q4_arunachal=sum(Merged =="Arunachal Pradesh")/length(state),
            q4_assam=sum(Merged =="Assam")/length(state),
            q4_bihar=sum(Merged =="Bihar")/length(state),
            q4_chandigarh=sum(Merged =="Chandigarh")/length(state),
            q4_chhattisgarh=sum(Merged =="Chhattisgarh")/length(state),
            q4_dnhdd=sum(Merged =="Dadra and Nagar Haveli and Daman and Dui")/length(state),
            q4_goa=sum(Merged =="Goa")/length(state),
            q4_gujarat=sum(Merged =="Gujarat")/length(state),
            q4_haryana=sum(Merged =="Haryana")/length(state),
            q4_hp=sum(Merged =="Himachal Pradesh")/length(state),
            q4_jk=sum(Merged =="Jammu and Kashmir")/length(state),
            q4_jharkhand=sum(Merged =="Jharkhand")/length(state),
            q4_karnataka=sum(Merged =="Karnataka")/length(state),
            q4_kerala=sum(Merged =="Kerala")/length(state),
            q4_ladakh=sum(Merged =="Ladakh")/length(state),
            q4_lakshadweep=sum(Merged =="Lakshadweep")/length(state),
            q4_mp=sum(Merged =="Madhya Pradesh")/length(state),
            q4_maharashtra=sum(Merged =="Maharashtra")/length(state),
            q4_manipur=sum(Merged =="Manipur")/length(state),
            q4_meghalaya=sum(Merged =="Meghalaya")/length(state),
            q4_mizoram=sum(Merged =="Mizoram")/length(state),
            q4_nagaland=sum(Merged =="Nagaland")/length(state),
            q4_delhi=sum(Merged =="NCT of Delhi")/length(state),
            q4_none=sum(Merged =="No state has performed well")/length(state),
            q4_odisha=sum(Merged =="Odisha")/length(state),
            q4_puducherry=sum(Merged =="Puducherry")/length(state),
            q4_punjab=sum(Merged =="Punjab")/length(state),
            q4_rajasthan=sum(Merged =="Rajasthan")/length(state),
            q4_sikkim=sum(Merged =="Sikkim")/length(state),
            q4_tn=sum(Merged =="Tamil Nadu")/length(state),
            q4_telangana=sum(Merged =="Telangana")/length(state),
            q4_tripura=sum(Merged =="Tripura")/length(state),
            q4_up=sum(Merged =="Uttar Pradesh")/length(state),
            q4_uttarakhand=sum(Merged =="Uttarakhand")/length(state),
            q4_wb=sum(Merged =="West Bengal")/length(state),.groups='drop') %>% 
  ungroup() %>% 
  mutate(total=rowSums(select_if(., is.numeric), na.rm = TRUE)) %>% 
  add_row(state="Nagaland") %>% 
  arrange(state) 
#There are no old officers from Nagaland. The summary produced for old officers, thus, is one rows shorter. In order to cbind this dataset with other (like ias_processed_dta) for weight calculations, we have added these states with NAs to match the number of rows across datasets. This is done for all summaries for young and old officers.
summary_q4_old <- summary_q4_old %>% 
  mutate(state_old_weight=ias_processed_dta$state_old_weight)
```

```{r, include=FALSE}
#For former officers only: calculating averages for question 4 
q4_state_answers1_former <- full_former %>% 
  dplyr::select (Merged1.1) %>% 
  mutate (Merged = Merged1.1) %>% 
  dplyr:: select(-Merged1.1)

state_answers_q4_former <- full_former %>% 
  dplyr::select (Merged1.2)%>% 
  mutate (Merged = Merged1.2) %>% 
  dplyr:: select (-Merged1.2) %>% 
  add_row(q4_state_answers1_former) 

summary_q4_former <- state_answers_q4_former %>%  
  na.omit() %>% 
  summarise(q4_anislands=sum(Merged =="Andaman and Nicobar Islands")/length(Merged),
            q4_andhra=sum(Merged =="Andhra Pradesh")/length(Merged), 
            q4_arunachal=sum(Merged =="Arunachal Pradesh")/length(Merged),
            q4_assam=sum(Merged =="Assam")/length(Merged),
            q4_bihar=sum(Merged =="Bihar")/length(Merged),
            q4_chandigarh=sum(Merged =="Chandigarh")/length(Merged),
            q4_chhattisgarh=sum(Merged =="Chhattisgarh")/length(Merged),
            q4_dnhdd=sum(Merged =="Dadra and Nagar Haveli and Daman and Dui")/length(Merged),
            q4_goa=sum(Merged =="Goa")/length(Merged),
            q4_gujarat=sum(Merged =="Gujarat")/length(Merged),
            q4_haryana=sum(Merged =="Haryana")/length(Merged),
            q4_hp=sum(Merged =="Himachal Pradesh")/length(Merged),
            q4_jk=sum(Merged =="Jammu and Kashmir")/length(Merged),
            q4_jharkhand=sum(Merged =="Jharkhand")/length(Merged),
            q4_karnataka=sum(Merged =="Karnataka")/length(Merged),
            q4_kerala=sum(Merged =="Kerala")/length(Merged),
            q4_ladakh=sum(Merged =="Ladakh")/length(Merged),
            q4_lakshadweep=sum(Merged =="Lakshadweep")/length(Merged),
            q4_mp=sum(Merged =="Madhya Pradesh")/length(Merged),
            q4_maharashtra=sum(Merged =="Maharashtra")/length(Merged),
            q4_manipur=sum(Merged =="Manipur")/length(Merged),
            q4_meghalaya=sum(Merged =="Meghalaya")/length(Merged),
            q4_mizoram=sum(Merged =="Mizoram")/length(Merged),
            q4_nagaland=sum(Merged =="Nagaland")/length(Merged),
            q4_delhi=sum(Merged =="NCT of Delhi")/length(Merged),
            q4_none=sum(Merged =="No state has performed well")/length(Merged),
            q4_odisha=sum(Merged =="Odisha")/length(Merged),
            q4_puducherry=sum(Merged =="Puducherry")/length(Merged),
            q4_punjab=sum(Merged =="Punjab")/length(Merged),
            q4_rajasthan=sum(Merged =="Rajasthan")/length(Merged),
            q4_sikkim=sum(Merged =="Sikkim")/length(Merged),
            q4_tn=sum(Merged =="Tamil Nadu")/length(Merged),
            q4_telangana=sum(Merged =="Telangana")/length(Merged),
            q4_tripura=sum(Merged =="Tripura")/length(Merged),
            q4_up=sum(Merged =="Uttar Pradesh")/length(Merged),
            q4_uttarakhand=sum(Merged =="Uttarakhand")/length(Merged),
            q4_wb=sum(Merged =="West Bengal")/length(Merged),.groups='drop') %>% 
  ungroup() %>% 
  mutate(total=rowSums(select_if(., is.numeric), na.rm = TRUE)) 
```

```{r, include=FALSE}
#Question 5
q5_1 <- full_serving %>% 
dplyr::select (X12, state, Merged2.1) %>% 
mutate (Merged = Merged2.1) %>% 
dplyr:: select(-Merged2.1)

state_answers_q5 <- full_serving %>% 
  dplyr::select (X12, state, Merged2.2) %>%
  mutate (Merged = Merged2.2) %>% 
  dplyr:: select (-Merged2.2) %>% 
  add_row(q5_1) 

#Adding a column to indicate bias when officers select their own state as an answer choice (#1 is bias, #0 is unbiased)
state_answers_q5<-state_answers_q5 %>% 
  mutate(state_bias=(ifelse(Merged=="Andaman and Nicobar Islands" & X12=="AGMUT",1,
                     ifelse(Merged=="Andhra Pradesh" & X12=="Andhra Pradesh", 1,        
                     ifelse(Merged=="Arunachal Pradesh" & X12=="AGMUT",1,
                     ifelse(Merged=="Assam" & X12=="Assam Meghalaya",1,
                     ifelse(Merged=="Bihar" & X12=="Bihar",1,
                     ifelse(Merged=="Chandigarh" & X12=="AGMUT",1,
                     ifelse(Merged=="Chattisgarh" & X12=="Chattisgarh",1,
                     ifelse(Merged=="Dadra and Nagar Haveli and Daman and Dui" & X12=="AGMUT",1,      
                     ifelse(Merged=="Goa" & X12=="AGMUT",1,
                     ifelse(Merged=="Gujarat" & X12=="Gujarat",1,
                     ifelse(Merged=="Haryana" & X12=="Haryana",1,
                     ifelse(Merged=="Himachal Pradesh" & X12=="Himachal Pradesh",1,
                     ifelse(Merged=="Jammu and Kashmir" & X12=="Jammu and Kashmir",1,
                     ifelse(Merged=="Jharkhand" & X12=="Jharkhand",1,
                     ifelse(Merged=="Karnataka" & X12=="Karnataka",1,
                     ifelse(Merged=="Kerala" & X12=="Kerala",1,
                     ifelse(Merged=="Ladakh" & X12=="Jammu and Kashmir",1,
                     ifelse(Merged=="Lakshadweep" & X12=="AGMUT",1,       
                     ifelse(Merged=="Madhya Pradesh" & X12=="Madhya Pradesh",1,
                     ifelse(Merged=="Maharashtra" & X12=="Maharashtra",1,
                     ifelse(Merged=="Manipur" & X12=="Manipur",1,
                     ifelse(Merged=="Meghalaya" & X12=="Assam Meghalaya",1,
                     ifelse(Merged=="Mizoram" & X12=="AGMUT",1,       
                     ifelse(Merged=="Nagaland" & X12=="Nagaland",1,
                     ifelse(Merged=="NCT of Delhi" & X12=="AGMUT",1, 
                     ifelse(Merged=="Odisha" & X12=="Odisha",1,
                     ifelse(Merged=="Puducherry" & X12=="AGMUT",1,        
                     ifelse(Merged=="Punjab" & X12=="Punjab",1,
                     ifelse(Merged=="Rajasthan" & X12=="Rajasthan",1,
                     ifelse(Merged=="Sikkim" & X12=="Sikkim",1,
                     ifelse(Merged=="Tamil Nadu" & X12=="Tamil Nadu",1,
                     ifelse(Merged=="Telangana" & X12=="Telangana",1,
                     ifelse(Merged=="Tripura" & X12=="Tripura",1,
                     ifelse(Merged=="Uttar Pradesh" & X12=="Uttar Pradesh",1,
                     ifelse(Merged=="Uttarakhand" & X12=="Uttarakhand",1,
                     ifelse(Merged=="West Bengal" & X12=="West Bengal",1,0)))))))))))))))))))))))))))))))))))))) 

#42 officers selected their own state                             
#These officers come from the following states: 
bias<-which(state_answers_q5$state_bias==1)
table(state_answers_q5_unbiased$X12[bias])

#filtering out all officers who selected their own state 
state_answers_q5_unbiased <- state_answers_q5_unbiased %>% 
  filter(!same_state==1)

#Calculating averages for question 5 (previously "Merged 2")
summary_q5<- state_answers_q5 %>% 
  group_by(state) %>% 
  na.omit() %>% 
  summarise(q5_anislands=sum(Merged=="Andaman and Nicobar Islands")/ length(state),
            q5_andhra=sum(Merged=="Andhra Pradesh")/length(state), 
            q5_arunachal=sum(Merged=="Arunachal Pradesh")/length(state),
            q5_assam=sum(Merged=="Assam")/length(state),
            q5_bihar=sum(Merged=="Bihar")/length(state),
            q5_chandigarh=sum(Merged =="Chandigarh")/length(state),
            q5_chhattisgarh=sum(Merged=="Chhattisgarh")/length(state),
            q5_dnhdd=sum(Merged =="Dadra and Nagar Haveli and Daman and Dui")/length(state),
            q5_goa=sum(Merged=="Goa")/length(state),
            q5_gujarat=sum(Merged=="Gujarat")/length(state),
            q5_haryana=sum(Merged=="Haryana")/length(state),
            q5_hp=sum(Merged=="Himachal Pradesh")/length(state),
            q5_jk=sum(Merged=="Jammu and Kashmir")/length(state),
            q5_jharkhand=sum(Merged=="Jharkhand")/length(state),
            q5_karnataka=sum(Merged=="Karnataka")/length(state),
            q5_kerala=sum(Merged=="Kerala")/length(state),
            q5_ladakh=sum(Merged =="Ladakh")/length(state),
            q5_lakshadweep=sum(Merged=="Lakshadweep")/length(state),
            q5_mp=sum(Merged=="Madhya Pradesh")/length(state),
            q5_maharashtra=sum(Merged=="Maharashtra")/length(state),
            q5_manipur=sum(Merged=="Manipur")/length(state),
            q5_meghalaya=sum(Merged=="Meghalaya")/length(state),
            q5_mizoram=sum(Merged=="Mizoram")/length(state),
            q5_nagaland=sum(Merged =="Nagaland")/length(state),
            q5_delhi=sum(Merged=="NCT of Delhi")/length(state),
            q5_none=sum(Merged=="No state has performed poorly")/length(state),
            q5_odisha=sum(Merged =="Odisha")/length(state),
            q5_puducherry=sum(Merged=="Puducherry")/length(state),
            q5_punjab=sum(Merged=="Punjab")/length(state),
            q5_rajasthan=sum(Merged=="Rajasthan")/length(state),
            q5_sikkim=sum(Merged =="Sikkim")/length(state),
            q5_tn=sum(Merged=="Tamil Nadu")/length(state),
            q5_telangana=sum(Merged=="Telangana")/length(state),
            q5_tripura=sum(Merged =="Tripura")/length(state),
            q5_up=sum(Merged=="Uttar Pradesh")/length(state),
            q5_uttarakhand=sum(Merged=="Uttarakhand")/length(state),
            q5_wb=sum(Merged=="West Bengal")/length(state),.groups='drop') %>% 
  ungroup() %>% 
  mutate(total=rowSums(select_if(., is.numeric), na.rm = TRUE))
 
summary_q5 <- summary_q5 %>% 
  mutate(state_weight=ias_processed_dta$state_weight) %>% 
  mutate(sdg_weight=ias_processed_dta$sdg_weight)

#Calculating averages for question 5 for *unbiased* officers only 
summary_q5_unbiased<- state_answers_q5_unbiased %>% 
  group_by(state) %>% 
  na.omit() %>% 
  summarise(q5_anislands=sum(Merged=="Andaman and Nicobar Islands")/ length(state),
            q5_andhra=sum(Merged=="Andhra Pradesh")/length(state), 
            q5_arunachal=sum(Merged=="Arunachal Pradesh")/length(state),
            q5_assam=sum(Merged=="Assam")/length(state),
            q5_bihar=sum(Merged=="Bihar")/length(state),
            q5_chandigarh=sum(Merged =="Chandigarh")/length(state),
            q5_chhattisgarh=sum(Merged=="Chhattisgarh")/length(state),
            q5_dnhdd=sum(Merged =="Dadra and Nagar Haveli and Daman and Dui")/length(state),
            q5_goa=sum(Merged=="Goa")/length(state),
            q5_gujarat=sum(Merged=="Gujarat")/length(state),
            q5_haryana=sum(Merged=="Haryana")/length(state),
            q5_hp=sum(Merged=="Himachal Pradesh")/length(state),
            q5_jk=sum(Merged=="Jammu and Kashmir")/length(state),
            q5_jharkhand=sum(Merged=="Jharkhand")/length(state),
            q5_karnataka=sum(Merged=="Karnataka")/length(state),
            q5_kerala=sum(Merged=="Kerala")/length(state),
            q5_ladakh=sum(Merged =="Ladakh")/length(state),
            q5_lakshadweep=sum(Merged=="Lakshadweep")/length(state),
            q5_mp=sum(Merged=="Madhya Pradesh")/length(state),
            q5_maharashtra=sum(Merged=="Maharashtra")/length(state),
            q5_manipur=sum(Merged=="Manipur")/length(state),
            q5_meghalaya=sum(Merged=="Meghalaya")/length(state),
            q5_mizoram=sum(Merged=="Mizoram")/length(state),
            q5_nagaland=sum(Merged =="Nagaland")/length(state),
            q5_delhi=sum(Merged=="NCT of Delhi")/length(state),
            q5_none=sum(Merged=="No state has performed poorly")/length(state),
            q5_odisha=sum(Merged =="Odisha")/length(state),
            q5_puducherry=sum(Merged=="Puducherry")/length(state),
            q5_punjab=sum(Merged=="Punjab")/length(state),
            q5_rajasthan=sum(Merged=="Rajasthan")/length(state),
            q5_sikkim=sum(Merged =="Sikkim")/length(state),
            q5_tn=sum(Merged=="Tamil Nadu")/length(state),
            q5_telangana=sum(Merged=="Telangana")/length(state),
            q5_tripura=sum(Merged =="Tripura")/length(state),
            q5_up=sum(Merged=="Uttar Pradesh")/length(state),
            q5_uttarakhand=sum(Merged=="Uttarakhand")/length(state),
            q5_wb=sum(Merged=="West Bengal")/length(state),.groups='drop') %>% 
  ungroup() %>% 
  mutate(total=rowSums(select_if(., is.numeric), na.rm = TRUE))
 
summary_q5_unbiased <- summary_q5_unbiased %>% 
  mutate(state_weight=ias_processed_dta$state_weight) %>% 
  mutate(sdg_weight=ias_processed_dta$sdg_weight)
```

```{r, include=FALSE}
#Question 5: for young officers only 
q5_state_answers1_young <- fullage_young %>% 
  dplyr::select (state, Merged2.1, X12) %>% 
  mutate (Merged = Merged2.1) %>% 
  dplyr:: select(-Merged2.1)

state_answers_q5_young <- fullage_young %>% 
  dplyr::select (state, Merged2.2, X12) %>% 
  mutate (Merged = Merged2.2) %>% 
  dplyr:: select (-Merged2.2) %>% 
  add_row(q5_state_answers1_young) 

#Adding a column to indicate bias
state_answers_q5_young<-state_answers_q5_young %>% 
  mutate(state_bias=(ifelse(Merged=="Andaman and Nicobar Islands" & X12=="AGMUT",1,
                     ifelse(Merged=="Andhra Pradesh" & X12=="Andhra Pradesh", 1,        
                     ifelse(Merged=="Arunachal Pradesh" & X12=="AGMUT",1,
                     ifelse(Merged=="Assam" & X12=="Assam Meghalaya",1,
                     ifelse(Merged=="Bihar" & X12=="Bihar",1,
                     ifelse(Merged=="Chandigarh" & X12=="AGMUT",1,
                     ifelse(Merged=="Chattisgarh" & X12=="Chattisgarh",1,
                     ifelse(Merged=="Dadra and Nagar Haveli and Daman and Dui" & X12=="AGMUT",1,      
                     ifelse(Merged=="Goa" & X12=="AGMUT",1,
                     ifelse(Merged=="Gujarat" & X12=="Gujarat",1,
                     ifelse(Merged=="Haryana" & X12=="Haryana",1,
                     ifelse(Merged=="Himachal Pradesh" & X12=="Himachal Pradesh",1,
                     ifelse(Merged=="Jammu and Kashmir" & X12=="Jammu and Kashmir",1,
                     ifelse(Merged=="Jharkhand" & X12=="Jharkhand",1,
                     ifelse(Merged=="Karnataka" & X12=="Karnataka",1,
                     ifelse(Merged=="Kerala" & X12=="Kerala",1,
                     ifelse(Merged=="Ladakh" & X12=="Jammu and Kashmir",1,
                     ifelse(Merged=="Lakshadweep" & X12=="AGMUT",1,       
                     ifelse(Merged=="Madhya Pradesh" & X12=="Madhya Pradesh",1,
                     ifelse(Merged=="Maharashtra" & X12=="Maharashtra",1,
                     ifelse(Merged=="Manipur" & X12=="Manipur",1,
                     ifelse(Merged=="Meghalaya" & X12=="Assam Meghalaya",1,
                     ifelse(Merged=="Mizoram" & X12=="AGMUT",1,       
                     ifelse(Merged=="Nagaland" & X12=="Nagaland",1,
                     ifelse(Merged=="NCT of Delhi" & X12=="AGMUT",1, 
                     ifelse(Merged=="Odisha" & X12=="Odisha",1,
                     ifelse(Merged=="Puducherry" & X12=="AGMUT",1,        
                     ifelse(Merged=="Punjab" & X12=="Punjab",1,
                     ifelse(Merged=="Rajasthan" & X12=="Rajasthan",1,
                     ifelse(Merged=="Sikkim" & X12=="Sikkim",1,
                     ifelse(Merged=="Tamil Nadu" & X12=="Tamil Nadu",1,
                     ifelse(Merged=="Telangana" & X12=="Telangana",1,
                     ifelse(Merged=="Tripura" & X12=="Tripura",1,
                     ifelse(Merged=="Uttar Pradesh" & X12=="Uttar Pradesh",1,
                     ifelse(Merged=="Uttarakhand" & X12=="Uttarakhand",1,
                     ifelse(Merged=="West Bengal" & X12=="West Bengal",1,0))))))))))))))))))))))))))))))))))))))

#22 young officers selected their own state 
bias<-which(state_answers_q5_young$state_bias==1)
table(state_answers_q5_young$X12[bias])

#filtering out all officers who selected their own state 
state_answers_q5_young_unbiased <- state_answers_q5_young %>% 
  filter(!state_bias==1)

#Calculating averages for question 5 for all young officers officers  
summary_q5_young <- state_answers_q5_young %>% 
  group_by(state) %>% 
  na.omit() %>% 
  summarise(q5_anislands=sum(Merged =="Andaman and Nicobar Islands")/length(state),
            q5_andhra=sum(Merged =="Andhra Pradesh")/length(state), 
            q5_arunachal=sum(Merged =="Arunachal Pradesh")/length(state),
            q5_assam=sum(Merged =="Assam")/length(state),
            q5_bihar=sum(Merged =="Bihar")/length(state),
            q5_chandigarh=sum(Merged =="Chandigarh")/length(state),
            q5_chhattisgarh=sum(Merged =="Chhattisgarh")/length(state),
            q5_dnhdd=sum(Merged =="Dadra and Nagar Haveli and Daman and Dui")/length(state),
            q5_goa=sum(Merged =="Goa")/length(state),
            q5_gujarat=sum(Merged =="Gujarat")/length(state),
            q5_haryana=sum(Merged =="Haryana")/length(state),
            q5_hp=sum(Merged =="Himachal Pradesh")/length(state),
            q5_jk=sum(Merged =="Jammu and Kashmir")/length(state),
            q5_jharkhand=sum(Merged =="Jharkhand")/length(state),
            q5_karnataka=sum(Merged =="Karnataka")/length(state),
            q5_kerala=sum(Merged =="Kerala")/length(state),
            q5_ladakh=sum(Merged =="Ladakh")/length(state),
            q5_lakshadweep=sum(Merged =="Lakshadweep")/length(state),
            q5_mp=sum(Merged =="Madhya Pradesh")/length(state),
            q5_maharashtra=sum(Merged =="Maharashtra")/length(state),
            q5_manipur=sum(Merged =="Manipur")/length(state),
            q5_meghalaya=sum(Merged =="Meghalaya")/length(state),
            q5_mizoram=sum(Merged =="Mizoram")/length(state),
            q5_nagaland=sum(Merged =="Nagaland")/length(state),
            q5_delhi=sum(Merged =="NCT of Delhi")/length(state),
            q5_none=sum(Merged =="No state has performed well")/length(state),
            q5_odisha=sum(Merged =="Odisha")/length(state),
            q5_puducherry=sum(Merged =="Puducherry")/length(state),
            q5_punjab=sum(Merged =="Punjab")/length(state),
            q5_rajasthan=sum(Merged =="Rajasthan")/length(state),
            q5_sikkim=sum(Merged =="Sikkim")/length(state),
            q5_tn=sum(Merged =="Tamil Nadu")/length(state),
            q5_telangana=sum(Merged =="Telangana")/length(state),
            q5_tripura=sum(Merged =="Tripura")/length(state),
            q5_up=sum(Merged =="Uttar Pradesh")/length(state),
            q5_uttarakhand=sum(Merged =="Uttarakhand")/length(state),
            q5_wb=sum(Merged =="West Bengal")/length(state),.groups='drop') %>% 
  ungroup() %>% 
  mutate(total=rowSums(select_if(., is.numeric), na.rm = TRUE)) %>% 
  add_row(state="Andaman and Nicobar Islands") %>% 
  add_row(state="Chandigarh") %>% 
  add_row(state="Lakshadweep Islands") %>%
  add_row(state="Puducherry") %>% 
  add_row(state="Mizoram") %>% 
  arrange(state) 
#There are no young officers from A and N Islands, Chandigarh, Lakshadweep Islands, Puducherry and Mizoram. The summary produced for young officers, thus, is five rows shorter. In order to cbind this dataset with other (like ias_processed_dta) for weight calculations, we have added these states with NAs to match the number of rows across datasets. This is done for all summaries for young and old officers.
summary_q5_young <- summary_q5_young %>% 
  mutate(state_young_weight=ias_processed_dta$state_young_weight)

#Calculating averages for question 5 for *unbiased* young officers only 
summary_q5_young_unbiased <- state_answers_q5_young_unbiased %>% 
  group_by(state) %>% 
  na.omit() %>% 
  summarise(q5_anislands=sum(Merged =="Andaman and Nicobar Islands")/length(state),
            q5_andhra=sum(Merged =="Andhra Pradesh")/length(state), 
            q5_arunachal=sum(Merged =="Arunachal Pradesh")/length(state),
            q5_assam=sum(Merged =="Assam")/length(state),
            q5_bihar=sum(Merged =="Bihar")/length(state),
            q5_chandigarh=sum(Merged =="Chandigarh")/length(state),
            q5_chhattisgarh=sum(Merged =="Chhattisgarh")/length(state),
            q5_dnhdd=sum(Merged =="Dadra and Nagar Haveli and Daman and Dui")/length(state),
            q5_goa=sum(Merged =="Goa")/length(state),
            q5_gujarat=sum(Merged =="Gujarat")/length(state),
            q5_haryana=sum(Merged =="Haryana")/length(state),
            q5_hp=sum(Merged =="Himachal Pradesh")/length(state),
            q5_jk=sum(Merged =="Jammu and Kashmir")/length(state),
            q5_jharkhand=sum(Merged =="Jharkhand")/length(state),
            q5_karnataka=sum(Merged =="Karnataka")/length(state),
            q5_kerala=sum(Merged =="Kerala")/length(state),
            q5_ladakh=sum(Merged =="Ladakh")/length(state),
            q5_lakshadweep=sum(Merged =="Lakshadweep")/length(state),
            q5_mp=sum(Merged =="Madhya Pradesh")/length(state),
            q5_maharashtra=sum(Merged =="Maharashtra")/length(state),
            q5_manipur=sum(Merged =="Manipur")/length(state),
            q5_meghalaya=sum(Merged =="Meghalaya")/length(state),
            q5_mizoram=sum(Merged =="Mizoram")/length(state),
            q5_nagaland=sum(Merged =="Nagaland")/length(state),
            q5_delhi=sum(Merged =="NCT of Delhi")/length(state),
            q5_none=sum(Merged =="No state has performed well")/length(state),
            q5_odisha=sum(Merged =="Odisha")/length(state),
            q5_puducherry=sum(Merged =="Puducherry")/length(state),
            q5_punjab=sum(Merged =="Punjab")/length(state),
            q5_rajasthan=sum(Merged =="Rajasthan")/length(state),
            q5_sikkim=sum(Merged =="Sikkim")/length(state),
            q5_tn=sum(Merged =="Tamil Nadu")/length(state),
            q5_telangana=sum(Merged =="Telangana")/length(state),
            q5_tripura=sum(Merged =="Tripura")/length(state),
            q5_up=sum(Merged =="Uttar Pradesh")/length(state),
            q5_uttarakhand=sum(Merged =="Uttarakhand")/length(state),
            q5_wb=sum(Merged =="West Bengal")/length(state),.groups='drop') %>% 
  ungroup() %>% 
  mutate(total=rowSums(select_if(., is.numeric), na.rm = TRUE)) %>% 
  add_row(state="Andaman and Nicobar Islands") %>% 
  add_row(state="Chandigarh") %>% 
  add_row(state="Lakshadweep Islands") %>%
  add_row(state="Puducherry") %>% 
  add_row(state="Mizoram") %>% 
  arrange(state) 
#There are no young officers from A and N Islands, Chandigarh, Lakshadweep Islands, Puducherry and Mizoram. The summary produced for young officers, thus, is five rows shorter. In order to cbind this dataset with other (like ias_processed_dta) for weight calculations, we have added these states with NAs to match the number of rows across datasets. This is done for all summaries for young and old officers.
summary_q5_young_unbiased <- summary_q5_young_unbiased %>% 
  mutate(state_young_weight=ias_processed_dta$state_young_weight)
```

```{r, include=FALSE}
#Question 5: for old officers only
q5_state_answers1_old <- fullage_old %>% 
  dplyr::select (state, Merged2.1, X12) %>% 
  mutate (Merged = Merged2.1) %>% 
  dplyr:: select(-Merged2.1)

state_answers_q5_old <- fullage_old %>% 
  dplyr::select (state, Merged2.2, X12) %>% 
  mutate (Merged = Merged2.2) %>% 
  dplyr:: select (-Merged2.2) %>% 
  add_row(q5_state_answers1_old)

#Adding a column to indicate bias
state_answers_q5_old<-state_answers_q5_old %>% 
  mutate(state_bias=(ifelse(Merged=="Andaman and Nicobar Islands" & X12=="AGMUT",1,
                     ifelse(Merged=="Andhra Pradesh" & X12=="Andhra Pradesh", 1,        
                     ifelse(Merged=="Arunachal Pradesh" & X12=="AGMUT",1,
                     ifelse(Merged=="Assam" & X12=="Assam Meghalaya",1,
                     ifelse(Merged=="Bihar" & X12=="Bihar",1,
                     ifelse(Merged=="Chandigarh" & X12=="AGMUT",1,
                     ifelse(Merged=="Chattisgarh" & X12=="Chattisgarh",1,
                     ifelse(Merged=="Dadra and Nagar Haveli and Daman and Dui" & X12=="AGMUT",1,      
                     ifelse(Merged=="Goa" & X12=="AGMUT",1,
                     ifelse(Merged=="Gujarat" & X12=="Gujarat",1,
                     ifelse(Merged=="Haryana" & X12=="Haryana",1,
                     ifelse(Merged=="Himachal Pradesh" & X12=="Himachal Pradesh",1,
                     ifelse(Merged=="Jammu and Kashmir" & X12=="Jammu and Kashmir",1,
                     ifelse(Merged=="Jharkhand" & X12=="Jharkhand",1,
                     ifelse(Merged=="Karnataka" & X12=="Karnataka",1,
                     ifelse(Merged=="Kerala" & X12=="Kerala",1,
                     ifelse(Merged=="Ladakh" & X12=="Jammu and Kashmir",1,
                     ifelse(Merged=="Lakshadweep" & X12=="AGMUT",1,       
                     ifelse(Merged=="Madhya Pradesh" & X12=="Madhya Pradesh",1,
                     ifelse(Merged=="Maharashtra" & X12=="Maharashtra",1,
                     ifelse(Merged=="Manipur" & X12=="Manipur",1,
                     ifelse(Merged=="Meghalaya" & X12=="Assam Meghalaya",1,
                     ifelse(Merged=="Mizoram" & X12=="AGMUT",1,       
                     ifelse(Merged=="Nagaland" & X12=="Nagaland",1,
                     ifelse(Merged=="NCT of Delhi" & X12=="AGMUT",1, 
                     ifelse(Merged=="Odisha" & X12=="Odisha",1,
                     ifelse(Merged=="Puducherry" & X12=="AGMUT",1,        
                     ifelse(Merged=="Punjab" & X12=="Punjab",1,
                     ifelse(Merged=="Rajasthan" & X12=="Rajasthan",1,
                     ifelse(Merged=="Sikkim" & X12=="Sikkim",1,
                     ifelse(Merged=="Tamil Nadu" & X12=="Tamil Nadu",1,
                     ifelse(Merged=="Telangana" & X12=="Telangana",1,
                     ifelse(Merged=="Tripura" & X12=="Tripura",1,
                     ifelse(Merged=="Uttar Pradesh" & X12=="Uttar Pradesh",1,
                     ifelse(Merged=="Uttarakhand" & X12=="Uttarakhand",1,
                     ifelse(Merged=="West Bengal" & X12=="West Bengal",1,0))))))))))))))))))))))))))))))))))))))

#20 old officers selected their own state 
#They are from the following states:
bias<-which(state_answers_q5_old$state_bias==1)
table(state_answers_q5_old$X12[bias])

#filtering out all officers who selected their own state 
state_answers_q5_old_unbiased <- state_answers_q5_old %>% 
  filter(!state_bias==1)

#Calculating averages for question 5 for all old officers 
summary_q5_old <- state_answers_q5_old %>% 
  group_by(state) %>% 
  na.omit() %>% 
  summarise(q5_anislands=sum(Merged =="Andaman and Nicobar Islands")/length(state),
            q5_andhra=sum(Merged =="Andhra Pradesh")/length(state), 
            q5_arunachal=sum(Merged =="Arunachal Pradesh")/length(state),
            q5_assam=sum(Merged =="Assam")/length(state),
            q5_bihar=sum(Merged =="Bihar")/length(state),
            q5_chandigarh=sum(Merged =="Chandigarh")/length(state),
            q5_chhattisgarh=sum(Merged =="Chhattisgarh")/length(state),
            q5_dnhdd=sum(Merged =="Dadra and Nagar Haveli and Daman and Dui")/length(state),
            q5_goa=sum(Merged =="Goa")/length(state),
            q5_gujarat=sum(Merged =="Gujarat")/length(state),
            q5_haryana=sum(Merged =="Haryana")/length(state),
            q5_hp=sum(Merged =="Himachal Pradesh")/length(state),
            q5_jk=sum(Merged =="Jammu and Kashmir")/length(state),
            q5_jharkhand=sum(Merged =="Jharkhand")/length(state),
            q5_karnataka=sum(Merged =="Karnataka")/length(state),
            q5_kerala=sum(Merged =="Kerala")/length(state),
            q5_ladakh=sum(Merged =="Ladakh")/length(state),
            q5_lakshadweep=sum(Merged =="Lakshadweep")/length(state),
            q5_mp=sum(Merged =="Madhya Pradesh")/length(state),
            q5_maharashtra=sum(Merged =="Maharashtra")/length(state),
            q5_manipur=sum(Merged =="Manipur")/length(state),
            q5_meghalaya=sum(Merged =="Meghalaya")/length(state),
            q5_mizoram=sum(Merged =="Mizoram")/length(state),
            q5_nagaland=sum(Merged =="Nagaland")/length(state),
            q5_delhi=sum(Merged =="NCT of Delhi")/length(state),
            q5_none=sum(Merged =="No state has performed well")/length(state),
            q5_odisha=sum(Merged =="Odisha")/length(state),
            q5_puducherry=sum(Merged =="Puducherry")/length(state),
            q5_punjab=sum(Merged =="Punjab")/length(state),
            q5_rajasthan=sum(Merged =="Rajasthan")/length(state),
            q5_sikkim=sum(Merged =="Sikkim")/length(state),
            q5_tn=sum(Merged =="Tamil Nadu")/length(state),
            q5_telangana=sum(Merged =="Telangana")/length(state),
            q5_tripura=sum(Merged =="Tripura")/length(state),
            q5_up=sum(Merged =="Uttar Pradesh")/length(state),
            q5_uttarakhand=sum(Merged =="Uttarakhand")/length(state),
            q5_wb=sum(Merged =="West Bengal")/length(state),.groups='drop') %>% 
  ungroup() %>% 
  mutate(total=rowSums(select_if(., is.numeric), na.rm = TRUE)) %>% 
  add_row(state="Nagaland") %>% 
  arrange(state) 
#There are no old officers from Nagaland. The summary produced for old officers, thus, is one row shorter. In order to cbind this dataset with other (like ias_processed_dta) for weight calculations, we have added these states with NAs to match the number of rows across datasets. This is done for all summaries for young and old officers.
summary_q5_old <- summary_q5_old %>% 
  mutate(state_old_weight=ias_processed_dta$state_old_weight)

#Calculating for Q5 for *unbiased* old officers only 
summary_q5_old_unbiased <- state_answers_q5_old_unbiased %>% 
  group_by(state) %>% 
  na.omit() %>% 
  summarise(q5_anislands=sum(Merged =="Andaman and Nicobar Islands")/length(state),
            q5_andhra=sum(Merged =="Andhra Pradesh")/length(state), 
            q5_arunachal=sum(Merged =="Arunachal Pradesh")/length(state),
            q5_assam=sum(Merged =="Assam")/length(state),
            q5_bihar=sum(Merged =="Bihar")/length(state),
            q5_chandigarh=sum(Merged =="Chandigarh")/length(state),
            q5_chhattisgarh=sum(Merged =="Chhattisgarh")/length(state),
            q5_dnhdd=sum(Merged =="Dadra and Nagar Haveli and Daman and Dui")/length(state),
            q5_goa=sum(Merged =="Goa")/length(state),
            q5_gujarat=sum(Merged =="Gujarat")/length(state),
            q5_haryana=sum(Merged =="Haryana")/length(state),
            q5_hp=sum(Merged =="Himachal Pradesh")/length(state),
            q5_jk=sum(Merged =="Jammu and Kashmir")/length(state),
            q5_jharkhand=sum(Merged =="Jharkhand")/length(state),
            q5_karnataka=sum(Merged =="Karnataka")/length(state),
            q5_kerala=sum(Merged =="Kerala")/length(state),
            q5_ladakh=sum(Merged =="Ladakh")/length(state),
            q5_lakshadweep=sum(Merged =="Lakshadweep")/length(state),
            q5_mp=sum(Merged =="Madhya Pradesh")/length(state),
            q5_maharashtra=sum(Merged =="Maharashtra")/length(state),
            q5_manipur=sum(Merged =="Manipur")/length(state),
            q5_meghalaya=sum(Merged =="Meghalaya")/length(state),
            q5_mizoram=sum(Merged =="Mizoram")/length(state),
            q5_nagaland=sum(Merged =="Nagaland")/length(state),
            q5_delhi=sum(Merged =="NCT of Delhi")/length(state),
            q5_none=sum(Merged =="No state has performed well")/length(state),
            q5_odisha=sum(Merged =="Odisha")/length(state),
            q5_puducherry=sum(Merged =="Puducherry")/length(state),
            q5_punjab=sum(Merged =="Punjab")/length(state),
            q5_rajasthan=sum(Merged =="Rajasthan")/length(state),
            q5_sikkim=sum(Merged =="Sikkim")/length(state),
            q5_tn=sum(Merged =="Tamil Nadu")/length(state),
            q5_telangana=sum(Merged =="Telangana")/length(state),
            q5_tripura=sum(Merged =="Tripura")/length(state),
            q5_up=sum(Merged =="Uttar Pradesh")/length(state),
            q5_uttarakhand=sum(Merged =="Uttarakhand")/length(state),
            q5_wb=sum(Merged =="West Bengal")/length(state),.groups='drop') %>% 
  ungroup() %>% 
  mutate(total=rowSums(select_if(., is.numeric), na.rm = TRUE)) %>% 
  add_row(state="Nagaland") %>% 
  arrange(state) 
#There are no old officers from Nagaland. The summary produced for old officers, thus, is one row shorter. In order to cbind this dataset with other (like ias_processed_dta) for weight calculations, we have added these states with NAs to match the number of rows across datasets. This is done for all summaries for young and old officers.
summary_q5_old_unbiased <- summary_q5_old_unbiased %>% 
  mutate(state_old_weight=ias_processed_dta$state_old_weight)
```

```{r, include=FALSE}
#For former officers only: calculating averages for question 5 
q5_state_answers1_former <- full_former %>% 
  dplyr::select (Merged2.1, X12) %>% 
  mutate (Merged = Merged2.1) %>% 
  dplyr:: select(-Merged2.1)

state_answers_q5_former <- full_former %>% 
  dplyr::select (Merged2.2, X12)%>% 
  mutate (Merged = Merged2.2) %>% 
  dplyr:: select (-Merged2.2) %>% 
  add_row(q5_state_answers1_former) 

state_answers_q5_former <- state_answers_q5_former %>% 
  mutate(state_bias=(ifelse(Merged=="Andaman and Nicobar Islands" & X12=="AGMUT",1,
                     ifelse(Merged=="Andhra Pradesh" & X12=="Andhra Pradesh", 1,        
                     ifelse(Merged=="Arunachal Pradesh" & X12=="AGMUT",1,
                     ifelse(Merged=="Assam" & X12=="Assam Meghalaya",1,
                     ifelse(Merged=="Bihar" & X12=="Bihar",1,
                     ifelse(Merged=="Chandigarh" & X12=="AGMUT",1,
                     ifelse(Merged=="Chattisgarh" & X12=="Chattisgarh",1,
                     ifelse(Merged=="Dadra and Nagar Haveli and Daman and Dui" & X12=="AGMUT",1,      
                     ifelse(Merged=="Goa" & X12=="AGMUT",1,
                     ifelse(Merged=="Gujarat" & X12=="Gujarat",1,
                     ifelse(Merged=="Haryana" & X12=="Haryana",1,
                     ifelse(Merged=="Himachal Pradesh" & X12=="Himachal Pradesh",1,
                     ifelse(Merged=="Jammu and Kashmir" & X12=="Jammu and Kashmir",1,
                     ifelse(Merged=="Jharkhand" & X12=="Jharkhand",1,
                     ifelse(Merged=="Karnataka" & X12=="Karnataka",1,
                     ifelse(Merged=="Kerala" & X12=="Kerala",1,
                     ifelse(Merged=="Ladakh" & X12=="Jammu and Kashmir",1,
                     ifelse(Merged=="Lakshadweep" & X12=="AGMUT",1,       
                     ifelse(Merged=="Madhya Pradesh" & X12=="Madhya Pradesh",1,
                     ifelse(Merged=="Maharashtra" & X12=="Maharashtra",1,
                     ifelse(Merged=="Manipur" & X12=="Manipur",1,
                     ifelse(Merged=="Meghalaya" & X12=="Assam Meghalaya",1,
                     ifelse(Merged=="Mizoram" & X12=="AGMUT",1,       
                     ifelse(Merged=="Nagaland" & X12=="Nagaland",1,
                     ifelse(Merged=="NCT of Delhi" & X12=="AGMUT",1, 
                     ifelse(Merged=="Odisha" & X12=="Odisha",1,
                     ifelse(Merged=="Puducherry" & X12=="AGMUT",1,        
                     ifelse(Merged=="Punjab" & X12=="Punjab",1,
                     ifelse(Merged=="Rajasthan" & X12=="Rajasthan",1,
                     ifelse(Merged=="Sikkim" & X12=="Sikkim",1,
                     ifelse(Merged=="Tamil Nadu" & X12=="Tamil Nadu",1,
                     ifelse(Merged=="Telangana" & X12=="Telangana",1,
                     ifelse(Merged=="Tripura" & X12=="Tripura",1,
                     ifelse(Merged=="Uttar Pradesh" & X12=="Uttar Pradesh",1,
                     ifelse(Merged=="Uttarakhand" & X12=="Uttarakhand",1,
                     ifelse(Merged=="West Bengal" & X12=="West Bengal",1,0))))))))))))))))))))))))))))))))))))))

#8 old officers selected their own state 
#They are from the following states:
bias<-which(state_answers_q5_former$state_bias==1)
table(state_answers_q5_former$X12[bias])

#filtering out all officers who selected their own state 
state_answers_q5_former_unbiased <- state_answers_q5_former %>% 
  filter(!state_bias==1)

#Calculating averages for Q5 for all former officers 
summary_q5_former <- state_answers_q5_former %>% 
  na.omit() %>% 
  summarise(q5_anislands=sum(Merged =="Andaman and Nicobar Islands")/length(Merged),
            q5_andhra=sum(Merged =="Andhra Pradesh")/length(Merged), 
            q5_arunachal=sum(Merged =="Arunachal Pradesh")/length(Merged),
            q5_assam=sum(Merged =="Assam")/length(Merged),
            q5_bihar=sum(Merged =="Bihar")/length(Merged),
            q5_chandigarh=sum(Merged =="Chandigarh")/length(Merged),
            q5_chhattisgarh=sum(Merged =="Chhattisgarh")/length(Merged),
            q5_dnhdd=sum(Merged =="Dadra and Nagar Haveli and Daman and Dui")/length(Merged),
            q5_goa=sum(Merged =="Goa")/length(Merged),
            q5_gujarat=sum(Merged =="Gujarat")/length(Merged),
            q5_haryana=sum(Merged =="Haryana")/length(Merged),
            q5_hp=sum(Merged =="Himachal Pradesh")/length(Merged),
            q5_jk=sum(Merged =="Jammu and Kashmir")/length(Merged),
            q5_jharkhand=sum(Merged =="Jharkhand")/length(Merged),
            q5_karnataka=sum(Merged =="Karnataka")/length(Merged),
            q5_kerala=sum(Merged =="Kerala")/length(Merged),
            q5_ladakh=sum(Merged =="Ladakh")/length(Merged),
            q5_lakshadweep=sum(Merged =="Lakshadweep")/length(Merged),
            q5_mp=sum(Merged =="Madhya Pradesh")/length(Merged),
            q5_maharashtra=sum(Merged =="Maharashtra")/length(Merged),
            q5_manipur=sum(Merged =="Manipur")/length(Merged),
            q5_meghalaya=sum(Merged =="Meghalaya")/length(Merged),
            q5_mizoram=sum(Merged =="Mizoram")/length(Merged),
            q5_nagaland=sum(Merged =="Nagaland")/length(Merged),
            q5_delhi=sum(Merged =="NCT of Delhi")/length(Merged),
            q5_none=sum(Merged =="No state has performed well")/length(Merged),
            q5_odisha=sum(Merged =="Odisha")/length(Merged),
            q5_puducherry=sum(Merged =="Puducherry")/length(Merged),
            q5_punjab=sum(Merged =="Punjab")/length(Merged),
            q5_rajasthan=sum(Merged =="Rajasthan")/length(Merged),
            q5_sikkim=sum(Merged =="Sikkim")/length(Merged),
            q5_tn=sum(Merged =="Tamil Nadu")/length(Merged),
            q5_telangana=sum(Merged =="Telangana")/length(Merged),
            q5_tripura=sum(Merged =="Tripura")/length(Merged),
            q5_up=sum(Merged =="Uttar Pradesh")/length(Merged),
            q5_uttarakhand=sum(Merged =="Uttarakhand")/length(Merged),
            q5_wb=sum(Merged =="West Bengal")/length(Merged),.groups='drop') %>% 
  ungroup() %>% 
  mutate(total=rowSums(select_if(., is.numeric), na.rm = TRUE)) 

#Calculating averages for Q5 for *unbiased* former officers only
summary_q5_former_unbiased <- state_answers_q5_former_unbiased %>% 
  na.omit() %>% 
  summarise(q5_anislands=sum(Merged =="Andaman and Nicobar Islands")/length(Merged),
            q5_andhra=sum(Merged =="Andhra Pradesh")/length(Merged), 
            q5_arunachal=sum(Merged =="Arunachal Pradesh")/length(Merged),
            q5_assam=sum(Merged =="Assam")/length(Merged),
            q5_bihar=sum(Merged =="Bihar")/length(Merged),
            q5_chandigarh=sum(Merged =="Chandigarh")/length(Merged),
            q5_chhattisgarh=sum(Merged =="Chhattisgarh")/length(Merged),
            q5_dnhdd=sum(Merged =="Dadra and Nagar Haveli and Daman and Dui")/length(Merged),
            q5_goa=sum(Merged =="Goa")/length(Merged),
            q5_gujarat=sum(Merged =="Gujarat")/length(Merged),
            q5_haryana=sum(Merged =="Haryana")/length(Merged),
            q5_hp=sum(Merged =="Himachal Pradesh")/length(Merged),
            q5_jk=sum(Merged =="Jammu and Kashmir")/length(Merged),
            q5_jharkhand=sum(Merged =="Jharkhand")/length(Merged),
            q5_karnataka=sum(Merged =="Karnataka")/length(Merged),
            q5_kerala=sum(Merged =="Kerala")/length(Merged),
            q5_ladakh=sum(Merged =="Ladakh")/length(Merged),
            q5_lakshadweep=sum(Merged =="Lakshadweep")/length(Merged),
            q5_mp=sum(Merged =="Madhya Pradesh")/length(Merged),
            q5_maharashtra=sum(Merged =="Maharashtra")/length(Merged),
            q5_manipur=sum(Merged =="Manipur")/length(Merged),
            q5_meghalaya=sum(Merged =="Meghalaya")/length(Merged),
            q5_mizoram=sum(Merged =="Mizoram")/length(Merged),
            q5_nagaland=sum(Merged =="Nagaland")/length(Merged),
            q5_delhi=sum(Merged =="NCT of Delhi")/length(Merged),
            q5_none=sum(Merged =="No state has performed well")/length(Merged),
            q5_odisha=sum(Merged =="Odisha")/length(Merged),
            q5_puducherry=sum(Merged =="Puducherry")/length(Merged),
            q5_punjab=sum(Merged =="Punjab")/length(Merged),
            q5_rajasthan=sum(Merged =="Rajasthan")/length(Merged),
            q5_sikkim=sum(Merged =="Sikkim")/length(Merged),
            q5_tn=sum(Merged =="Tamil Nadu")/length(Merged),
            q5_telangana=sum(Merged =="Telangana")/length(Merged),
            q5_tripura=sum(Merged =="Tripura")/length(Merged),
            q5_up=sum(Merged =="Uttar Pradesh")/length(Merged),
            q5_uttarakhand=sum(Merged =="Uttarakhand")/length(Merged),
            q5_wb=sum(Merged =="West Bengal")/length(Merged),.groups='drop') %>% 
  ungroup() %>% 
  mutate(total=rowSums(select_if(., is.numeric), na.rm = TRUE)) 
```

```{r, include=FALSE}
#Calculating averages for question 6 (previously "Merged 3")
q6 <- full_serving %>% 
dplyr::select (state, Merged3, X12) %>% 
mutate (Merged = Merged3) %>% 
dplyr:: select(-Merged3)

#Adding a column to indicate bias
q6 <- q6 %>% 
  mutate(state_bias=(ifelse(Merged=="Andaman and Nicobar Islands" & X12=="AGMUT",1,
                     ifelse(Merged=="Andhra Pradesh" & X12=="Andhra Pradesh", 1,        
                     ifelse(Merged=="Arunachal Pradesh" & X12=="AGMUT",1,
                     ifelse(Merged=="Assam" & X12=="Assam Meghalaya",1,
                     ifelse(Merged=="Bihar" & X12=="Bihar",1,
                     ifelse(Merged=="Chandigarh" & X12=="AGMUT",1,
                     ifelse(Merged=="Chattisgarh" & X12=="Chattisgarh",1,
                     ifelse(Merged=="Dadra and Nagar Haveli and Daman and Dui" & X12=="AGMUT",1,      
                     ifelse(Merged=="Goa" & X12=="AGMUT",1,
                     ifelse(Merged=="Gujarat" & X12=="Gujarat",1,
                     ifelse(Merged=="Haryana" & X12=="Haryana",1,
                     ifelse(Merged=="Himachal Pradesh" & X12=="Himachal Pradesh",1,
                     ifelse(Merged=="Jammu and Kashmir" & X12=="Jammu and Kashmir",1,
                     ifelse(Merged=="Jharkhand" & X12=="Jharkhand",1,
                     ifelse(Merged=="Karnataka" & X12=="Karnataka",1,
                     ifelse(Merged=="Kerala" & X12=="Kerala",1,
                     ifelse(Merged=="Ladakh" & X12=="Jammu and Kashmir",1,
                     ifelse(Merged=="Lakshadweep" & X12=="AGMUT",1,       
                     ifelse(Merged=="Madhya Pradesh" & X12=="Madhya Pradesh",1,
                     ifelse(Merged=="Maharashtra" & X12=="Maharashtra",1,
                     ifelse(Merged=="Manipur" & X12=="Manipur",1,
                     ifelse(Merged=="Meghalaya" & X12=="Assam Meghalaya",1,
                     ifelse(Merged=="Mizoram" & X12=="AGMUT",1,       
                     ifelse(Merged=="Nagaland" & X12=="Nagaland",1,
                     ifelse(Merged=="NCT of Delhi" & X12=="AGMUT",1, 
                     ifelse(Merged=="Odisha" & X12=="Odisha",1,
                     ifelse(Merged=="Puducherry" & X12=="AGMUT",1,        
                     ifelse(Merged=="Punjab" & X12=="Punjab",1,
                     ifelse(Merged=="Rajasthan" & X12=="Rajasthan",1,
                     ifelse(Merged=="Sikkim" & X12=="Sikkim",1,
                     ifelse(Merged=="Tamil Nadu" & X12=="Tamil Nadu",1,
                     ifelse(Merged=="Telangana" & X12=="Telangana",1,
                     ifelse(Merged=="Tripura" & X12=="Tripura",1,
                     ifelse(Merged=="Uttar Pradesh" & X12=="Uttar Pradesh",1,
                     ifelse(Merged=="Uttarakhand" & X12=="Uttarakhand",1,
                     ifelse(Merged=="West Bengal" & X12=="West Bengal",1,0))))))))))))))))))))))))))))))))))))))

#171 officers selected their own state 
#They are from the following states:
bias<-which(q6$state_bias==1)
biased_officers<-as.data.frame(table(q6$X12[bias])) %>% 
  dplyr::select(-Var1) %>% 
  rename(No.of_Bias=Freq)

cadre_strength<-as.data.frame(table(full_serving$X12)) %>% 
  filter(!Var1=="Chattisgarh", !Var1=="Manipur", !Var1=="Nagaland", !Var1=="Uttarakhand") %>% 
  rename(Cadre=Var1) %>% 
  rename(Cadre_Strength=Freq)
#Table displaying the proportion of officers who showed bias in each state
compare<-cbind(cadre_strength, biased_officers) %>% 
  mutate(Prop_of_Bias=round(No.of_Bias/Cadre_Strength*100,2))

comparedf(biased_officers, cadre_strength)
#filtering out all officers who selected their own state 
q6_unbiased <- q6_unbiased %>% 
  filter(!state_bias==1)

#Calculating averages for Q6 for all officers
summary_q6 <- q6 %>% 
  group_by(state) %>% 
  na.omit() %>% 
  summarise(q6_anislands=sum(Merged =="Andaman and Nicobar Islands")/length(state),
            q6_andhra=sum(Merged =="Andhra Pradesh")/length(state), 
            q6_arunachal=sum(Merged =="Arunachal Pradesh")/length(state),
            q6_assam=sum(Merged =="Assam")/length(state),
            q6_bihar=sum(Merged =="Bihar")/length(state),
            q6_chandigarh=sum(Merged =="Chandigarh")/length(state),
            q6_chhattisgarh=sum(Merged =="Chhattisgarh")/length(state),
            q6_dnhdd=sum(Merged =="Dadra and Nagar Haveli and Daman and Dui")/length(state),
            q6_goa=sum(Merged =="Goa")/length(state),
            q6_gujarat=sum(Merged =="Gujarat")/length(state),
            q6_haryana=sum(Merged =="Haryana")/length(state),
            q6_hp=sum(Merged =="Himachal Pradesh")/length(state),
            q6_jk=sum(Merged =="Jammu and Kashmir")/length(state),
            q6_jharkhand=sum(Merged =="Jharkhand")/length(state),
            q6_karnataka=sum(Merged =="Karnataka")/length(state),
            q6_kerala=sum(Merged =="Kerala")/length(state),
            q6_ladakh=sum(Merged =="Ladakh")/length(state),
            q6_lakshadweep=sum(Merged =="Lakshadweep")/length(state),
            q6_mp=sum(Merged =="Madhya Pradesh")/length(state),
            q6_maharashtra=sum(Merged =="Maharashtra")/length(state),
            q6_manipur=sum(Merged =="Manipur")/length(state),
            q6_meghalaya=sum(Merged =="Meghalaya")/length(state),
            q6_mizoram=sum(Merged =="Mizoram")/length(state),
            q6_nagaland=sum(Merged =="Nagaland")/length(state),
            q6_delhi=sum(Merged =="NCT of Delhi")/length(state),
            q6_none=sum(Merged =="No state has been under-appreciated")/length(state),
            q6_odisha=sum(Merged =="Odisha")/length(state),
            q6_puducherry=sum(Merged =="Puducherry")/length(state),
            q6_punjab=sum(Merged =="Punjab")/length(state),
            q6_rajasthan=sum(Merged =="Rajasthan")/length(state),
            q6_sikkim=sum(Merged =="Sikkim")/length(state),
            q6_tn=sum(Merged =="Tamil Nadu")/length(state),
            q6_telangana=sum(Merged =="Telangana")/length(state),
            q6_tripura=sum(Merged =="Tripura")/length(state),
            q6_up=sum(Merged =="Uttar Pradesh")/length(state),
            q6_uttarakhand=sum(Merged =="Uttarakhand")/length(state),
            q6_wb=sum(Merged =="West Bengal")/length(state),.groups='drop') %>% 
  ungroup() %>% 
  mutate(total=rowSums(select_if(., is.numeric), na.rm = TRUE))

summary_q6 <- summary_q6 %>% 
  mutate(state_weight=ias_processed_dta$state_weight) %>% 
  mutate(sdg_weight=ias_processed_dta$sdg_weight) 


#Calculating averages for Q6 for *unbiasd* officers only
summary_q6_unbiased <- q6_unbiased %>% 
  group_by(state) %>% 
  na.omit() %>% 
  summarise(q6_anislands=sum(Merged =="Andaman and Nicobar Islands")/length(state),
            q6_andhra=sum(Merged =="Andhra Pradesh")/length(state), 
            q6_arunachal=sum(Merged =="Arunachal Pradesh")/length(state),
            q6_assam=sum(Merged =="Assam")/length(state),
            q6_bihar=sum(Merged =="Bihar")/length(state),
            q6_chandigarh=sum(Merged =="Chandigarh")/length(state),
            q6_chhattisgarh=sum(Merged =="Chhattisgarh")/length(state),
            q6_dnhdd=sum(Merged =="Dadra and Nagar Haveli and Daman and Dui")/length(state),
            q6_goa=sum(Merged =="Goa")/length(state),
            q6_gujarat=sum(Merged =="Gujarat")/length(state),
            q6_haryana=sum(Merged =="Haryana")/length(state),
            q6_hp=sum(Merged =="Himachal Pradesh")/length(state),
            q6_jk=sum(Merged =="Jammu and Kashmir")/length(state),
            q6_jharkhand=sum(Merged =="Jharkhand")/length(state),
            q6_karnataka=sum(Merged =="Karnataka")/length(state),
            q6_kerala=sum(Merged =="Kerala")/length(state),
            q6_ladakh=sum(Merged =="Ladakh")/length(state),
            q6_lakshadweep=sum(Merged =="Lakshadweep")/length(state),
            q6_mp=sum(Merged =="Madhya Pradesh")/length(state),
            q6_maharashtra=sum(Merged =="Maharashtra")/length(state),
            q6_manipur=sum(Merged =="Manipur")/length(state),
            q6_meghalaya=sum(Merged =="Meghalaya")/length(state),
            q6_mizoram=sum(Merged =="Mizoram")/length(state),
            q6_nagaland=sum(Merged =="Nagaland")/length(state),
            q6_delhi=sum(Merged =="NCT of Delhi")/length(state),
            q6_none=sum(Merged =="No state has been under-appreciated")/length(state),
            q6_odisha=sum(Merged =="Odisha")/length(state),
            q6_puducherry=sum(Merged =="Puducherry")/length(state),
            q6_punjab=sum(Merged =="Punjab")/length(state),
            q6_rajasthan=sum(Merged =="Rajasthan")/length(state),
            q6_sikkim=sum(Merged =="Sikkim")/length(state),
            q6_tn=sum(Merged =="Tamil Nadu")/length(state),
            q6_telangana=sum(Merged =="Telangana")/length(state),
            q6_tripura=sum(Merged =="Tripura")/length(state),
            q6_up=sum(Merged =="Uttar Pradesh")/length(state),
            q6_uttarakhand=sum(Merged =="Uttarakhand")/length(state),
            q6_wb=sum(Merged =="West Bengal")/length(state),.groups='drop') %>% 
  ungroup() %>% 
  mutate(total=rowSums(select_if(., is.numeric), na.rm = TRUE))

summary_q6_unbiased <- summary_q6_unbiased %>% 
  mutate(state_weight=ias_processed_dta$state_weight) %>% 
  mutate(sdg_weight=ias_processed_dta$sdg_weight) 
```

```{r, include=FALSE}
#Question 6: for young officers only
state_answers_q6_young <- fullage_young %>% 
dplyr::select (state, Merged3, X12) %>% 
mutate (Merged = Merged3) %>% 
dplyr:: select(-Merged3)

#Adding a column to indicate bias
state_answers_q6_young <- state_answers_q6_young %>% 
  mutate(state_bias=(ifelse(Merged=="Andaman and Nicobar Islands" & X12=="AGMUT",1,
                     ifelse(Merged=="Andhra Pradesh" & X12=="Andhra Pradesh", 1,        
                     ifelse(Merged=="Arunachal Pradesh" & X12=="AGMUT",1,
                     ifelse(Merged=="Assam" & X12=="Assam Meghalaya",1,
                     ifelse(Merged=="Bihar" & X12=="Bihar",1,
                     ifelse(Merged=="Chandigarh" & X12=="AGMUT",1,
                     ifelse(Merged=="Chattisgarh" & X12=="Chattisgarh",1,
                     ifelse(Merged=="Dadra and Nagar Haveli and Daman and Dui" & X12=="AGMUT",1,      
                     ifelse(Merged=="Goa" & X12=="AGMUT",1,
                     ifelse(Merged=="Gujarat" & X12=="Gujarat",1,
                     ifelse(Merged=="Haryana" & X12=="Haryana",1,
                     ifelse(Merged=="Himachal Pradesh" & X12=="Himachal Pradesh",1,
                     ifelse(Merged=="Jammu and Kashmir" & X12=="Jammu and Kashmir",1,
                     ifelse(Merged=="Jharkhand" & X12=="Jharkhand",1,
                     ifelse(Merged=="Karnataka" & X12=="Karnataka",1,
                     ifelse(Merged=="Kerala" & X12=="Kerala",1,
                     ifelse(Merged=="Ladakh" & X12=="Jammu and Kashmir",1,
                     ifelse(Merged=="Lakshadweep" & X12=="AGMUT",1,       
                     ifelse(Merged=="Madhya Pradesh" & X12=="Madhya Pradesh",1,
                     ifelse(Merged=="Maharashtra" & X12=="Maharashtra",1,
                     ifelse(Merged=="Manipur" & X12=="Manipur",1,
                     ifelse(Merged=="Meghalaya" & X12=="Assam Meghalaya",1,
                     ifelse(Merged=="Mizoram" & X12=="AGMUT",1,       
                     ifelse(Merged=="Nagaland" & X12=="Nagaland",1,
                     ifelse(Merged=="NCT of Delhi" & X12=="AGMUT",1, 
                     ifelse(Merged=="Odisha" & X12=="Odisha",1,
                     ifelse(Merged=="Puducherry" & X12=="AGMUT",1,        
                     ifelse(Merged=="Punjab" & X12=="Punjab",1,
                     ifelse(Merged=="Rajasthan" & X12=="Rajasthan",1,
                     ifelse(Merged=="Sikkim" & X12=="Sikkim",1,
                     ifelse(Merged=="Tamil Nadu" & X12=="Tamil Nadu",1,
                     ifelse(Merged=="Telangana" & X12=="Telangana",1,
                     ifelse(Merged=="Tripura" & X12=="Tripura",1,
                     ifelse(Merged=="Uttar Pradesh" & X12=="Uttar Pradesh",1,
                     ifelse(Merged=="Uttarakhand" & X12=="Uttarakhand",1,
                     ifelse(Merged=="West Bengal" & X12=="West Bengal",1,0))))))))))))))))))))))))))))))))))))))

#100 young officers selected their own state 
#They are from the following states:
bias<-which(state_answers_q6_young$state_bias==1)
table(state_answers_q6_young$X12[bias])  

#filtering out all officers who selected their own state 
state_answers_q6_young_unbiased <- state_answers_q6_young_unbiased %>% 
  filter(!state_bias==1)

#Calculating averages for Q6 for all young officers
summary_q6_young <- state_answers_q6_young %>% 
  group_by(state) %>% 
  na.omit() %>% 
  summarise(q6_anislands=sum(Merged =="Andaman and Nicobar Islands")/length(state),
            q6_andhra=sum(Merged =="Andhra Pradesh")/length(state), 
            q6_arunachal=sum(Merged =="Arunachal Pradesh")/length(state),
            q6_assam=sum(Merged =="Assam")/length(state),
            q6_bihar=sum(Merged =="Bihar")/length(state),
            q6_chandigarh=sum(Merged =="Chandigarh")/length(state),
            q6_chhattisgarh=sum(Merged =="Chhattisgarh")/length(state),
            q6_dnhdd=sum(Merged =="Dadra and Nagar Haveli and Daman and Dui")/length(state),
            q6_goa=sum(Merged =="Goa")/length(state),
            q6_gujarat=sum(Merged =="Gujarat")/length(state),
            q6_haryana=sum(Merged =="Haryana")/length(state),
            q6_hp=sum(Merged =="Himachal Pradesh")/length(state),
            q6_jk=sum(Merged =="Jammu and Kashmir")/length(state),
            q6_jharkhand=sum(Merged =="Jharkhand")/length(state),
            q6_karnataka=sum(Merged =="Karnataka")/length(state),
            q6_kerala=sum(Merged =="Kerala")/length(state),
            q6_ladakh=sum(Merged =="Ladakh")/length(state),
            q6_lakshadweep=sum(Merged =="Lakshadweep")/length(state),
            q6_mp=sum(Merged =="Madhya Pradesh")/length(state),
            q6_maharashtra=sum(Merged =="Maharashtra")/length(state),
            q6_manipur=sum(Merged =="Manipur")/length(state),
            q6_meghalaya=sum(Merged =="Meghalaya")/length(state),
            q6_mizoram=sum(Merged =="Mizoram")/length(state),
            q6_nagaland=sum(Merged =="Nagaland")/length(state),
            q6_delhi=sum(Merged =="NCT of Delhi")/length(state),
            q6_none=sum(Merged =="No state has been under-appreciated")/length(state),
            q6_odisha=sum(Merged =="Odisha")/length(state),
            q6_puducherry=sum(Merged =="Puducherry")/length(state),
            q6_punjab=sum(Merged =="Punjab")/length(state),
            q6_rajasthan=sum(Merged =="Rajasthan")/length(state),
            q6_sikkim=sum(Merged =="Sikkim")/length(state),
            q6_tn=sum(Merged =="Tamil Nadu")/length(state),
            q6_telangana=sum(Merged =="Telangana")/length(state),
            q6_tripura=sum(Merged =="Tripura")/length(state),
            q6_up=sum(Merged =="Uttar Pradesh")/length(state),
            q6_uttarakhand=sum(Merged =="Uttarakhand")/length(state),
            q6_wb=sum(Merged =="West Bengal")/length(state),.groups='drop') %>% 
  ungroup() %>% 
  mutate(total=rowSums(select_if(., is.numeric), na.rm = TRUE)) %>% 
  add_row(state="Andaman and Nicobar Islands") %>% 
  add_row(state="Chandigarh") %>% 
  add_row(state="Lakshadweep Islands") %>%
  add_row(state="Puducherry") %>% 
  add_row(state="Mizoram") %>% 
  arrange(state) 
#There are no young officers from A and N Islands, Chandigarh, Lakshadweep Islands, Puducherry and Mizoram. The summary produced for young officers, thus, is five rows shorter. In order to cbind this dataset with other (like ias_processed_dta) for weight calculations, we have added these states with NAs to match the number of rows across datasets. This is done for all summaries for young and old officers.
summary_q6_young <- summary_q6_young %>% 
  mutate(state_young_weight=ias_processed_dta$state_young_weight)

#Calculating averages for Q6 for *unbiased* young officers only
summary_q6_young_unbiased <- state_answers_q6_young_unbiased %>% 
  group_by(state) %>% 
  na.omit() %>% 
  summarise(q6_anislands=sum(Merged =="Andaman and Nicobar Islands")/length(state),
            q6_andhra=sum(Merged =="Andhra Pradesh")/length(state), 
            q6_arunachal=sum(Merged =="Arunachal Pradesh")/length(state),
            q6_assam=sum(Merged =="Assam")/length(state),
            q6_bihar=sum(Merged =="Bihar")/length(state),
            q6_chandigarh=sum(Merged =="Chandigarh")/length(state),
            q6_chhattisgarh=sum(Merged =="Chhattisgarh")/length(state),
            q6_dnhdd=sum(Merged =="Dadra and Nagar Haveli and Daman and Dui")/length(state),
            q6_goa=sum(Merged =="Goa")/length(state),
            q6_gujarat=sum(Merged =="Gujarat")/length(state),
            q6_haryana=sum(Merged =="Haryana")/length(state),
            q6_hp=sum(Merged =="Himachal Pradesh")/length(state),
            q6_jk=sum(Merged =="Jammu and Kashmir")/length(state),
            q6_jharkhand=sum(Merged =="Jharkhand")/length(state),
            q6_karnataka=sum(Merged =="Karnataka")/length(state),
            q6_kerala=sum(Merged =="Kerala")/length(state),
            q6_ladakh=sum(Merged =="Ladakh")/length(state),
            q6_lakshadweep=sum(Merged =="Lakshadweep")/length(state),
            q6_mp=sum(Merged =="Madhya Pradesh")/length(state),
            q6_maharashtra=sum(Merged =="Maharashtra")/length(state),
            q6_manipur=sum(Merged =="Manipur")/length(state),
            q6_meghalaya=sum(Merged =="Meghalaya")/length(state),
            q6_mizoram=sum(Merged =="Mizoram")/length(state),
            q6_nagaland=sum(Merged =="Nagaland")/length(state),
            q6_delhi=sum(Merged =="NCT of Delhi")/length(state),
            q6_none=sum(Merged =="No state has been under-appreciated")/length(state),
            q6_odisha=sum(Merged =="Odisha")/length(state),
            q6_puducherry=sum(Merged =="Puducherry")/length(state),
            q6_punjab=sum(Merged =="Punjab")/length(state),
            q6_rajasthan=sum(Merged =="Rajasthan")/length(state),
            q6_sikkim=sum(Merged =="Sikkim")/length(state),
            q6_tn=sum(Merged =="Tamil Nadu")/length(state),
            q6_telangana=sum(Merged =="Telangana")/length(state),
            q6_tripura=sum(Merged =="Tripura")/length(state),
            q6_up=sum(Merged =="Uttar Pradesh")/length(state),
            q6_uttarakhand=sum(Merged =="Uttarakhand")/length(state),
            q6_wb=sum(Merged =="West Bengal")/length(state),.groups='drop') %>% 
  ungroup() %>% 
  mutate(total=rowSums(select_if(., is.numeric), na.rm = TRUE)) %>% 
  add_row(state="Andaman and Nicobar Islands") %>% 
  add_row(state="Chandigarh") %>% 
  add_row(state="Lakshadweep Islands") %>%
  add_row(state="Puducherry") %>% 
  add_row(state="Mizoram") %>% 
  arrange(state) 
#There are no young officers from A and N Islands, Chandigarh, Lakshadweep Islands, Puducherry and Mizoram. The summary produced for young officers, thus, is five rows shorter. In order to cbind this dataset with other (like ias_processed_dta) for weight calculations, we have added these states with NAs to match the number of rows across datasets. This is done for all summaries for young and old officers.
summary_q6_young_unbiased <- summary_q6_young_unbiased %>% 
  mutate(state_young_weight=ias_processed_dta$state_young_weight)
```

```{r, include=FALSE}
#Question 6: for old officers only
state_answers_q6_old <- fullage_old %>% 
dplyr::select (state, Merged3, X12) %>% 
mutate (Merged = Merged3) %>% 
dplyr:: select(-Merged3)

#Adding a column to indicate bias
state_answers_q6_old <- state_answers_q6_old %>% 
  mutate(state_bias=(ifelse(Merged=="Andaman and Nicobar Islands" & X12=="AGMUT",1,
                     ifelse(Merged=="Andhra Pradesh" & X12=="Andhra Pradesh", 1,        
                     ifelse(Merged=="Arunachal Pradesh" & X12=="AGMUT",1,
                     ifelse(Merged=="Assam" & X12=="Assam Meghalaya",1,
                     ifelse(Merged=="Bihar" & X12=="Bihar",1,
                     ifelse(Merged=="Chandigarh" & X12=="AGMUT",1,
                     ifelse(Merged=="Chattisgarh" & X12=="Chattisgarh",1,
                     ifelse(Merged=="Dadra and Nagar Haveli and Daman and Dui" & X12=="AGMUT",1,      
                     ifelse(Merged=="Goa" & X12=="AGMUT",1,
                     ifelse(Merged=="Gujarat" & X12=="Gujarat",1,
                     ifelse(Merged=="Haryana" & X12=="Haryana",1,
                     ifelse(Merged=="Himachal Pradesh" & X12=="Himachal Pradesh",1,
                     ifelse(Merged=="Jammu and Kashmir" & X12=="Jammu and Kashmir",1,
                     ifelse(Merged=="Jharkhand" & X12=="Jharkhand",1,
                     ifelse(Merged=="Karnataka" & X12=="Karnataka",1,
                     ifelse(Merged=="Kerala" & X12=="Kerala",1,
                     ifelse(Merged=="Ladakh" & X12=="Jammu and Kashmir",1,
                     ifelse(Merged=="Lakshadweep" & X12=="AGMUT",1,       
                     ifelse(Merged=="Madhya Pradesh" & X12=="Madhya Pradesh",1,
                     ifelse(Merged=="Maharashtra" & X12=="Maharashtra",1,
                     ifelse(Merged=="Manipur" & X12=="Manipur",1,
                     ifelse(Merged=="Meghalaya" & X12=="Assam Meghalaya",1,
                     ifelse(Merged=="Mizoram" & X12=="AGMUT",1,       
                     ifelse(Merged=="Nagaland" & X12=="Nagaland",1,
                     ifelse(Merged=="NCT of Delhi" & X12=="AGMUT",1, 
                     ifelse(Merged=="Odisha" & X12=="Odisha",1,
                     ifelse(Merged=="Puducherry" & X12=="AGMUT",1,        
                     ifelse(Merged=="Punjab" & X12=="Punjab",1,
                     ifelse(Merged=="Rajasthan" & X12=="Rajasthan",1,
                     ifelse(Merged=="Sikkim" & X12=="Sikkim",1,
                     ifelse(Merged=="Tamil Nadu" & X12=="Tamil Nadu",1,
                     ifelse(Merged=="Telangana" & X12=="Telangana",1,
                     ifelse(Merged=="Tripura" & X12=="Tripura",1,
                     ifelse(Merged=="Uttar Pradesh" & X12=="Uttar Pradesh",1,
                     ifelse(Merged=="Uttarakhand" & X12=="Uttarakhand",1,
                     ifelse(Merged=="West Bengal" & X12=="West Bengal",1,0))))))))))))))))))))))))))))))))))))))

#71 old officers selected their own state 
#They are from the following states:
bias<-which(state_answers_q6_old$state_bias==1)
table(state_answers_q6_old$X12[bias])  

#filtering out all officers who selected their own state 
state_answers_q6_old_unbiased <- state_answers_q6_old_unbiased %>% 
  filter(!state_bias==1)

#Calculating averages for Q6 for all old officers 
summary_q6_old <- state_answers_q6_old %>% 
  group_by(state) %>% 
  na.omit() %>% 
  summarise(q6_anislands=sum(Merged =="Andaman and Nicobar Islands")/length(state),
            q6_andhra=sum(Merged =="Andhra Pradesh")/length(state), 
            q6_arunachal=sum(Merged =="Arunachal Pradesh")/length(state),
            q6_assam=sum(Merged =="Assam")/length(state),
            q6_bihar=sum(Merged =="Bihar")/length(state),
            q6_chandigarh=sum(Merged =="Chandigarh")/length(state),
            q6_chhattisgarh=sum(Merged =="Chhattisgarh")/length(state),
            q6_dnhdd=sum(Merged =="Dadra and Nagar Haveli and Daman and Dui")/length(state),
            q6_goa=sum(Merged =="Goa")/length(state),
            q6_gujarat=sum(Merged =="Gujarat")/length(state),
            q6_haryana=sum(Merged =="Haryana")/length(state),
            q6_hp=sum(Merged =="Himachal Pradesh")/length(state),
            q6_jk=sum(Merged =="Jammu and Kashmir")/length(state),
            q6_jharkhand=sum(Merged =="Jharkhand")/length(state),
            q6_karnataka=sum(Merged =="Karnataka")/length(state),
            q6_kerala=sum(Merged =="Kerala")/length(state),
            q6_ladakh=sum(Merged =="Ladakh")/length(state),
            q6_lakshadweep=sum(Merged =="Lakshadweep")/length(state),
            q6_mp=sum(Merged =="Madhya Pradesh")/length(state),
            q6_maharashtra=sum(Merged =="Maharashtra")/length(state),
            q6_manipur=sum(Merged =="Manipur")/length(state),
            q6_meghalaya=sum(Merged =="Meghalaya")/length(state),
            q6_mizoram=sum(Merged =="Mizoram")/length(state),
            q6_nagaland=sum(Merged =="Nagaland")/length(state),
            q6_delhi=sum(Merged =="NCT of Delhi")/length(state),
            q6_none=sum(Merged =="No state has been under-appreciated")/length(state),
            q6_odisha=sum(Merged =="Odisha")/length(state),
            q6_puducherry=sum(Merged =="Puducherry")/length(state),
            q6_punjab=sum(Merged =="Punjab")/length(state),
            q6_rajasthan=sum(Merged =="Rajasthan")/length(state),
            q6_sikkim=sum(Merged =="Sikkim")/length(state),
            q6_tn=sum(Merged =="Tamil Nadu")/length(state),
            q6_telangana=sum(Merged =="Telangana")/length(state),
            q6_tripura=sum(Merged =="Tripura")/length(state),
            q6_up=sum(Merged =="Uttar Pradesh")/length(state),
            q6_uttarakhand=sum(Merged =="Uttarakhand")/length(state),
            q6_wb=sum(Merged =="West Bengal")/length(state),.groups='drop') %>% 
  ungroup() %>% 
  mutate(total=rowSums(select_if(., is.numeric), na.rm = TRUE)) %>%
  add_row(state="Nagaland") %>% 
  arrange(state) 
#There are no old officers from Nagaland. The summary produced for young officers, thus, is one row shorter. In order to cbind this dataset with other (like ias_processed_dta) for weight calculations, we have added these states with NAs to match the number of rows across datasets. This is done for all summaries for young and old officers.
summary_q6_old <- summary_q6_old %>% 
  mutate(state_old_weight=ias_processed_dta$state_old_weight)


#Calculating averages for Q6 for *unbiased* old officers only 
summary_q6_old_unbiased <- state_answers_q6_old_unbiased %>% 
  group_by(state) %>% 
  na.omit() %>% 
  summarise(q6_anislands=sum(Merged =="Andaman and Nicobar Islands")/length(state),
            q6_andhra=sum(Merged =="Andhra Pradesh")/length(state), 
            q6_arunachal=sum(Merged =="Arunachal Pradesh")/length(state),
            q6_assam=sum(Merged =="Assam")/length(state),
            q6_bihar=sum(Merged =="Bihar")/length(state),
            q6_chandigarh=sum(Merged =="Chandigarh")/length(state),
            q6_chhattisgarh=sum(Merged =="Chhattisgarh")/length(state),
            q6_dnhdd=sum(Merged =="Dadra and Nagar Haveli and Daman and Dui")/length(state),
            q6_goa=sum(Merged =="Goa")/length(state),
            q6_gujarat=sum(Merged =="Gujarat")/length(state),
            q6_haryana=sum(Merged =="Haryana")/length(state),
            q6_hp=sum(Merged =="Himachal Pradesh")/length(state),
            q6_jk=sum(Merged =="Jammu and Kashmir")/length(state),
            q6_jharkhand=sum(Merged =="Jharkhand")/length(state),
            q6_karnataka=sum(Merged =="Karnataka")/length(state),
            q6_kerala=sum(Merged =="Kerala")/length(state),
            q6_ladakh=sum(Merged =="Ladakh")/length(state),
            q6_lakshadweep=sum(Merged =="Lakshadweep")/length(state),
            q6_mp=sum(Merged =="Madhya Pradesh")/length(state),
            q6_maharashtra=sum(Merged =="Maharashtra")/length(state),
            q6_manipur=sum(Merged =="Manipur")/length(state),
            q6_meghalaya=sum(Merged =="Meghalaya")/length(state),
            q6_mizoram=sum(Merged =="Mizoram")/length(state),
            q6_nagaland=sum(Merged =="Nagaland")/length(state),
            q6_delhi=sum(Merged =="NCT of Delhi")/length(state),
            q6_none=sum(Merged =="No state has been under-appreciated")/length(state),
            q6_odisha=sum(Merged =="Odisha")/length(state),
            q6_puducherry=sum(Merged =="Puducherry")/length(state),
            q6_punjab=sum(Merged =="Punjab")/length(state),
            q6_rajasthan=sum(Merged =="Rajasthan")/length(state),
            q6_sikkim=sum(Merged =="Sikkim")/length(state),
            q6_tn=sum(Merged =="Tamil Nadu")/length(state),
            q6_telangana=sum(Merged =="Telangana")/length(state),
            q6_tripura=sum(Merged =="Tripura")/length(state),
            q6_up=sum(Merged =="Uttar Pradesh")/length(state),
            q6_uttarakhand=sum(Merged =="Uttarakhand")/length(state),
            q6_wb=sum(Merged =="West Bengal")/length(state),.groups='drop') %>% 
  ungroup() %>% 
  mutate(total=rowSums(select_if(., is.numeric), na.rm = TRUE)) %>%
  add_row(state="Nagaland") %>% 
  arrange(state) 
#There are no old officers from Nagaland. The summary produced for young officers, thus, is one row shorter. In order to cbind this dataset with other (like ias_processed_dta) for weight calculations, we have added these states with NAs to match the number of rows across datasets. This is done for all summaries for young and old officers.
summary_q6_old_unbiased <- summary_q6_old_unbiased %>% 
  mutate(state_old_weight=ias_processed_dta$state_old_weight)
```

```{r, include=FALSE}
#For former officers only: calculating averages for question 6 
state_answers_q6_former <- full_former %>% 
dplyr::select (Merged3, X12) %>% 
mutate (Merged = Merged3) %>% 
dplyr:: select(-Merged3)

#Adding a column to indicate bias
state_answers_q6_former <- state_answers_q6_former %>% 
  mutate(state_bias=(ifelse(Merged=="Andaman and Nicobar Islands" & X12=="AGMUT",1,
                     ifelse(Merged=="Andhra Pradesh" & X12=="Andhra Pradesh", 1,        
                     ifelse(Merged=="Arunachal Pradesh" & X12=="AGMUT",1,
                     ifelse(Merged=="Assam" & X12=="Assam Meghalaya",1,
                     ifelse(Merged=="Bihar" & X12=="Bihar",1,
                     ifelse(Merged=="Chandigarh" & X12=="AGMUT",1,
                     ifelse(Merged=="Chattisgarh" & X12=="Chattisgarh",1,
                     ifelse(Merged=="Dadra and Nagar Haveli and Daman and Dui" & X12=="AGMUT",1,      
                     ifelse(Merged=="Goa" & X12=="AGMUT",1,
                     ifelse(Merged=="Gujarat" & X12=="Gujarat",1,
                     ifelse(Merged=="Haryana" & X12=="Haryana",1,
                     ifelse(Merged=="Himachal Pradesh" & X12=="Himachal Pradesh",1,
                     ifelse(Merged=="Jammu and Kashmir" & X12=="Jammu and Kashmir",1,
                     ifelse(Merged=="Jharkhand" & X12=="Jharkhand",1,
                     ifelse(Merged=="Karnataka" & X12=="Karnataka",1,
                     ifelse(Merged=="Kerala" & X12=="Kerala",1,
                     ifelse(Merged=="Ladakh" & X12=="Jammu and Kashmir",1,
                     ifelse(Merged=="Lakshadweep" & X12=="AGMUT",1,       
                     ifelse(Merged=="Madhya Pradesh" & X12=="Madhya Pradesh",1,
                     ifelse(Merged=="Maharashtra" & X12=="Maharashtra",1,
                     ifelse(Merged=="Manipur" & X12=="Manipur",1,
                     ifelse(Merged=="Meghalaya" & X12=="Assam Meghalaya",1,
                     ifelse(Merged=="Mizoram" & X12=="AGMUT",1,       
                     ifelse(Merged=="Nagaland" & X12=="Nagaland",1,
                     ifelse(Merged=="NCT of Delhi" & X12=="AGMUT",1, 
                     ifelse(Merged=="Odisha" & X12=="Odisha",1,
                     ifelse(Merged=="Puducherry" & X12=="AGMUT",1,        
                     ifelse(Merged=="Punjab" & X12=="Punjab",1,
                     ifelse(Merged=="Rajasthan" & X12=="Rajasthan",1,
                     ifelse(Merged=="Sikkim" & X12=="Sikkim",1,
                     ifelse(Merged=="Tamil Nadu" & X12=="Tamil Nadu",1,
                     ifelse(Merged=="Telangana" & X12=="Telangana",1,
                     ifelse(Merged=="Tripura" & X12=="Tripura",1,
                     ifelse(Merged=="Uttar Pradesh" & X12=="Uttar Pradesh",1,
                     ifelse(Merged=="Uttarakhand" & X12=="Uttarakhand",1,
                     ifelse(Merged=="West Bengal" & X12=="West Bengal",1,0))))))))))))))))))))))))))))))))))))))

#24 former officers selected their own state 
#They are from the following states:
bias<-which(state_answers_q6_former$state_bias==1)
table(state_answers_q6_former$X12[bias])  

#filtering out all officers who selected their own state 
state_answers_q6_old_unbiased <- state_answers_q6_old %>% 
  filter(!state_bias==1)

#Calculating averages for Q6 for all former officers
summary_q6_former <- state_answers_q6_former %>% 
  na.omit() %>% 
  summarise(q6_anislands=sum(Merged =="Andaman and Nicobar Islands")/length(Merged),
            q6_andhra=sum(Merged =="Andhra Pradesh")/length(Merged), 
            q6_arunachal=sum(Merged =="Arunachal Pradesh")/length(Merged),
            q6_assam=sum(Merged =="Assam")/length(Merged),
            q6_bihar=sum(Merged =="Bihar")/length(Merged),
            q6_chandigarh=sum(Merged =="Chandigarh")/length(Merged),
            q6_chhattisgarh=sum(Merged =="Chhattisgarh")/length(Merged),
            q6_dnhdd=sum(Merged =="Dadra and Nagar Haveli and Daman and Dui")/length(Merged),
            q6_goa=sum(Merged =="Goa")/length(Merged),
            q6_gujarat=sum(Merged =="Gujarat")/length(Merged),
            q6_haryana=sum(Merged =="Haryana")/length(Merged),
            q6_hp=sum(Merged =="Himachal Pradesh")/length(Merged),
            q6_jk=sum(Merged =="Jammu and Kashmir")/length(Merged),
            q6_jharkhand=sum(Merged =="Jharkhand")/length(Merged),
            q6_karnataka=sum(Merged =="Karnataka")/length(Merged),
            q6_kerala=sum(Merged =="Kerala")/length(Merged),
            q6_ladakh=sum(Merged =="Ladakh")/length(Merged),
            q6_lakshadweep=sum(Merged =="Lakshadweep")/length(Merged),
            q6_mp=sum(Merged =="Madhya Pradesh")/length(Merged),
            q6_maharashtra=sum(Merged =="Maharashtra")/length(Merged),
            q6_manipur=sum(Merged =="Manipur")/length(Merged),
            q6_meghalaya=sum(Merged =="Meghalaya")/length(Merged),
            q6_mizoram=sum(Merged =="Mizoram")/length(Merged),
            q6_nagaland=sum(Merged =="Nagaland")/length(Merged),
            q6_delhi=sum(Merged =="NCT of Delhi")/length(Merged),
            q6_none=sum(Merged =="No state has been under-appreciated")/length(Merged),
            q6_odisha=sum(Merged =="Odisha")/length(Merged),
            q6_puducherry=sum(Merged =="Puducherry")/length(Merged),
            q6_punjab=sum(Merged =="Punjab")/length(Merged),
            q6_rajasthan=sum(Merged =="Rajasthan")/length(Merged),
            q6_sikkim=sum(Merged =="Sikkim")/length(Merged),
            q6_tn=sum(Merged =="Tamil Nadu")/length(Merged),
            q6_telangana=sum(Merged =="Telangana")/length(Merged),
            q6_tripura=sum(Merged =="Tripura")/length(Merged),
            q6_up=sum(Merged =="Uttar Pradesh")/length(Merged),
            q6_uttarakhand=sum(Merged =="Uttarakhand")/length(Merged),
            q6_wb=sum(Merged =="West Bengal")/length(Merged),.groups='drop') %>% 
  ungroup() %>% 
  mutate(total=rowSums(select_if(., is.numeric), na.rm = TRUE))

#Calculating averages for Q6 for *unbiased* former officers only
summary_q6_former_unbiased <- state_answers_q6_former_unbiased %>% 
  na.omit() %>% 
  summarise(q6_anislands=sum(Merged =="Andaman and Nicobar Islands")/length(Merged),
            q6_andhra=sum(Merged =="Andhra Pradesh")/length(Merged), 
            q6_arunachal=sum(Merged =="Arunachal Pradesh")/length(Merged),
            q6_assam=sum(Merged =="Assam")/length(Merged),
            q6_bihar=sum(Merged =="Bihar")/length(Merged),
            q6_chandigarh=sum(Merged =="Chandigarh")/length(Merged),
            q6_chhattisgarh=sum(Merged =="Chhattisgarh")/length(Merged),
            q6_dnhdd=sum(Merged =="Dadra and Nagar Haveli and Daman and Dui")/length(Merged),
            q6_goa=sum(Merged =="Goa")/length(Merged),
            q6_gujarat=sum(Merged =="Gujarat")/length(Merged),
            q6_haryana=sum(Merged =="Haryana")/length(Merged),
            q6_hp=sum(Merged =="Himachal Pradesh")/length(Merged),
            q6_jk=sum(Merged =="Jammu and Kashmir")/length(Merged),
            q6_jharkhand=sum(Merged =="Jharkhand")/length(Merged),
            q6_karnataka=sum(Merged =="Karnataka")/length(Merged),
            q6_kerala=sum(Merged =="Kerala")/length(Merged),
            q6_ladakh=sum(Merged =="Ladakh")/length(Merged),
            q6_lakshadweep=sum(Merged =="Lakshadweep")/length(Merged),
            q6_mp=sum(Merged =="Madhya Pradesh")/length(Merged),
            q6_maharashtra=sum(Merged =="Maharashtra")/length(Merged),
            q6_manipur=sum(Merged =="Manipur")/length(Merged),
            q6_meghalaya=sum(Merged =="Meghalaya")/length(Merged),
            q6_mizoram=sum(Merged =="Mizoram")/length(Merged),
            q6_nagaland=sum(Merged =="Nagaland")/length(Merged),
            q6_delhi=sum(Merged =="NCT of Delhi")/length(Merged),
            q6_none=sum(Merged =="No state has been under-appreciated")/length(Merged),
            q6_odisha=sum(Merged =="Odisha")/length(Merged),
            q6_puducherry=sum(Merged =="Puducherry")/length(Merged),
            q6_punjab=sum(Merged =="Punjab")/length(Merged),
            q6_rajasthan=sum(Merged =="Rajasthan")/length(Merged),
            q6_sikkim=sum(Merged =="Sikkim")/length(Merged),
            q6_tn=sum(Merged =="Tamil Nadu")/length(Merged),
            q6_telangana=sum(Merged =="Telangana")/length(Merged),
            q6_tripura=sum(Merged =="Tripura")/length(Merged),
            q6_up=sum(Merged =="Uttar Pradesh")/length(Merged),
            q6_uttarakhand=sum(Merged =="Uttarakhand")/length(Merged),
            q6_wb=sum(Merged =="West Bengal")/length(Merged),.groups='drop') %>% 
  ungroup() %>% 
  mutate(total=rowSums(select_if(., is.numeric), na.rm = TRUE))
```
\newpage

## Question 1: Aggregate Graph 

Most countries in the world experienced a second wave of Covid-19 characterised by higher infection prevalence and rapid viral spread. Which of these statements would you agree with more, in the context of the second wave in India?

\vspace{6mm}
```{r, echo = FALSE}
#Aggregate Graph 
q1full_mean_ones <- round(weighted.mean(summary_state_analysis$X16ones,
summary_state_analysis$state_weight)*100,2) 
q1full_mean_twos <- round(weighted.mean(summary_state_analysis$X16twos,
summary_state_analysis$state_weight)*100,2)
q1full_plot <- c(q1full_mean_ones, q1full_mean_twos) 
q1full_plot_labels <- c("The second Covid-19 surge was expected and should have seen much more advance planning.", "The second Covid-19 surge was unprecedented in its scale and therefore, overwhelmed the health system.") 
q1full_plot_dta <- data.frame(q1full_plot, q1full_plot_labels) 
q1full_plot_dta$wrapped_labels = str_wrap(q1full_plot_dta$q1full_plot_label, width = 10)
q1full_plot <- ggplot(q1full_plot_dta, aes(x=q1full_plot_labels, y=q1full_plot, fill = q1full_plot_labels)) +
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q1full_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,100)) +  
  scale_x_discrete(labels = function(q1full_plot_labels) str_wrap(q1full_plot_labels, width = 40)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent") +
  newtheme

q1full_plot
```
\newpage

## Question 1: Disaggregated by Age 

Most countries in the world experienced a second wave of Covid-19 characterised by higher infection prevalence and rapid viral spread. Which of these statements would you agree with more, in the context of the second wave in India?

\vspace{6mm}
```{r, echo = FALSE, fig.height=10,fig.width=18}
#Age 
q1_plotlabels <- c("The second Covid-19 surge was expected and should have seen much more advance planning.", "The second Covid-19 surge was unprecedented in its scale and therefore, overwhelmed the \n health system.")

q1young_mean_ones <- round(weighted.mean(summary_state_analysis_young$X16ones, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2) 
q1young_mean_twos <- round(weighted.mean(summary_state_analysis_young$X16twos, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2) 
q1_young_plot<-c(q1young_mean_ones, q1young_mean_twos)
q1_young_plotdta <- data.frame(q1_young_plot, q1_plotlabels) 
q1_young_plotdta$wrapped_labels = str_wrap(q1_young_plotdta$q1_plotlabels, width = 10)

q1_young_plot <- ggplot(q1_young_plotdta, aes(x = q1_plotlabels, y = q1_young_plot, fill = q1_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q1_young_plot),"%"), vjust=-0.3), size=7.5)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "2012 and After") +
        disaggtheme

q1old_mean_ones <- round(weighted.mean(summary_state_analysis_old$X16ones, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2) 
q1old_mean_twos <- round(weighted.mean(summary_state_analysis_old$X16twos, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2) 
q1_old_plot<-c(q1old_mean_ones, q1old_mean_twos)
q1_old_plotdta <- data.frame(q1_old_plot, q1_plotlabels) 
q1_old_plotdta$wrapped_labels = str_wrap(q1_old_plotdta$q1_plotlabels, width = 10)

q1_old_plot <- ggplot(q1_old_plotdta, aes(x = q1_plotlabels, y = q1_old_plot, fill = q1_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q1_old_plot),"%"), vjust=-0.3), size=7.5)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "2011 and Before") +
  disaggtheme

q1_former_plot<-c(summary_state_former$X16ones*100, summary_state_former$X16twos*100)
q1_former_plotdta <- data.frame(q1_former_plot) 
q1_former_plot <- ggplot(q1_former_plotdta, aes(x = q1_plotlabels, y = q1_former_plot, fill = q1_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q1_former_plot),"%"), vjust=-0.3), size=7.5)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "Former Officers") +
  disaggtheme

legend1 <- cowplot::get_legend(q1_former_plot) 
q1_former_plot <- q1_former_plot +theme(legend.position = "none")
plot1_fullage <- plot_grid(q1_young_plot,q1_old_plot,q1_former_plot,
                           nrow = 1)
plot1_fullage <- plot_grid(plot1_fullage, legend1, nrow = 2, rel_heights=c(5,2)) 
plot1_fullage 
```
\newpage

## Question 1: Disaggregated by SDG

Most countries in the world experienced a second wave of Covid-19 characterised by higher infection prevalence and rapid viral spread. Which of these statements would you agree with more, in the context of the second wave in India?

\vspace{6mm}
```{r, echo = FALSE, fig.height=10,fig.width=18}
#Creating an additional table for SDG in summary_state_analysis
summary_state_analysis <- summary_state_analysis %>% 
mutate (sdg_tier = ias_processed_dta$sdg)

#Calculating weighted means
q1aspt_mean_ones <- round(weighted.mean(summary_state_analysis$X16ones[summary_state_analysis$sdg_tier=="Aspirant"],
summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2) 
q1aspt_mean_twos <- round(weighted.mean(summary_state_analysis$X16twos[summary_state_analysis$sdg_tier=="Aspirant"],
summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)

q1perf_mean_ones <- round(weighted.mean(summary_state_analysis$X16ones[summary_state_analysis$sdg_tier=="Performer"],
summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2) 
q1perf_mean_twos <- round(weighted.mean(summary_state_analysis$X16twos[summary_state_analysis$sdg_tier=="Performer"],
summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)

q1frnt_mean_ones <- round(weighted.mean(summary_state_analysis$X16ones[summary_state_analysis$sdg_tier=="Frontrunner"],
summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2) 
q1frnt_mean_twos <- round(weighted.mean(summary_state_analysis$X16twos[summary_state_analysis$sdg_tier=="Frontrunner"],
summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)

#Forming vectors
q1aspt_plot <- c(q1aspt_mean_ones, q1aspt_mean_twos) 
q1perf_plot <- c(q1perf_mean_ones, q1perf_mean_twos)
q1frnt_plot <- c(q1frnt_mean_ones, q1frnt_mean_twos)
q1full_plot_labels <- c("The second Covid-19 surge was expected and should have seen much more advance planning.", "The second Covid-19 surge was unprecedented in its scale and therefore, overwhelmed the \n health system.") 

#Constructing Data Frames
q1aspt_plot_dta <- data.frame(q1aspt_plot, q1full_plot_labels) 
q1perf_plot_dta <- data.frame(q1perf_plot, q1full_plot_labels) 
q1frnt_plot_dta <- data.frame(q1frnt_plot, q1full_plot_labels) 

#Wrapping labels
q1aspt_plot_dta$wrapped_labels = str_wrap(q1aspt_plot_dta$q1full_plot_label, width = 10)
q1perf_plot_dta$wrapped_labels = str_wrap(q1perf_plot_dta$q1full_plot_label, width = 10)
q1frnt_plot_dta$wrapped_labels = str_wrap(q1frnt_plot_dta$q1full_plot_label, width = 10)

#Invoking ggplot
q1aspt_plot <- ggplot(q1aspt_plot_dta, aes(x=q1full_plot_labels, y=q1aspt_plot, fill = q1full_plot_labels)) +
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q1aspt_plot),"%"), vjust=-0.3), size=7.5) +
  scale_y_continuous(limits = c(0,100)) +  
  scale_x_discrete(labels= c("",""))  +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "Aspirant States") +
  disaggtheme

q1perf_plot <- ggplot(q1perf_plot_dta, aes(x=q1full_plot_labels, y=q1perf_plot, fill = q1full_plot_labels)) +
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q1perf_plot),"%"), vjust=-0.3), size=7.5) +
  scale_y_continuous(limits = c(0,100)) +  
  scale_x_discrete(labels= c("",""))  +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "Performer States") +
  disaggtheme

q1frnt_plot_temp <- ggplot(q1frnt_plot_dta, aes(x=q1full_plot_labels, y=q1frnt_plot, fill = q1full_plot_labels)) +
  geom_bar(stat="identity", width= 0.5, show.legend = TRUE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q1frnt_plot),"%"), vjust=-0.3), size=7.5) +
  scale_y_continuous(limits = c(0,100)) +  
  scale_x_discrete(labels= c("","")) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "Frontrunner States") +
  disaggtheme

legend1 <- cowplot::get_legend(q1frnt_plot_temp)
q1frnt_plot <- q1frnt_plot_temp +theme(legend.position = "none")
q1_fullsdg <- plot_grid(q1aspt_plot,q1perf_plot,q1frnt_plot, nrow=1)
q1_fullsdg <- plot_grid(q1_fullsdg,legend1, nrow = 2, rel_heights=c(5,2))
q1_fullsdg
```
\newpage

## Question 2: Aggregate Graph

With regard to our planning and preparation for the second wave, which of these statements would you agree with most?

\vspace{6mm}
```{r}
#Aggregate
q2full_mean_ones <- round(weighted.mean(summary_state_analysis$X17ones,
summary_state_analysis$state_weight)*100,2) 
q2full_mean_twos <- round(weighted.mean(summary_state_analysis$X17twos,
summary_state_analysis$state_weight)*100,2) 
q2full_mean_threes <- round(weighted.mean(summary_state_analysis$X17threes, summary_state_analysis$state_weight)*100,2)
q2full_mean_fours <- round(weighted.mean(summary_state_analysis$X17fours, summary_state_analysis$state_weight)*100,2)
q2full_plot <- c(q2full_mean_ones, q2full_mean_twos, q2full_mean_threes, q2full_mean_fours) 
q2full_plot_labels <- c("Even proposals for advance planning received little purchase in the last one year.", "Planning got lost mid-way due to signals that we have managed the pandemic well." , "Systematic advance planning has never been part of our ethos.", "We took adequate measures to plan our response in advance.") 
q2full_plot_dta <- data.frame(q2full_plot, q2full_plot_labels) 
q2full_plot_dta$wrapped_labels = str_wrap(q2full_plot_dta$q2full_plot_labels, width = 50)
q2full_plot <- ggplot(q2full_plot_dta, aes(x=q2full_plot_labels, y=q2full_plot, fill = q2full_plot_labels)) +
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q2full_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,100)) +
  scale_x_discrete(labels = function(q2full_plot_labels) str_wrap(q2full_plot_labels, width = 20)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent") +
  newtheme
q2full_plot
```
\newpage

## Question 2: Disaggregated by Age

With regard to our planning and preparation for the second wave, which of these statements would you agree with most?

\vspace{6mm}
```{r, echo = FALSE, fig.height=10,fig.width=18}
#Age
q2_plotlabels <- c("Even proposals for advance planning received little purchase in the last one year.", "Planning got lost mid-way due to signals that we have managed the pandemic well." , "Systematic advance planning has never been part of our ethos.", "We took adequate measures to plan our response in advance.")

q2young_mean_ones <- round(weighted.mean(summary_state_analysis_young$X17ones, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2) 
q2young_mean_twos <- round(weighted.mean(summary_state_analysis_young$X17twos, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2)
q2young_mean_threes <- round(weighted.mean(summary_state_analysis_young$X17threes, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2)
q2young_mean_fours <- round(weighted.mean(summary_state_analysis_young$X17fours, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2)
q2_young_plot<-c(q2young_mean_ones, q2young_mean_twos, q2young_mean_threes, q2young_mean_fours)
q2_young_plotdta <- data.frame(q2_young_plot, q2_plotlabels) 
q2_young_plotdta$wrapped_labels = str_wrap(q2_young_plotdta$q2_plotlabels, width = 10)

q2_young_plot <- ggplot(q2_young_plotdta, aes(x = q2_plotlabels, y = q2_young_plot, fill = q2_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q2_young_plot),"%"), vjust=-0.3), size=6.5)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "2012 and After") +
  disaggtheme

q2old_mean_ones <- round(weighted.mean(summary_state_analysis_old$X17ones, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2) 
q2old_mean_twos <- round(weighted.mean(summary_state_analysis_old$X17twos, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2)
q2old_mean_threes <- round(weighted.mean(summary_state_analysis_old$X17threes, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2)
q2old_mean_fours <- round(weighted.mean(summary_state_analysis_old$X17fours, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2)
q2_old_plot<-c(q2old_mean_ones, q2old_mean_twos, q2old_mean_threes, q2old_mean_fours)
q2_old_plotdta <- data.frame(q2_old_plot, q2_plotlabels) 
q2_old_plotdta$wrapped_labels = str_wrap(q2_old_plotdta$q2_plotlabels, width = 10)

q2_old_plot <- ggplot(q2_old_plotdta, aes(x = q2_plotlabels, y = q2_old_plot, fill = q2_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q2_old_plot),"%"), vjust=-0.3), size=6.5)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "2011 and Before") +
  disaggtheme

q2_former_plot<-c(summary_state_former$X17ones*100, summary_state_former$X17twos*100, summary_state_former$X17threes*100, summary_state_former$X17fours*100)
q2_former_plotdta <- data.frame(q2_former_plot, q2_plotlabels) 
q2_former_plotdta$wrapped_labels = str_wrap(q2_former_plotdta$q2_plotlabels, width = 10)

q2_former_plot <- ggplot(q2_former_plotdta, aes(x = q2_plotlabels, y = q2_former_plot, fill = q2_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q2_former_plot),"%"), vjust=-0.3), size=6.5)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "Former Officers") +
  disaggtheme

legend2 <- cowplot::get_legend(q2_former_plot) 
q2_former_plot <- q2_former_plot +theme(legend.position = "none")
plot2_fullage <- plot_grid(q2_young_plot,q2_old_plot,q2_former_plot,
                           nrow = 1)
plot2_fullage <- plot_grid(plot2_fullage, legend2, nrow = 2, rel_heights=c(5,2)) 
plot2_fullage 
```
\newpage

## Question 2: Disaggregated by SDG

With regard to our planning and preparation for the second wave, which of these statements would you agree with most?

\vspace{6mm}
```{r, echo = FALSE, fig.height=10,fig.width=20}

#Calculating weighted means
q2aspt_mean_ones <- round(weighted.mean(summary_state_analysis$X17ones[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)
q2aspt_mean_twos <- round(weighted.mean(summary_state_analysis$X17twos[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)
q2aspt_mean_threes <- round(weighted.mean(summary_state_analysis$X17threes[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)
q2aspt_mean_fours <- round(weighted.mean(summary_state_analysis$X17fours[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)

q2frnt_mean_ones <- round(weighted.mean(summary_state_analysis$X17ones[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)
q2frnt_mean_twos <- round(weighted.mean(summary_state_analysis$X17twos[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)
q2frnt_mean_threes <- round(weighted.mean(summary_state_analysis$X17threes[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)
q2frnt_mean_fours <- round(weighted.mean(summary_state_analysis$X17fours[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)

q2perf_mean_ones <- round(weighted.mean(summary_state_analysis$X17ones[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)
q2perf_mean_twos <- round(weighted.mean(summary_state_analysis$X17twos[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)
q2perf_mean_threes <- round(weighted.mean(summary_state_analysis$X17threes[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)
q2perf_mean_fours <- round(weighted.mean(summary_state_analysis$X17fours[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)

#Forming vectors 
q2aspt_plot <- c(q2aspt_mean_ones, q2aspt_mean_twos, q2aspt_mean_threes,q2aspt_mean_fours)
q2perf_plot <- c(q2perf_mean_ones, q2perf_mean_twos, q2perf_mean_threes,q2perf_mean_fours)
q2frnt_plot <- c(q2frnt_mean_ones, q2frnt_mean_twos, q2frnt_mean_threes,q2frnt_mean_fours)

q2full_plot_labels <- c("Even proposals for advance planning received little purchase in the last one year.", "Planning got lost mid-way due to signals that we have managed the pandemic well." , "Systematic advance planning has never been part of our ethos.", "We took adequate measures to plan our response in advance.")

#constructing data frames
q2aspt_plot_dta <- data.frame(q2aspt_plot, q2full_plot_labels)
q2perf_plot_dta <- data.frame(q2perf_plot, q2full_plot_labels)
q2frnt_plot_dta <- data.frame(q2frnt_plot, q2full_plot_labels)

#wrapping labels
q2aspt_plot_dta$wrapped_labels = str_wrap(q2aspt_plot_dta$q2full_plot_labels, width = 50)
q2frnt_plot_dta$wrapped_labels = str_wrap(q2frnt_plot_dta$q2full_plot_labels, width = 50)
q2perf_plot_dta$wrapped_labels = str_wrap(q2perf_plot_dta$q2full_plot_labels, width = 50)

#Invoking ggplot
q2aspt_plot <- ggplot(q2aspt_plot_dta, aes(x=q2full_plot_labels, y=q2aspt_plot, fill = q2full_plot_labels)) +
  geom_bar(stat="identity", width=0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q2aspt_plot),"%"), vjust=-0.3), size=6.5) +
  scale_y_continuous(limits = c(0,100))  +
  labs(x="",y="Percent")  +
  scale_x_discrete(labels= c("","","","","")) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(title ="Aspirant States") +
  disaggtheme

q2perf_plot <- ggplot(q2perf_plot_dta, aes(x=q2full_plot_labels, y=q2perf_plot, fill = q2full_plot_labels)) +
  geom_bar(stat="identity", width=0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q2perf_plot),"%"), vjust=-0.3), size=6.5) +
  scale_y_continuous(limits = c(0,100)) +
  labs(x="",y="Percent") +
  scale_x_discrete(labels= c("","","","","")) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(title = "Performer States") +
  disaggtheme

q2frnt_plot_temp <- ggplot(q2frnt_plot_dta, aes(x=q2full_plot_labels, y=q2frnt_plot, fill = q2full_plot_labels)) +
  geom_bar(stat="identity", width=0.5, show.legend = TRUE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q2frnt_plot),"%"), vjust=-0.3), size=6.5) +
  scale_y_continuous(limits = c(0,100)) +
  labs(x="",y="Percent") +
  scale_x_discrete(labels= c("","","","","")) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(title = "Frontrunner States") +
  disaggtheme

legend2 <- cowplot::get_legend(q2frnt_plot_temp)
q2frnt_plot <- q2frnt_plot_temp +theme(legend.position = "none")
q2_fullsdg <- plot_grid(q2aspt_plot,q2perf_plot,q2frnt_plot, nrow=1)
q2_fullsdg <- plot_grid(q2_fullsdg,legend2, nrow = 2, rel_heights=c(5,2))
q2_fullsdg
```
\newpage

## Question 3: Aggregate Graph

In our survey of IAS officers during the first wave of the pandemic, almost 70% of officers felt that there was a reasonable to substantial increase in health system preparedness post the nationwide lockdown. Which of these statements best reflects health system preparedness for the second wave?

\vspace{6mm}
```{r}
q3full_mean_ones <- round(weighted.mean(summary_state_analysis$X18ones,
summary_state_analysis$state_weight)*100,2) 
q3full_mean_twos <- round(weighted.mean(summary_state_analysis$X18twos,
summary_state_analysis$state_weight)*100,2) 
q3full_mean_threes <- round(weighted.mean(summary_state_analysis$X18threes, summary_state_analysis$state_weight)*100,2)
q3full_mean_fours <- round(weighted.mean(summary_state_analysis$X18fours, summary_state_analysis$state_weight)*100,2)
q3full_plot <- c(q3full_mean_ones, q3full_mean_twos, q3full_mean_threes, q3full_mean_fours) 
q3full_plot_labels <- c("Building health system preparedness was not adequately prioritised.","Health system preparedness increased but was overwhelmed by the unprecedented scale of the infection.","Health system preparedness increased substantially and performed adequately.", "Health system preparedness was built but expanded facilities dismantled too soon.") 
q3full_plot_dta <- data.frame(q3full_plot, q3full_plot_labels) 
q3full_plot_dta$wrapped_labels = str_wrap(q3full_plot_dta$q3full_plot_labels, width = 50)
q3full_plot <- ggplot(q3full_plot_dta, aes(x=q3full_plot_labels, y=q3full_plot, fill = q3full_plot_labels)) +
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q3full_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,100)) +
  scale_x_discrete(labels = function(q3full_plot_labels) str_wrap(q3full_plot_labels, width = 20)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent") +
  newtheme
q3full_plot
```
\newpage

## Question 3: Disaggregated by Age

In our survey of IAS officers during the first wave of the pandemic, almost 70% of officers felt that there was a reasonable to substantial increase in health system preparedness post the nationwide lockdown. Which of these statements best reflects health system preparedness for the second wave?

\vspace{6mm}
```{r, echo = FALSE, fig.height=10,fig.width=18}
#Age
q3_plotlabels <- cq3full_plot_labels <- c("Building health system preparedness was not adequately prioritised.","Health system preparedness increased but was overwhelmed by the unprecedented scale of the infection.","Health system preparedness increased substantially and performed adequately.", "Health system preparedness was built but expanded facilities dismantled too soon.")

q3young_mean_ones <- round(weighted.mean(summary_state_analysis_young$X18ones, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2) 
q3young_mean_twos <- round(weighted.mean(summary_state_analysis_young$X18twos, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2)
q3young_mean_threes <- round(weighted.mean(summary_state_analysis_young$X18threes, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2)
q3young_mean_fours <- round(weighted.mean(summary_state_analysis_young$X18fours, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2)
q3_young_plot<-c(q3young_mean_ones,q3young_mean_twos,q3young_mean_threes,q3young_mean_fours)
q3_young_plotdta <- data.frame(q3_young_plot, q3_plotlabels) 
q3_young_plotdta$wrapped_labels = str_wrap(q3_young_plotdta$q3_plotlabels, width = 10)

q3_young_plot <- ggplot(q3_young_plotdta, aes(x = q3_plotlabels, y = q3_young_plot, fill = q3_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q3_young_plot),"%"), vjust=-0.3), size=6.5)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "2012 and After") +
  disaggtheme

q3old_mean_ones <- round(weighted.mean(summary_state_analysis_old$X18ones, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2) 
q3old_mean_twos <- round(weighted.mean(summary_state_analysis_old$X18twos, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2)
q3old_mean_threes <- round(weighted.mean(summary_state_analysis_old$X18threes, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2)
q3old_mean_fours <- round(weighted.mean(summary_state_analysis_old$X18fours, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2)
q3_old_plot<-c(q3old_mean_ones,q3old_mean_twos,q3old_mean_threes,q3old_mean_fours)
q3_old_plotdta <- data.frame(q3_old_plot, q3_plotlabels) 
q3_old_plotdta$wrapped_labels = str_wrap(q3_old_plotdta$q3_plotlabels, width = 10)

q3_old_plot <- ggplot(q3_old_plotdta, aes(x = q3_plotlabels, y = q3_old_plot, fill = q3_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q3_old_plot),"%"), vjust=-0.3), size=6.5)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "2011 and Before") +
  disaggtheme

q3_former_plot<-c(summary_state_former$X18ones*100, summary_state_former$X18twos*100, summary_state_former$X18threes*100, summary_state_former$X18fours*100)
q3_former_plotdta <- data.frame(q3_former_plot, q3_plotlabels) 
q3_former_plotdta$wrapped_labels = str_wrap(q3_former_plotdta$q3_plotlabels, width = 10)

q3_former_plot <- ggplot(q3_former_plotdta, aes(x = q3_plotlabels, y = q3_former_plot, fill = q3_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q3_former_plot),"%"), vjust=-0.3), size=6.5)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "Former Officers") +
  disaggtheme

legend3 <- cowplot::get_legend(q3_former_plot) 
q3_former_plot <- q3_former_plot +theme(legend.position = "none")
plot3_fullage <- plot_grid(q3_young_plot,q3_old_plot,q3_former_plot,
                           nrow = 1)
plot3_fullage <- plot_grid(plot3_fullage, legend3, nrow = 2, rel_heights=c(5,2)) 
plot3_fullage 
```
\newpage

## Question 3: Disaggregated by SDG

In our survey of IAS officers during the first wave of the pandemic, almost 70% of officers felt that there was a reasonable to substantial increase in health system preparedness post the nationwide lockdown. Which of these statements best reflects health system preparedness for the second wave?

\vspace{6mm}
```{r, echo = FALSE, fig.height=10,fig.width=18}
summary_state_analysis <- summary_state_analysis %>% 
mutate (sdg_tier = ias_processed_dta$sdg)

#Calculating weighted means
q3aspt_mean_ones <- round(weighted.mean(summary_state_analysis$X18ones[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)
q3aspt_mean_twos <- round(weighted.mean(summary_state_analysis$X18twos[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)
q3aspt_mean_threes <- round(weighted.mean(summary_state_analysis$X18threes[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)
q3aspt_mean_fours <- round(weighted.mean(summary_state_analysis$X18fours[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)

q3frnt_mean_ones <- round(weighted.mean(summary_state_analysis$X18ones[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)
q3frnt_mean_twos <- round(weighted.mean(summary_state_analysis$X18twos[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)
q3frnt_mean_threes <- round(weighted.mean(summary_state_analysis$X18threes[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)
q3frnt_mean_fours <- round(weighted.mean(summary_state_analysis$X18fours[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)

q3perf_mean_ones <- round(weighted.mean(summary_state_analysis$X18ones[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)
q3perf_mean_twos <- round(weighted.mean(summary_state_analysis$X18twos[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)
q3perf_mean_threes <- round(weighted.mean(summary_state_analysis$X18threes[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)
q3perf_mean_fours <- round(weighted.mean(summary_state_analysis$X18fours[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)

#Forming vectors 
q3aspt_plot <- c(q3aspt_mean_ones, q3aspt_mean_twos, q3aspt_mean_threes, q3aspt_mean_fours)
q3frnt_plot <- c(q3frnt_mean_ones, q3frnt_mean_twos, q3frnt_mean_threes, q3frnt_mean_fours)
q3perf_plot <- c(q3perf_mean_ones, q3perf_mean_twos, q3perf_mean_threes, q3perf_mean_fours)

q3full_plot_labels <- c("Building health system preparedness was not adequately prioritised.","Health system preparedness increased but was overwhelmed by the unprecedented scale of the infection.","Health system preparedness increased substantially and performed adequately.", "Health system preparedness was built but expanded facilities dismantled too soon.") 

#constructing data frames
q3aspt_plot_dta <- data.frame(q3aspt_plot, q3full_plot_labels)
q3frnt_plot_dta <- data.frame(q3frnt_plot, q3full_plot_labels)
q3perf_plot_dta <- data.frame(q3perf_plot, q3full_plot_labels)

#wrapping labels
q3aspt_plot_dta$wrapped_labels = str_wrap(q3aspt_plot_dta$q3full_plot_labels, width = 50)
q3frnt_plot_dta$wrapped_labels = str_wrap(q3frnt_plot_dta$q3full_plot_labels, width = 50)
q3perf_plot_dta$wrapped_labels = str_wrap(q3perf_plot_dta$q3full_plot_labels, width = 50)

#Invoking ggplot
q3aspt_plot <- ggplot(q3aspt_plot_dta, aes(x=q3full_plot_labels, y=q3aspt_plot, fill = q3full_plot_labels)) +
  geom_bar(stat="identity", width=0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q3aspt_plot),"%"), vjust=-0.3), size=6.5) +
  scale_y_continuous(limits = c(0,100))  +
  labs(x="",y="Percent")  +
  scale_x_discrete(labels= c("","","","","")) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(title ="Aspirant States") +
  disaggtheme

q3perf_plot <- ggplot(q3perf_plot_dta, aes(x=q3full_plot_labels, y=q3perf_plot, fill = q3full_plot_labels)) +
  geom_bar(stat="identity", width=0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q3perf_plot),"%"), vjust=-0.3), size=6.5) +
  scale_y_continuous(limits = c(0,100)) +
  labs(x="",y="Percent") +
  scale_x_discrete(labels= c("","","","","")) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(title = "Performer States") +
  disaggtheme

q3frnt_plot_temp <- ggplot(q3frnt_plot_dta, aes(x=q3full_plot_labels, y=q3frnt_plot, fill = q3full_plot_labels)) +
  geom_bar(stat="identity", width=0.5, show.legend = TRUE) + 
  geom_text(aes(label=scales::percent(q3frnt_plot/100)), vjust=-0.3, size=6) +
  scale_y_continuous(limits = c(0,100)) +
  labs(x="",y="Percent") +
  scale_x_discrete(labels= c("","","","","")) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(title = "Frontrunner States") +
  disaggtheme

legend3 <- cowplot::get_legend(q3frnt_plot_temp)
q3frnt_plot <- q3frnt_plot_temp +theme(legend.position = "none")
q3_fullsdg <- plot_grid(q3aspt_plot,q3perf_plot,q3frnt_plot, nrow=1)
q3_fullsdg <- plot_grid(q3_fullsdg,legend3, nrow = 2, rel_heights=c(5,2))
q3_fullsdg
```
\newpage

## Question 4: Aggregate Graph 

Please select upto two States that you think have best fulfilled their pandemic management responsibilities. 

\vspace{6mm}
```{r, echo = FALSE, fig.height=10,fig.width=18, warning=FALSE}
#Aggregate
q4full_mean_anislands <- round(weighted.mean(summary_q4$q4_anislands, summary_q4$state_weight)*100,2)
q4full_mean_andhra <- round(weighted.mean(summary_q4$q4_andhra, summary_q4$state_weight)*100,2)
q4full_mean_arunachal <- round(weighted.mean(summary_q4$q4_arunachal, summary_q4$state_weight)*100,2)
q4full_mean_assam <- round(weighted.mean(summary_q4$q4_assam, summary_q4$state_weight)*100,2)
q4full_mean_bihar <- round(weighted.mean(summary_q4$q4_bihar, summary_q4$state_weight)*100,2)
q4full_mean_chandigarh <- round(weighted.mean(summary_q4$q4_chandigarh, summary_q4$state_weight)*100,2)
q4full_mean_chhattisgarh <- round(weighted.mean(summary_q4$q4_chhattisgarh, summary_q4$state_weight)*100,2)
q4full_mean_dnhdd <- round(weighted.mean(summary_q4$q4_dnhdd, summary_q4$state_weight)*100,2)
q4full_mean_goa <- round(weighted.mean(summary_q4$q4_goa, summary_q4$state_weight)*100,2)
q4full_mean_gujarat <- round(weighted.mean(summary_q4$q4_gujarat, summary_q4$state_weight)*100,2)
q4full_mean_haryana <- round(weighted.mean(summary_q4$q4_haryana, summary_q4$state_weight)*100,2)
q4full_mean_hp <- round(weighted.mean(summary_q4$q4_hp, summary_q4$state_weight)*100,2)
q4full_mean_jk <- round(weighted.mean(summary_q4$q4_jk, summary_q4$state_weight)*100,2)
q4full_mean_jharkhand <- round(weighted.mean(summary_q4$q4_jharkhand, summary_q4$state_weight)*100,2)
q4full_mean_karnataka <- round(weighted.mean(summary_q4$q4_karnataka, summary_q4$state_weight)*100,2)
q4full_mean_kerala <- round(weighted.mean(summary_q4$q4_kerala, summary_q4$state_weight)*100,2)
q4full_mean_ladakh <- round(weighted.mean(summary_q4$q4_ladakh, summary_q4$state_weight)*100,2)
q4full_mean_lakshadweep <- round(weighted.mean(summary_q4$q4_lakshadweep, summary_q4$state_weight)*100,2)
q4full_mean_mp <- round(weighted.mean(summary_q4$q4_mp, summary_q4$state_weight)*100,2)
q4full_mean_maharashtra <- round(weighted.mean(summary_q4$q4_maharashtra, summary_q4$state_weight)*100,2)
q4full_mean_manipur <- round(weighted.mean(summary_q4$q4_manipur, summary_q4$state_weight)*100,2)
q4full_mean_meghalaya <- round(weighted.mean(summary_q4$q4_meghalaya, summary_q4$state_weight)*100,2)
q4full_mean_mizoram <- round(weighted.mean(summary_q4$q4_mizoram, summary_q4$state_weight)*100,2)
q4full_mean_nagaland <- round(weighted.mean(summary_q4$q4_nagaland, summary_q4$state_weight)*100,2)
q4full_mean_delhi <- round(weighted.mean(summary_q4$q4_delhi, summary_q4$state_weight)*100,2)
q4full_mean_none <- round(weighted.mean(summary_q4$q4_none, summary_q4$state_weight)*100,2)
q4full_mean_odisha <- round(weighted.mean(summary_q4$q4_odisha, summary_q4$state_weight)*100,2)
q4full_mean_puducherry <- round(weighted.mean(summary_q4$q4_puducherry, summary_q4$state_weight)*100,2)
q4full_mean_punjab <- round(weighted.mean(summary_q4$q4_punjab, summary_q4$state_weight)*100,2)
q4full_mean_rajasthan <- round(weighted.mean(summary_q4$q4_rajasthan, summary_q4$state_weight)*100,2)
q4full_mean_sikkim <- round(weighted.mean(summary_q4$q4_sikkim, summary_q4$state_weight)*100,2)
q4full_mean_tn <- round(weighted.mean(summary_q4$q4_tn, summary_q4$state_weight)*100,2)
q4full_mean_telangana <- round(weighted.mean(summary_q4$q4_telangana, summary_q4$state_weight)*100,2)
q4full_mean_tripura <- round(weighted.mean(summary_q4$q4_tripura, summary_q4$state_weight)*100,2)
q4full_mean_up <- round(weighted.mean(summary_q4$q4_up, summary_q4$state_weight)*100,2)
q4full_mean_uttarakhand <- round(weighted.mean(summary_q4$q4_uttarakhand, summary_q4$state_weight)*100,2)
q4full_mean_wb <- round(weighted.mean(summary_q4$q4_wb, summary_q4$state_weight)*100,2)

q4full_plot <- c(q4full_mean_anislands, q4full_mean_andhra, q4full_mean_arunachal, q4full_mean_assam, q4full_mean_bihar, q4full_mean_chandigarh, q4full_mean_chhattisgarh, q4full_mean_delhi, q4full_mean_dnhdd, q4full_mean_goa, q4full_mean_gujarat, q4full_mean_haryana, q4full_mean_hp, q4full_mean_jharkhand, q4full_mean_jk, q4full_mean_karnataka, q4full_mean_kerala, q4full_mean_ladakh, q4full_mean_lakshadweep, q4full_mean_maharashtra, q4full_mean_manipur, q4full_mean_meghalaya, q4full_mean_mizoram, q4full_mean_mp, q4full_mean_nagaland, q4full_mean_none, q4full_mean_odisha, q4full_mean_puducherry, q4full_mean_punjab, q4full_mean_rajasthan, q4full_mean_sikkim, q4full_mean_telangana, q4full_mean_tn, q4full_mean_tripura, q4full_mean_up, q4full_mean_uttarakhand, q4full_mean_wb)


q4full_plot_labels <- c("AN", "AP", "AR", "AS", "BR", "CH", "CG", "DL", "DNH & DD", "GA", "GJ", "HR", "HP", "JH", "JK", "KA", "KL", "LA", "LD", "MH", "MN", "ML", "MZ", "MP", "NL", "None", "OR", "PY", "PB", "RJ", "SK", "TG", "TN", "TR", "UP", "UK", "WB")

q4full_plot_dta <- data.frame (q4full_plot, q4full_plot_labels) 
q4full_plot_dta$wrapped_labels = str_wrap(q4full_plot_dta$q4full_plot_labels, width = 10)
q4full_plot <- ggplot(q4full_plot_dta, aes(x=q4full_plot_labels, y=q4full_plot, fill = q4full_plot_labels)) +
  geom_bar(stat="identity", width= 1, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q4full_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,40)) +
  scale_x_discrete(labels = function(q4full_plot_labels) str_wrap(q4full_plot_labels, width = 30)) +
  labs(x="",y="Percent")+
  newtheme

q4full_plot
```
\newpage

## Question 4: Disaggregated by Age

Please select upto two States that you think have best fulfilled their pandemic management responsibilities. 

\vspace{6mm}
```{r, echo = FALSE, fig.height=20,fig.width=18, warning=FALSE}
#Age
q4young_mean_anislands <- round(weighted.mean(summary_q4_young$q4_anislands, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_andhra <- round(weighted.mean(summary_q4_young$q4_andhra, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_arunachal <- round(weighted.mean(summary_q4_young$q4_arunachal, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_assam <- round(weighted.mean(summary_q4_young$q4_assam, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_bihar <- round(weighted.mean(summary_q4_young$q4_bihar, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_chandigarh <- round(weighted.mean(summary_q4_young$q4_chandigarh, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_chhattisgarh <- round(weighted.mean(summary_q4_young$q4_chhattisgarh, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_dnhdd <- round(weighted.mean(summary_q4_young$q4_dnhdd, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_goa <- round(weighted.mean(summary_q4_young$q4_goa, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_gujarat <- round(weighted.mean(summary_q4_young$q4_gujarat, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_haryana <- round(weighted.mean(summary_q4_young$q4_haryana, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_hp <- round(weighted.mean(summary_q4_young$q4_hp, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_jk <- round(weighted.mean(summary_q4_young$q4_jk, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_jharkhand <- round(weighted.mean(summary_q4_young$q4_jharkhand, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_karnataka <- round(weighted.mean(summary_q4_young$q4_karnataka, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_kerala <- round(weighted.mean(summary_q4_young$q4_kerala, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_ladakh <- round(weighted.mean(summary_q4_young$q4_ladakh, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_lakshadweep <- round(weighted.mean(summary_q4_young$q4_lakshadweep, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_mp <- round(weighted.mean(summary_q4_young$q4_mp, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_maharashtra <- round(weighted.mean(summary_q4_young$q4_maharashtra, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_manipur <- round(weighted.mean(summary_q4_young$q4_manipur, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_meghalaya <- round(weighted.mean(summary_q4_young$q4_meghalaya, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_mizoram <- round(weighted.mean(summary_q4_young$q4_mizoram, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_nagaland <- round(weighted.mean(summary_q4_young$q4_nagaland, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_delhi <- round(weighted.mean(summary_q4_young$q4_delhi, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_none <- round(weighted.mean(summary_q4_young$q4_none, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_odisha <- round(weighted.mean(summary_q4_young$q4_odisha, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_puducherry <- round(weighted.mean(summary_q4_young$q4_puducherry, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_punjab <- round(weighted.mean(summary_q4_young$q4_punjab, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_rajasthan <- round(weighted.mean(summary_q4_young$q4_rajasthan, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_sikkim <- round(weighted.mean(summary_q4_young$q4_sikkim, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_tn <- round(weighted.mean(summary_q4_young$q4_tn, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_telangana <- round(weighted.mean(summary_q4_young$q4_telangana, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_tripura <- round(weighted.mean(summary_q4_young$q4_tripura, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_up <- round(weighted.mean(summary_q4_young$q4_up, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_uttarakhand <- round(weighted.mean(summary_q4_young$q4_uttarakhand, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)
q4young_mean_wb <- round(weighted.mean(summary_q4_young$q4_wb, summary_q4_young$state_young_weight,na.rm=TRUE)*100,2)

q4young_plot <- c(q4young_mean_anislands, q4young_mean_andhra, q4young_mean_arunachal, q4young_mean_assam, q4young_mean_bihar, q4young_mean_chandigarh, q4young_mean_chhattisgarh, q4young_mean_delhi, q4young_mean_dnhdd, q4young_mean_goa, q4young_mean_gujarat, q4young_mean_haryana, q4young_mean_hp, q4young_mean_jharkhand, q4young_mean_jk, q4young_mean_karnataka, q4young_mean_kerala, q4young_mean_ladakh, q4young_mean_lakshadweep, q4young_mean_maharashtra, q4young_mean_manipur, q4young_mean_meghalaya, q4young_mean_mizoram, q4young_mean_mp, q4young_mean_nagaland, q4young_mean_none, q4young_mean_odisha, q4young_mean_puducherry, q4young_mean_punjab, q4young_mean_rajasthan, q4young_mean_sikkim, q4young_mean_telangana, q4young_mean_tn, q4young_mean_tripura, q4young_mean_up, q4young_mean_uttarakhand, q4young_mean_wb)

q4young_plot_labels <- c("AN", "AP", "AR", "AS", "BR", "CH", "CG", "DL", "DNH & DD", "GA", "GJ", "HR", "HP", "JH", "JK", "KA", "KL", "LA", "LD", "MH", "MN", "ML", "MZ", "MP", "NL", "None", "OR", "PY", "PB", "RJ", "SK", "TG", "TN", "TR", "UP", "UK", "WB")

q4young_plot_dta <- data.frame (q4young_plot, q4young_plot_labels) 
q4young_plot_dta$wrapped_labels = str_wrap(q4young_plot_dta$q4young_plot_labels, width = 10)
q4young_plot <- ggplot(q4young_plot_dta, aes(x=q4young_plot_labels, y=q4young_plot, fill = q4young_plot_labels)) +
  geom_bar(stat="identity", width= 1, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q4young_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,40)) +
  scale_x_discrete(labels = function(q4young_plot_labels) str_wrap(q4young_plot_labels, width = 30)) +
  labs(x="",y="Percent", title = "2012 and After")+
  newtheme

q4old_mean_anislands <- round(weighted.mean(summary_q4_old$q4_anislands, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_andhra <- round(weighted.mean(summary_q4_old$q4_andhra, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_arunachal <- round(weighted.mean(summary_q4_old$q4_arunachal, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_assam <- round(weighted.mean(summary_q4_old$q4_assam, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_bihar <- round(weighted.mean(summary_q4_old$q4_bihar, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_chandigarh <- round(weighted.mean(summary_q4_old$q4_chandigarh, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_chhattisgarh <- round(weighted.mean(summary_q4_old$q4_chhattisgarh, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_dnhdd <- round(weighted.mean(summary_q4_old$q4_dnhdd, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_goa <- round(weighted.mean(summary_q4_old$q4_goa, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_gujarat <- round(weighted.mean(summary_q4_old$q4_gujarat, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_haryana <- round(weighted.mean(summary_q4_old$q4_haryana, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_hp <- round(weighted.mean(summary_q4_old$q4_hp, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_jk <- round(weighted.mean(summary_q4_old$q4_jk, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_jharkhand <- round(weighted.mean(summary_q4_old$q4_jharkhand, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_karnataka <- round(weighted.mean(summary_q4_old$q4_karnataka, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_kerala <- round(weighted.mean(summary_q4_old$q4_kerala, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_ladakh <- round(weighted.mean(summary_q4_old$q4_ladakh, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_lakshadweep <- round(weighted.mean(summary_q4_old$q4_lakshadweep, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_mp <- round(weighted.mean(summary_q4_old$q4_mp, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_maharashtra <- round(weighted.mean(summary_q4_old$q4_maharashtra, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_manipur <- round(weighted.mean(summary_q4_old$q4_manipur, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_meghalaya <- round(weighted.mean(summary_q4_old$q4_meghalaya, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_mizoram <- round(weighted.mean(summary_q4_old$q4_mizoram, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_nagaland <- round(weighted.mean(summary_q4_old$q4_nagaland, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_delhi <- round(weighted.mean(summary_q4_old$q4_delhi, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_none <- round(weighted.mean(summary_q4_old$q4_none, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_odisha <- round(weighted.mean(summary_q4_old$q4_odisha, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_puducherry <- round(weighted.mean(summary_q4_old$q4_puducherry, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_punjab <- round(weighted.mean(summary_q4_old$q4_punjab, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_rajasthan <- round(weighted.mean(summary_q4_old$q4_rajasthan, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_sikkim <- round(weighted.mean(summary_q4_old$q4_sikkim, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_tn <- round(weighted.mean(summary_q4_old$q4_tn, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_telangana <- round(weighted.mean(summary_q4_old$q4_telangana, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_tripura <- round(weighted.mean(summary_q4_old$q4_tripura, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_up <- round(weighted.mean(summary_q4_old$q4_up, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_uttarakhand <- round(weighted.mean(summary_q4_old$q4_uttarakhand, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)
q4old_mean_wb <- round(weighted.mean(summary_q4_old$q4_wb, summary_q4_old$state_old_weight, na.rm = TRUE)*100,2)

q4old_plot <- c(q4old_mean_anislands, q4old_mean_andhra, q4old_mean_arunachal, q4old_mean_assam, q4old_mean_bihar, q4old_mean_chandigarh, q4old_mean_chhattisgarh, q4old_mean_delhi, q4old_mean_dnhdd, q4old_mean_goa, q4old_mean_gujarat, q4old_mean_haryana, q4old_mean_hp, q4old_mean_jharkhand, q4old_mean_jk, q4old_mean_karnataka, q4old_mean_kerala, q4old_mean_ladakh, q4old_mean_lakshadweep, q4old_mean_maharashtra, q4old_mean_manipur, q4old_mean_meghalaya, q4old_mean_mizoram, q4old_mean_mp, q4old_mean_nagaland, q4old_mean_none, q4old_mean_odisha, q4old_mean_puducherry, q4old_mean_punjab, q4old_mean_rajasthan, q4old_mean_sikkim, q4old_mean_telangana, q4old_mean_tn, q4old_mean_tripura, q4old_mean_up, q4old_mean_uttarakhand, q4old_mean_wb)

q4old_plot_labels <- c("AN", "AP", "AR", "AS", "BR", "CH", "CG", "DL", "DNH & DD", "GA", "GJ", "HR", "HP", "JH", "JK", "KA", "KL", "LA", "LD", "MH", "MN", "ML", "MZ", "MP", "NL", "None", "OR", "PY", "PB", "RJ", "SK", "TG", "TN", "TR", "UP", "UK", "WB")

q4old_plot_dta <- data.frame (q4old_plot, q4old_plot_labels) 
q4old_plot_dta$wrapped_labels = str_wrap(q4old_plot_dta$q4old_plot_labels, width = 10)
q4old_plot <- ggplot(q4old_plot_dta, aes(x=q4old_plot_labels, y=q4old_plot, fill = q4old_plot_labels)) +
  geom_bar(stat="identity", width= 1, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q4old_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,40)) +
  scale_x_discrete(labels = function(q4old_plot_labels) str_wrap(q4old_plot_labels, width = 30)) +
  labs(x="",y="Percent", title = "2011 and Before")+
  newtheme

q4former_mean_anislands <- summary_q4_former$q4_anislands*100
q4former_mean_andhra <- summary_q4_former$q4_andhra*100
q4former_mean_arunachal <- summary_q4_former$q4_arunachal*100
q4former_mean_assam <- summary_q4_former$q4_assam*100
q4former_mean_bihar <- summary_q4_former$q4_bihar*100
q4former_mean_chandigarh <- summary_q4_former$q4_chandigarh*100
q4former_mean_chhattisgarh <- summary_q4_former$q4_chhattisgarh*100
q4former_mean_delhi <- summary_q4_former$q4_delhi*100
q4former_mean_dnhdd <- summary_q4_former$q4_dnhdd*100
q4former_mean_goa <- summary_q4_former$q4_goa*100
q4former_mean_gujarat <- summary_q4_former$q4_gujarat*100
q4former_mean_haryana <- summary_q4_former$q4_haryana*100
q4former_mean_hp <- summary_q4_former$q4_hp*100
q4former_mean_jharkhand <- summary_q4_former$q4_jharkhand*100
q4former_mean_jk <- summary_q4_former$q4_jk*100
q4former_mean_karnataka <- summary_q4_former$q4_karnataka*100
q4former_mean_kerala <- summary_q4_former$q4_kerala*100
q4former_mean_lakshadweep <- summary_q4_former$q4_lakshadweep*100
q4former_mean_ladakh <- summary_q4_former$q4_ladakh*100
q4former_mean_maharashtra <- summary_q4_former$q4_maharashtra*100
q4former_mean_manipur <- summary_q4_former$q4_manipur*100
q4former_mean_meghalaya <- summary_q4_former$q4_meghalaya*100
q4former_mean_mizoram <- summary_q4_former$q4_mizoram*100
q4former_mean_mp <- summary_q4_former$q4_mp*100
q4former_mean_nagaland <- summary_q4_former$q4_nagaland*100
q4former_mean_none <- summary_q4_former$q4_none*100
q4former_mean_odisha <- summary_q4_former$q4_odisha*100
q4former_mean_puducherry <- summary_q4_former$q4_puducherry*100
q4former_mean_punjab <-summary_q4_former$q4_punjab*100
q4former_mean_rajasthan <- summary_q4_former$q4_rajasthan*100
q4former_mean_sikkim <- summary_q4_former$q4_sikkim*100
q4former_mean_telangana <- summary_q4_former$q4_telangana*100
q4former_mean_tn <- summary_q4_former$q4_tn*100
q4former_mean_tripura <- summary_q4_former$q4_tripura*100
q4former_mean_up <- summary_q4_former$q4_up*100
q4former_mean_uttarakhand <- summary_q4_former$q4_uttarakhand*100
q4former_mean_wb <- summary_q4_former$q4_wb*100

q4former_plot <- c(q4former_mean_anislands, q4former_mean_andhra, q4former_mean_arunachal, q4former_mean_assam, q4former_mean_bihar, q4former_mean_chandigarh, q4former_mean_chhattisgarh, q4former_mean_delhi, q4former_mean_dnhdd, q4former_mean_goa, q4former_mean_gujarat, q4former_mean_haryana, q4former_mean_hp, q4former_mean_jharkhand, q4former_mean_jk, q4former_mean_karnataka, q4former_mean_kerala, q4former_mean_ladakh, q4former_mean_lakshadweep, q4former_mean_maharashtra, q4former_mean_manipur, q4former_mean_meghalaya, q4former_mean_mizoram, q4former_mean_mp, q4former_mean_nagaland, q4former_mean_none, q4former_mean_odisha, q4former_mean_puducherry, q4former_mean_punjab, q4former_mean_rajasthan, q4former_mean_sikkim, q4former_mean_telangana, q4former_mean_tn, q4former_mean_tripura, q4former_mean_up, q4former_mean_uttarakhand, q4former_mean_wb)

q4former_plot_labels <- c("AN", "AP", "AR", "AS", "BR", "CH", "CG", "DL", "DNH & DD", "GA", "GJ", "HR", "HP", "JH", "JK", "KA", "KL", "LA", "LD", "MH", "MN", "ML", "MZ", "MP", "NL", "None", "OR", "PY", "PB", "RJ", "SK", "TG", "TN", "TR", "UP", "UK", "WB")

q4former_plot_dta <- data.frame (q4former_plot, q4former_plot_labels) 
q4former_plot_dta$wrapped_labels = str_wrap(q4former_plot_dta$q4former_plot_labels, width = 10)
q4former_plot <- ggplot(q4former_plot_dta, aes(x=q4former_plot_labels, y=q4former_plot, fill = q4former_plot_labels)) +
  geom_bar(stat="identity", width= 1, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q4former_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,40)) +
  scale_x_discrete(labels = function(q4former_plot_labels) str_wrap(q4former_plot_labels, width = 30)) +
  labs(x="",y="Percent", title = "Former Officers")+
  newtheme

plot4_fullage <- plot_grid(q4young_plot,q4old_plot,q4former_plot, nrow=3)
plot4_fullage
```
\newpage

## Question 4: Disaggregated by SDG

Please select upto two States that you think have best fulfilled their pandemic management responsibilities. 

\vspace{6mm}
```{r, echo = FALSE, fig.height=20,fig.width=18, warning=FALSE}
summary_q4 <- summary_q4 %>% 
mutate (sdg_tier = ias_processed_dta$sdg)

#Calculating weighted means

##Aspirants
q4aspt_weighted_mean_anislands <- round(weighted.mean(summary_q4$q4_anislands[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_andhra <- round(weighted.mean(summary_q4$q4_andhra[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_arunachal <- round(weighted.mean(summary_q4$q4_arunachal[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_assam <- round(weighted.mean(summary_q4$q4_assam[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_bihar <- round(weighted.mean(summary_q4$q4_bihar[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_chandigarh <- round(weighted.mean(summary_q4$q4_chandigarh[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_chhattisgarh <- round(weighted.mean(summary_q4$q4_chhattisgarh[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_dnhdd <- round(weighted.mean(summary_q4$q4_dnhdd[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_goa <- round(weighted.mean(summary_q4$q4_goa[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_gujarat <- round(weighted.mean(summary_q4$q4_gujarat[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_haryana <- round(weighted.mean(summary_q4$q4_haryana[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_hp <- round(weighted.mean(summary_q4$q4_hp[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_jk <- round(weighted.mean(summary_q4$q4_jk[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_jharkhand <- round(weighted.mean(summary_q4$q4_jharkhand[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_karnataka <- round(weighted.mean(summary_q4$q4_karnataka[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_kerala <- round(weighted.mean(summary_q4$q4_kerala[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_ladakh <- round(weighted.mean(summary_q4$q4_ladakh[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_lakshadweep <- round(weighted.mean(summary_q4$q4_lakshadweep[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_mp <- round(weighted.mean(summary_q4$q4_mp[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_maharashtra <- round(weighted.mean(summary_q4$q4_maharashtra[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_manipur <- round(weighted.mean(summary_q4$q4_manipur[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_meghalaya <- round(weighted.mean(summary_q4$q4_meghalaya[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_mizoram <- round(weighted.mean(summary_q4$q4_mizoram[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_nagaland <- round(weighted.mean(summary_q4$q4_nagaland[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_delhi <- round(weighted.mean(summary_q4$q4_delhi[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_none <- round(weighted.mean(summary_q4$q4_none[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_odisha <- round(weighted.mean(summary_q4$q4_odisha[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_puducherry <- round(weighted.mean(summary_q4$q4_puducherry[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_punjab <- round(weighted.mean(summary_q4$q4_punjab[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_rajasthan <- round(weighted.mean(summary_q4$q4_rajasthan[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_sikkim <- round(weighted.mean(summary_q4$q4_sikkim[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_tn <- round(weighted.mean(summary_q4$q4_tn[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_telangana <- round(weighted.mean(summary_q4$q4_telangana[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_tripura <- round(weighted.mean(summary_q4$q4_tripura[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_up <- round(weighted.mean(summary_q4$q4_up[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_uttarakhand <- round(weighted.mean(summary_q4$q4_uttarakhand[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)
q4aspt_weighted_mean_wb <- round(weighted.mean(summary_q4$q4_wb[summary_q4$sdg_tier=="Aspirant"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Aspirant"])*100,2)

##Performers
q4perf_weighted_mean_anislands <- round(weighted.mean(summary_q4$q4_anislands[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_andhra <- round(weighted.mean(summary_q4$q4_andhra[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_arunachal <- round(weighted.mean(summary_q4$q4_arunachal[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_assam <- round(weighted.mean(summary_q4$q4_assam[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_bihar <- round(weighted.mean(summary_q4$q4_bihar[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_chandigarh <- round(weighted.mean(summary_q4$q4_chandigarh[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_chhattisgarh <- round(weighted.mean(summary_q4$q4_chhattisgarh[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_dnhdd <- round(weighted.mean(summary_q4$q4_dnhdd[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_goa <- round(weighted.mean(summary_q4$q4_goa[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_gujarat <- round(weighted.mean(summary_q4$q4_gujarat[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_haryana <- round(weighted.mean(summary_q4$q4_haryana[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_hp <- round(weighted.mean(summary_q4$q4_hp[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_jk <- round(weighted.mean(summary_q4$q4_jk[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_jharkhand <- round(weighted.mean(summary_q4$q4_jharkhand[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_karnataka <- round(weighted.mean(summary_q4$q4_karnataka[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_kerala <- round(weighted.mean(summary_q4$q4_kerala[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_ladakh <- round(weighted.mean(summary_q4$q4_ladakh[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_lakshadweep <- round(weighted.mean(summary_q4$q4_lakshadweep[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_mp <- round(weighted.mean(summary_q4$q4_mp[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_maharashtra <- round(weighted.mean(summary_q4$q4_maharashtra[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_manipur <- round(weighted.mean(summary_q4$q4_manipur[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_meghalaya <- round(weighted.mean(summary_q4$q4_meghalaya[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_mizoram <- round(weighted.mean(summary_q4$q4_mizoram[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_nagaland <- round(weighted.mean(summary_q4$q4_nagaland[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_delhi <- round(weighted.mean(summary_q4$q4_delhi[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_none <- round(weighted.mean(summary_q4$q4_none[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_odisha <- round(weighted.mean(summary_q4$q4_odisha[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_puducherry <- round(weighted.mean(summary_q4$q4_puducherry[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_punjab <- round(weighted.mean(summary_q4$q4_punjab[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_rajasthan <- round(weighted.mean(summary_q4$q4_rajasthan[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_sikkim <- round(weighted.mean(summary_q4$q4_sikkim[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_tn <- round(weighted.mean(summary_q4$q4_tn[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_telangana <- round(weighted.mean(summary_q4$q4_telangana[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_tripura <- round(weighted.mean(summary_q4$q4_tripura[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_up <- round(weighted.mean(summary_q4$q4_up[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_uttarakhand <- round(weighted.mean(summary_q4$q4_uttarakhand[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)
q4perf_weighted_mean_wb <- round(weighted.mean(summary_q4$q4_wb[summary_q4$sdg_tier=="Performer"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Performer"])*100,2)

##Frontrunner
q4frnt_weighted_mean_anislands <- round(weighted.mean(summary_q4$q4_anislands[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_andhra <- round(weighted.mean(summary_q4$q4_andhra[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_arunachal <- round(weighted.mean(summary_q4$q4_arunachal[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_assam <- round(weighted.mean(summary_q4$q4_assam[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_bihar <- round(weighted.mean(summary_q4$q4_bihar[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_chandigarh <- round(weighted.mean(summary_q4$q4_chandigarh[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_chhattisgarh <- round(weighted.mean(summary_q4$q4_chhattisgarh[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_dnhdd <- round(weighted.mean(summary_q4$q4_dnhdd[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_goa <- round(weighted.mean(summary_q4$q4_goa[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_gujarat <- round(weighted.mean(summary_q4$q4_gujarat[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_haryana <- round(weighted.mean(summary_q4$q4_haryana[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_hp <- round(weighted.mean(summary_q4$q4_hp[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_jk <- round(weighted.mean(summary_q4$q4_jk[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_jharkhand <- round(weighted.mean(summary_q4$q4_jharkhand[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_karnataka <- round(weighted.mean(summary_q4$q4_karnataka[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_kerala <- round(weighted.mean(summary_q4$q4_kerala[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_ladakh <- round(weighted.mean(summary_q4$q4_ladakh[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_lakshadweep <- round(weighted.mean(summary_q4$q4_lakshadweep[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_mp <- round(weighted.mean(summary_q4$q4_mp[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_maharashtra <- round(weighted.mean(summary_q4$q4_maharashtra[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_manipur <- round(weighted.mean(summary_q4$q4_manipur[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_meghalaya <- round(weighted.mean(summary_q4$q4_meghalaya[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_mizoram <- round(weighted.mean(summary_q4$q4_mizoram[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_nagaland <- round(weighted.mean(summary_q4$q4_nagaland[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_delhi <- round(weighted.mean(summary_q4$q4_delhi[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_none <- round(weighted.mean(summary_q4$q4_none[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_odisha <- round(weighted.mean(summary_q4$q4_odisha[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_puducherry <- round(weighted.mean(summary_q4$q4_puducherry[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_punjab <- round(weighted.mean(summary_q4$q4_punjab[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_rajasthan <- round(weighted.mean(summary_q4$q4_rajasthan[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_sikkim <- round(weighted.mean(summary_q4$q4_sikkim[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_tn <- round(weighted.mean(summary_q4$q4_tn[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_telangana <- round(weighted.mean(summary_q4$q4_telangana[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_tripura <- round(weighted.mean(summary_q4$q4_tripura[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_up <- round(weighted.mean(summary_q4$q4_up[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_uttarakhand <- round(weighted.mean(summary_q4$q4_uttarakhand[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)
q4frnt_weighted_mean_wb <- round(weighted.mean(summary_q4$q4_wb[summary_q4$sdg_tier=="Frontrunner"], summary_q4$sdg_weight[summary_q4$sdg_tier=="Frontrunner"])*100,2)



#forming separate vectors
q4aspt_plot <- c(q4aspt_weighted_mean_anislands, q4aspt_weighted_mean_andhra, q4aspt_weighted_mean_arunachal, q4aspt_weighted_mean_assam, q4aspt_weighted_mean_bihar, q4aspt_weighted_mean_chandigarh, q4aspt_weighted_mean_chhattisgarh, q4aspt_weighted_mean_delhi, q4aspt_weighted_mean_dnhdd, q4aspt_weighted_mean_goa, q4aspt_weighted_mean_gujarat, q4aspt_weighted_mean_haryana, q4aspt_weighted_mean_hp, q4aspt_weighted_mean_jharkhand, q4aspt_weighted_mean_jk, q4aspt_weighted_mean_karnataka, q4aspt_weighted_mean_kerala, q4aspt_weighted_mean_ladakh, q4aspt_weighted_mean_lakshadweep, q4aspt_weighted_mean_maharashtra, q4aspt_weighted_mean_manipur, q4aspt_weighted_mean_meghalaya, q4aspt_weighted_mean_mizoram, q4aspt_weighted_mean_mp, q4aspt_weighted_mean_nagaland, q4aspt_weighted_mean_none, q4aspt_weighted_mean_odisha, q4aspt_weighted_mean_puducherry, q4aspt_weighted_mean_punjab, q4aspt_weighted_mean_rajasthan, q4aspt_weighted_mean_sikkim, q4aspt_weighted_mean_telangana, q4aspt_weighted_mean_tn, q4aspt_weighted_mean_tripura, q4aspt_weighted_mean_up, q4aspt_weighted_mean_uttarakhand, q4aspt_weighted_mean_wb)

q4perf_plot <- c(q4perf_weighted_mean_anislands, q4perf_weighted_mean_andhra, q4perf_weighted_mean_arunachal, q4perf_weighted_mean_assam, q4perf_weighted_mean_bihar, q4perf_weighted_mean_chandigarh, q4perf_weighted_mean_chhattisgarh, q4perf_weighted_mean_delhi, q4perf_weighted_mean_dnhdd, q4perf_weighted_mean_goa, q4perf_weighted_mean_gujarat, q4perf_weighted_mean_haryana, q4perf_weighted_mean_hp, q4perf_weighted_mean_jharkhand, q4perf_weighted_mean_jk, q4perf_weighted_mean_karnataka, q4perf_weighted_mean_kerala, q4perf_weighted_mean_ladakh, q4perf_weighted_mean_lakshadweep, q4perf_weighted_mean_maharashtra, q4perf_weighted_mean_manipur, q4perf_weighted_mean_meghalaya, q4perf_weighted_mean_mizoram, q4perf_weighted_mean_mp, q4perf_weighted_mean_nagaland, q4perf_weighted_mean_none, q4perf_weighted_mean_odisha, q4perf_weighted_mean_puducherry, q4perf_weighted_mean_punjab, q4perf_weighted_mean_rajasthan, q4perf_weighted_mean_sikkim, q4perf_weighted_mean_telangana, q4perf_weighted_mean_tn, q4perf_weighted_mean_tripura, q4perf_weighted_mean_up, q4perf_weighted_mean_uttarakhand, q4perf_weighted_mean_wb)

q4frnt_plot <- c(q4frnt_weighted_mean_anislands, q4frnt_weighted_mean_andhra, q4frnt_weighted_mean_arunachal, q4frnt_weighted_mean_assam, q4frnt_weighted_mean_bihar, q4frnt_weighted_mean_chandigarh, q4frnt_weighted_mean_chhattisgarh, q4frnt_weighted_mean_delhi, q4frnt_weighted_mean_dnhdd, q4frnt_weighted_mean_goa, q4frnt_weighted_mean_gujarat, q4frnt_weighted_mean_haryana, q4frnt_weighted_mean_hp, q4frnt_weighted_mean_jharkhand, q4frnt_weighted_mean_jk, q4frnt_weighted_mean_karnataka, q4frnt_weighted_mean_kerala, q4frnt_weighted_mean_ladakh, q4frnt_weighted_mean_lakshadweep, q4frnt_weighted_mean_maharashtra, q4frnt_weighted_mean_manipur, q4frnt_weighted_mean_meghalaya, q4frnt_weighted_mean_mizoram, q4frnt_weighted_mean_mp, q4frnt_weighted_mean_nagaland, q4frnt_weighted_mean_none, q4frnt_weighted_mean_odisha, q4frnt_weighted_mean_puducherry, q4frnt_weighted_mean_punjab, q4frnt_weighted_mean_rajasthan, q4frnt_weighted_mean_sikkim, q4frnt_weighted_mean_telangana, q4frnt_weighted_mean_tn, q4frnt_weighted_mean_tripura, q4frnt_weighted_mean_up, q4frnt_weighted_mean_uttarakhand, q4frnt_weighted_mean_wb)

#creating common labels
q4full_plot_labels <- c("AN", "AP", "AR", "AS", "BR", "CH", "CG", "DL", "DNH & DD", "GA", "GJ", "HR", "HP", "JH", "JK", "KA", "KL", "LA", "LD", "MH", "MN", "ML", "MZ", "MP", "NL", "None", "OR", "PY", "PB", "RJ", "SK", "TG", "TN", "TR", "UP", "UK", "WB")


#Invoking GGplot
##aspirant states
q4aspt_plot_dta <- data.frame (q4aspt_plot, q4full_plot_labels) 
q4aspt_plot_dta$wrapped_labels = str_wrap(q4aspt_plot_dta$q4full_plot_labels, width = 10)
q4aspt_plot <- ggplot(q4aspt_plot_dta, aes(x=q4full_plot_labels, y=q4aspt_plot, fill = q4full_plot_labels)) +
  geom_bar(stat="identity", width= 1, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q4aspt_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,40)) +
  scale_x_discrete(labels = function(q4full_plot_labels) str_wrap(q4full_plot_labels, width = 30)) +
  labs(x="",y="Percent", title = "Aspirant States")+
  newtheme

##Performer States
q4perf_plot_dta <- data.frame (q4perf_plot, q4full_plot_labels) 
q4perf_plot_dta$wrapped_labels = str_wrap(q4perf_plot_dta$q4full_plot_labels, width = 10)
q4perf_plot <- ggplot(q4perf_plot_dta, aes(x=q4full_plot_labels, y=q4perf_plot, fill = q4full_plot_labels)) +
  geom_bar(stat="identity", width= 1, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q4perf_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,40)) +
  scale_x_discrete(labels = function(q4full_plot_labels) str_wrap(q4full_plot_labels, width = 30)) +
  labs(x="",y="Percent", title = "Performer States")+
  newtheme

##Frontrunner States
q4frnt_plot_dta <- data.frame (q4frnt_plot, q4full_plot_labels) 
q4frnt_plot_dta$wrapped_labels = str_wrap(q4frnt_plot_dta$q4full_plot_labels, width = 10)
q4frnt_plot <- ggplot(q4frnt_plot_dta, aes(x=q4full_plot_labels, y=q4frnt_plot, fill = q4full_plot_labels)) +
  geom_bar(stat="identity", width= 1, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q4frnt_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,40)) +
  scale_x_discrete(labels = function(q4full_plot_labels) str_wrap(q4full_plot_labels, width = 30)) +
  labs(x="",y="Percent", title = "Frontrunner States")+
  newtheme

#Stacking all plots vertically
grid.newpage()
grid.draw(rbind(ggplotGrob(q4aspt_plot), ggplotGrob(q4perf_plot), ggplotGrob(q4frnt_plot), size = "last"))
```
\newpage

## Question 5: Aggregate Graph 

Please select upto two States that you think have performed their pandemic management responsibilities most poorly.

\vspace{6mm}
```{r, echo = FALSE, fig.height=10,fig.width=18, warning=FALSE}
q5full_mean_anislands <- round(weighted.mean(summary_q5$q5_anislands, summary_q5$state_weight)*100,2)
q5full_mean_andhra <- round(weighted.mean(summary_q5$q5_andhra, summary_q5$state_weight)*100,2)
q5full_mean_arunachal <- round(weighted.mean(summary_q5$q5_arunachal, summary_q5$state_weight)*100,2)
q5full_mean_assam <- round(weighted.mean(summary_q5$q5_assam, summary_q5$state_weight)*100,2)
q5full_mean_bihar <- round(weighted.mean(summary_q5$q5_bihar, summary_q5$state_weight)*100,2)
q5full_mean_chandigarh <- round(weighted.mean(summary_q5$q5_chandigarh, summary_q5$state_weight)*100,2)
q5full_mean_chhattisgarh <- round(weighted.mean(summary_q5$q5_chhattisgarh, summary_q5$state_weight)*100,2)
q5full_mean_dnhdd <- round(weighted.mean(summary_q5$q5_dnhdd, summary_q5$state_weight)*100,2)
q5full_mean_goa <- round(weighted.mean(summary_q5$q5_goa, summary_q5$state_weight)*100,2)
q5full_mean_gujarat <- round(weighted.mean(summary_q5$q5_gujarat, summary_q5$state_weight)*100,2)
q5full_mean_haryana <- round(weighted.mean(summary_q5$q5_haryana, summary_q5$state_weight)*100,2)
q5full_mean_hp <- round(weighted.mean(summary_q5$q5_hp, summary_q5$state_weight)*100,2)
q5full_mean_jk <- round(weighted.mean(summary_q5$q5_jk, summary_q5$state_weight)*100,2)
q5full_mean_jharkhand <- round(weighted.mean(summary_q5$q5_jharkhand, summary_q5$state_weight)*100,2)
q5full_mean_karnataka <- round(weighted.mean(summary_q5$q5_karnataka, summary_q5$state_weight)*100,2)
q5full_mean_kerala <- round(weighted.mean(summary_q5$q5_kerala, summary_q5$state_weight)*100,2)
q5full_mean_ladakh <- round(weighted.mean(summary_q5$q5_ladakh, summary_q5$state_weight)*100,2)
q5full_mean_lakshadweep <- round(weighted.mean(summary_q5$q5_lakshadweep, summary_q5$state_weight)*100,2)
q5full_mean_mp <- round(weighted.mean(summary_q5$q5_mp, summary_q5$state_weight)*100,2)
q5full_mean_maharashtra <- round(weighted.mean(summary_q5$q5_maharashtra, summary_q5$state_weight)*100,2)
q5full_mean_manipur <- round(weighted.mean(summary_q5$q5_manipur, summary_q5$state_weight)*100,2)
q5full_mean_meghalaya <- round(weighted.mean(summary_q5$q5_meghalaya, summary_q5$state_weight)*100,2)
q5full_mean_mizoram <- round(weighted.mean(summary_q5$q5_mizoram, summary_q5$state_weight)*100,2)
q5full_mean_nagaland <- round(weighted.mean(summary_q5$q5_nagaland, summary_q5$state_weight)*100,2)
q5full_mean_delhi <- round(weighted.mean(summary_q5$q5_delhi, summary_q5$state_weight)*100,2)
q5full_mean_none <- round(weighted.mean(summary_q5$q5_none, summary_q5$state_weight)*100,2)
q5full_mean_odisha <- round(weighted.mean(summary_q5$q5_odisha, summary_q5$state_weight)*100,2)
q5full_mean_puducherry <- round(weighted.mean(summary_q5$q5_puducherry, summary_q5$state_weight)*100,2)
q5full_mean_punjab <- round(weighted.mean(summary_q5$q5_punjab, summary_q5$state_weight)*100,2)
q5full_mean_rajasthan <- round(weighted.mean(summary_q5$q5_rajasthan, summary_q5$state_weight)*100,2)
q5full_mean_sikkim <- round(weighted.mean(summary_q5$q5_sikkim, summary_q5$state_weight)*100,2)
q5full_mean_tn <- round(weighted.mean(summary_q5$q5_tn, summary_q5$state_weight)*100,2)
q5full_mean_telangana <- round(weighted.mean(summary_q5$q5_telangana, summary_q5$state_weight)*100,2)
q5full_mean_tripura <- round(weighted.mean(summary_q5$q5_tripura, summary_q5$state_weight)*100,2)
q5full_mean_up <- round(weighted.mean(summary_q5$q5_up, summary_q5$state_weight)*100,2)
q5full_mean_uttarakhand <- round(weighted.mean(summary_q5$q5_uttarakhand, summary_q5$state_weight)*100,2)
q5full_mean_wb <- round(weighted.mean(summary_q5$q5_wb, summary_q5$state_weight)*100,2)

q5full_plot <- c(q5full_mean_anislands, q5full_mean_andhra, q5full_mean_arunachal, q5full_mean_assam, q5full_mean_bihar, q5full_mean_chandigarh, q5full_mean_chhattisgarh, q5full_mean_delhi, q5full_mean_dnhdd, q5full_mean_goa, q5full_mean_gujarat, q5full_mean_haryana, q5full_mean_hp, q5full_mean_jharkhand, q5full_mean_jk, q5full_mean_karnataka, q5full_mean_kerala, q5full_mean_ladakh, q5full_mean_lakshadweep, q5full_mean_maharashtra, q5full_mean_manipur, q5full_mean_meghalaya, q5full_mean_mizoram, q5full_mean_mp, q5full_mean_nagaland, q5full_mean_none, q5full_mean_odisha, q5full_mean_puducherry, q5full_mean_punjab, q5full_mean_rajasthan, q5full_mean_sikkim, q5full_mean_telangana, q5full_mean_tn, q5full_mean_tripura, q5full_mean_up, q5full_mean_uttarakhand, q5full_mean_wb)


q5full_plot_labels <- c("AN", "AP", "AR", "AS", "BR", "CH", "CG", "DL", "DNH & DD", "GA", "GJ", "HR", "HP", "JH", "JK", "KA", "KL", "LA", "LD", "MH", "MN", "ML", "MZ", "MP", "NL", "None", "OR", "PY", "PB", "RJ", "SK", "TG", "TN", "TR", "UP", "UK", "WB")

q5full_plot_dta <- data.frame (q5full_plot, q5full_plot_labels) 
q5full_plot_dta$wrapped_labels = str_wrap(q5full_plot_dta$q5full_plot_labels, width = 10)
q5full_plot <- ggplot(q5full_plot_dta, aes(x=q5full_plot_labels, y=q5full_plot, fill = q5full_plot_labels)) +
  geom_bar(stat="identity", width= 1, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q5full_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,40)) +
  scale_x_discrete(labels = function(q5full_plot_labels) str_wrap(q5full_plot_labels, width = 30)) +
  labs(x="",y="Percent")+
  newtheme

q5full_plot      
```
\newpage

## Question 5: Disaggregated by Age

Please select upto two States that you think have performed their pandemic management responsibilities most poorly.

\vspace{6mm}
```{r, echo = FALSE, fig.height=20,fig.width=18, warning=FALSE}
#Age
q5young_mean_anislands <- round(weighted.mean(summary_q5_young$q5_anislands, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_andhra <- round(weighted.mean(summary_q5_young$q5_andhra, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_arunachal <- round(weighted.mean(summary_q5_young$q5_arunachal, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_assam <- round(weighted.mean(summary_q5_young$q5_assam, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_bihar <- round(weighted.mean(summary_q5_young$q5_bihar, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_chandigarh <- round(weighted.mean(summary_q5_young$q5_chandigarh, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_chhattisgarh <- round(weighted.mean(summary_q5_young$q5_chhattisgarh, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_dnhdd <- round(weighted.mean(summary_q5_young$q5_dnhdd, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_goa <- round(weighted.mean(summary_q5_young$q5_goa, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_gujarat <- round(weighted.mean(summary_q5_young$q5_gujarat, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_haryana <- round(weighted.mean(summary_q5_young$q5_haryana, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_hp <- round(weighted.mean(summary_q5_young$q5_hp, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_jk <- round(weighted.mean(summary_q5_young$q5_jk, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_jharkhand <- round(weighted.mean(summary_q5_young$q5_jharkhand, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_karnataka <- round(weighted.mean(summary_q5_young$q5_karnataka, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_kerala <- round(weighted.mean(summary_q5_young$q5_kerala, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_ladakh <- round(weighted.mean(summary_q5_young$q5_ladakh, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_lakshadweep <- round(weighted.mean(summary_q5_young$q5_lakshadweep, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_mp <- round(weighted.mean(summary_q5_young$q5_mp, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_maharashtra <- round(weighted.mean(summary_q5_young$q5_maharashtra, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_manipur <- round(weighted.mean(summary_q5_young$q5_manipur, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_meghalaya <- round(weighted.mean(summary_q5_young$q5_meghalaya, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_mizoram <- round(weighted.mean(summary_q5_young$q5_mizoram, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_nagaland <- round(weighted.mean(summary_q5_young$q5_nagaland, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_delhi <- round(weighted.mean(summary_q5_young$q5_delhi, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_none <- round(weighted.mean(summary_q5_young$q5_none, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_odisha <- round(weighted.mean(summary_q5_young$q5_odisha, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_puducherry <- round(weighted.mean(summary_q5_young$q5_puducherry, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_punjab <- round(weighted.mean(summary_q5_young$q5_punjab, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_rajasthan <- round(weighted.mean(summary_q5_young$q5_rajasthan, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_sikkim <- round(weighted.mean(summary_q5_young$q5_sikkim, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_tn <- round(weighted.mean(summary_q5_young$q5_tn, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_telangana <- round(weighted.mean(summary_q5_young$q5_telangana, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_tripura <- round(weighted.mean(summary_q5_young$q5_tripura, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_up <- round(weighted.mean(summary_q5_young$q5_up, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_uttarakhand <- round(weighted.mean(summary_q5_young$q5_uttarakhand, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)
q5young_mean_wb <- round(weighted.mean(summary_q5_young$q5_wb, summary_q5_young$state_young_weight, na.rm = TRUE)*100,2)

q5young_plot <- c(q5young_mean_anislands, q5young_mean_andhra, q5young_mean_arunachal, q5young_mean_assam, q5young_mean_bihar, q5young_mean_chandigarh, q5young_mean_chhattisgarh, q5young_mean_delhi, q5young_mean_dnhdd, q5young_mean_goa, q5young_mean_gujarat, q5young_mean_haryana, q5young_mean_hp, q5young_mean_jharkhand, q5young_mean_jk, q5young_mean_karnataka, q5young_mean_kerala, q5young_mean_ladakh, q5young_mean_lakshadweep, q5young_mean_maharashtra, q5young_mean_manipur, q5young_mean_meghalaya, q5young_mean_mizoram, q5young_mean_mp, q5young_mean_nagaland, q5young_mean_none, q5young_mean_odisha, q5young_mean_puducherry, q5young_mean_punjab, q5young_mean_rajasthan, q5young_mean_sikkim, q5young_mean_telangana, q5young_mean_tn, q5young_mean_tripura, q5young_mean_up, q5young_mean_uttarakhand, q5young_mean_wb)

q5young_plot_labels <- c("AN", "AP", "AR", "AS", "BR", "CH", "CG", "DL", "DNH & DD", "GA", "GJ", "HR", "HP", "JH", "JK", "KA", "KL", "LA", "LD", "MH", "MN", "ML", "MZ", "MP", "NL", "None", "OR", "PY", "PB", "RJ", "SK", "TG", "TN", "TR", "UP", "UK", "WB")

q5young_plot_dta <- data.frame (q5young_plot, q5young_plot_labels) 
q5young_plot_dta$wrapped_labels = str_wrap(q5young_plot_dta$q5young_plot_labels, width = 10)
q5young_plot <- ggplot(q5young_plot_dta, aes(x=q5young_plot_labels, y=q5young_plot, fill = q5young_plot_labels)) +
  geom_bar(stat="identity", width= 1, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q5young_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,40)) +
  scale_x_discrete(labels = function(q5young_plot_labels) str_wrap(q5young_plot_labels, width = 30)) +
  labs(x="",y="Percent", title = "2012 and After")+
  newtheme

q5old_mean_anislands <- round(weighted.mean(summary_q5_old$q5_anislands, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_andhra <- round(weighted.mean(summary_q5_old$q5_andhra, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_arunachal <- round(weighted.mean(summary_q5_old$q5_arunachal, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_assam <- round(weighted.mean(summary_q5_old$q5_assam, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_bihar <- round(weighted.mean(summary_q5_old$q5_bihar, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_chandigarh <- round(weighted.mean(summary_q5_old$q5_chandigarh, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_chhattisgarh <- round(weighted.mean(summary_q5_old$q5_chhattisgarh, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_dnhdd <- round(weighted.mean(summary_q5_old$q5_dnhdd, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_goa <- round(weighted.mean(summary_q5_old$q5_goa, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_gujarat <- round(weighted.mean(summary_q5_old$q5_gujarat, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_haryana <- round(weighted.mean(summary_q5_old$q5_haryana, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_hp <- round(weighted.mean(summary_q5_old$q5_hp, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_jk <- round(weighted.mean(summary_q5_old$q5_jk, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_jharkhand <- round(weighted.mean(summary_q5_old$q5_jharkhand, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_karnataka <- round(weighted.mean(summary_q5_old$q5_karnataka, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_kerala <- round(weighted.mean(summary_q5_old$q5_kerala, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_ladakh <- round(weighted.mean(summary_q5_old$q5_ladakh, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_lakshadweep <- round(weighted.mean(summary_q5_old$q5_lakshadweep, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_mp <- round(weighted.mean(summary_q5_old$q5_mp, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_maharashtra <- round(weighted.mean(summary_q5_old$q5_maharashtra, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_manipur <- round(weighted.mean(summary_q5_old$q5_manipur, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_meghalaya <- round(weighted.mean(summary_q5_old$q5_meghalaya, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_mizoram <- round(weighted.mean(summary_q5_old$q5_mizoram, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_nagaland <- round(weighted.mean(summary_q5_old$q5_nagaland, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_delhi <- round(weighted.mean(summary_q5_old$q5_delhi, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_none <- round(weighted.mean(summary_q5_old$q5_none, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_odisha <- round(weighted.mean(summary_q5_old$q5_odisha, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_puducherry <- round(weighted.mean(summary_q5_old$q5_puducherry, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_punjab <- round(weighted.mean(summary_q5_old$q5_punjab, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_rajasthan <- round(weighted.mean(summary_q5_old$q5_rajasthan, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_sikkim <- round(weighted.mean(summary_q5_old$q5_sikkim, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_tn <- round(weighted.mean(summary_q5_old$q5_tn, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_telangana <- round(weighted.mean(summary_q5_old$q5_telangana, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_tripura <- round(weighted.mean(summary_q5_old$q5_tripura, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_up <- round(weighted.mean(summary_q5_old$q5_up, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_uttarakhand <- round(weighted.mean(summary_q5_old$q5_uttarakhand, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)
q5old_mean_wb <- round(weighted.mean(summary_q5_old$q5_wb, summary_q5_old$state_old_weight, na.rm = TRUE)*100,2)

q5old_plot <- c(q5old_mean_anislands, q5old_mean_andhra, q5old_mean_arunachal, q5old_mean_assam, q5old_mean_bihar, q5old_mean_chandigarh, q5old_mean_chhattisgarh, q5old_mean_delhi, q5old_mean_dnhdd, q5old_mean_goa, q5old_mean_gujarat, q5old_mean_haryana, q5old_mean_hp, q5old_mean_jharkhand, q5old_mean_jk, q5old_mean_karnataka, q5old_mean_kerala, q5old_mean_ladakh, q5old_mean_lakshadweep, q5old_mean_maharashtra, q5old_mean_manipur, q5old_mean_meghalaya, q5old_mean_mizoram, q5old_mean_mp, q5old_mean_nagaland, q5old_mean_none, q5old_mean_odisha, q5old_mean_puducherry, q5old_mean_punjab, q5old_mean_rajasthan, q5old_mean_sikkim, q5old_mean_telangana, q5old_mean_tn, q5old_mean_tripura, q5old_mean_up, q5old_mean_uttarakhand, q5old_mean_wb)

q5old_plot_labels <- c("AN", "AP", "AR", "AS", "BR", "CH", "CG", "DL", "DNH & DD", "GA", "GJ", "HR", "HP", "JH", "JK", "KA", "KL", "LA", "LD", "MH", "MN", "ML", "MZ", "MP", "NL", "None", "OR", "PY", "PB", "RJ", "SK", "TG", "TN", "TR", "UP", "UK", "WB")

q5old_plot_dta <- data.frame (q5old_plot, q5old_plot_labels) 
q5old_plot_dta$wrapped_labels = str_wrap(q5old_plot_dta$q5old_plot_labels, width = 10)
q5old_plot <- ggplot(q5old_plot_dta, aes(x=q5old_plot_labels, y=q5old_plot, fill = q5old_plot_labels)) +
  geom_bar(stat="identity", width= 1, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q5old_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,40)) +
  scale_x_discrete(labels = function(q5old_plot_labels) str_wrap(q5old_plot_labels, width = 30)) +
  labs(x="",y="Percent", title = "2011 and Before")+
  newtheme

q5former_mean_anislands <- summary_q5_former$q5_anislands*100
q5former_mean_andhra <- summary_q5_former$q5_andhra*100
q5former_mean_arunachal <- summary_q5_former$q5_arunachal*100
q5former_mean_assam <- summary_q5_former$q5_assam*100
q5former_mean_bihar <- summary_q5_former$q5_bihar*100
q5former_mean_chandigarh <- summary_q5_former$q5_chandigarh*100
q5former_mean_chhattisgarh <- summary_q5_former$q5_chhattisgarh*100
q5former_mean_delhi <- summary_q5_former$q5_delhi*100
q5former_mean_dnhdd <- summary_q5_former$q5_dnhdd*100
q5former_mean_goa <- summary_q5_former$q5_goa*100
q5former_mean_gujarat <- summary_q5_former$q5_gujarat*100
q5former_mean_haryana <- summary_q5_former$q5_haryana*100
q5former_mean_hp <- summary_q5_former$q5_hp*100
q5former_mean_jharkhand <- summary_q5_former$q5_jharkhand*100
q5former_mean_jk <- summary_q5_former$q5_jk*100
q5former_mean_karnataka <- summary_q5_former$q5_karnataka*100
q5former_mean_kerala <- summary_q5_former$q5_kerala*100
q5former_mean_lakshadweep <- summary_q5_former$q5_lakshadweep*100
q5former_mean_ladakh <- summary_q5_former$q5_ladakh*100
q5former_mean_maharashtra <- summary_q5_former$q5_maharashtra*100
q5former_mean_manipur <- summary_q5_former$q5_manipur*100
q5former_mean_meghalaya <- summary_q5_former$q5_meghalaya*100
q5former_mean_mizoram <- summary_q5_former$q5_mizoram*100
q5former_mean_mp <- summary_q5_former$q5_mp*100
q5former_mean_nagaland <- summary_q5_former$q5_nagaland*100
q5former_mean_none <- summary_q5_former$q5_none*100
q5former_mean_odisha <- summary_q5_former$q5_odisha*100
q5former_mean_puducherry <- summary_q5_former$q5_puducherry*100
q5former_mean_punjab <-summary_q5_former$q5_punjab*100
q5former_mean_rajasthan <- summary_q5_former$q5_rajasthan*100
q5former_mean_sikkim <- summary_q5_former$q5_sikkim*100
q5former_mean_telangana <- summary_q5_former$q5_telangana*100
q5former_mean_tn <- summary_q5_former$q5_tn*100
q5former_mean_tripura <- summary_q5_former$q5_tripura*100
q5former_mean_up <- summary_q5_former$q5_up*100
q5former_mean_uttarakhand <- summary_q5_former$q5_uttarakhand*100
q5former_mean_wb <- summary_q5_former$q5_wb*100

q5former_plot <- c(q5former_mean_anislands, q5former_mean_andhra, q5former_mean_arunachal, q5former_mean_assam, q5former_mean_bihar, q5former_mean_chandigarh, q5former_mean_chhattisgarh, q5former_mean_delhi, q5former_mean_dnhdd, q5former_mean_goa, q5former_mean_gujarat, q5former_mean_haryana, q5former_mean_hp, q5former_mean_jharkhand, q5former_mean_jk, q5former_mean_karnataka, q5former_mean_kerala, q5former_mean_ladakh, q5former_mean_lakshadweep, q5former_mean_maharashtra, q5former_mean_manipur, q5former_mean_meghalaya, q5former_mean_mizoram, q5former_mean_mp, q5former_mean_nagaland, q5former_mean_none, q5former_mean_odisha, q5former_mean_puducherry, q5former_mean_punjab, q5former_mean_rajasthan, q5former_mean_sikkim, q5former_mean_telangana, q5former_mean_tn, q5former_mean_tripura, q5former_mean_up, q5former_mean_uttarakhand, q5former_mean_wb)

q5former_plot_labels <- c("AN", "AP", "AR", "AS", "BR", "CH", "CG", "DL", "DNH & DD", "GA", "GJ", "HR", "HP", "JH", "JK", "KA", "KL", "LA", "LD", "MH", "MN", "ML", "MZ", "MP", "NL", "None", "OR", "PY", "PB", "RJ", "SK", "TG", "TN", "TR", "UP", "UK", "WB")

q5former_plot_dta <- data.frame (q5former_plot, q5former_plot_labels) 
q5former_plot_dta$wrapped_labels = str_wrap(q5former_plot_dta$q5former_plot_labels, width = 10)
q5former_plot <- ggplot(q5former_plot_dta, aes(x=q5former_plot_labels, y=q5former_plot, fill = q5former_plot_labels)) +
  geom_bar(stat="identity", width= 1, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q5former_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,40)) +
  scale_x_discrete(labels = function(q5former_plot_labels) str_wrap(q5former_plot_labels, width = 30)) +
  labs(x="",y="Percent", title = "Former Officers")+
  newtheme

plot5_fullage <- plot_grid(q5young_plot,q5old_plot,q5former_plot, nrow=3)
plot5_fullage
```
\newpage

## Question 5: Disaggregated by SDG

Please select upto two States that you think have performed their pandemic management responsibilities most poorly.

\vspace{6mm}
```{r, echo = FALSE, fig.height=20,fig.width=18, warning=FALSE}
summary_q5 <- summary_q5 %>% 
mutate (sdg_tier = ias_processed_dta$sdg)

#Calculating weighted means
##Aspirants
q5aspt_weighted_mean_anislands <- round(weighted.mean(summary_q5$q5_anislands[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_andhra <- round(weighted.mean(summary_q5$q5_andhra[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_arunachal <- round(weighted.mean(summary_q5$q5_arunachal[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_assam <- round(weighted.mean(summary_q5$q5_assam[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_bihar <- round(weighted.mean(summary_q5$q5_bihar[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_chandigarh <- round(weighted.mean(summary_q5$q5_chandigarh[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_chhattisgarh <- round(weighted.mean(summary_q5$q5_chhattisgarh[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_dnhdd <- round(weighted.mean(summary_q5$q5_dnhdd[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_goa <- round(weighted.mean(summary_q5$q5_goa[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_gujarat <- round(weighted.mean(summary_q5$q5_gujarat[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_haryana <- round(weighted.mean(summary_q5$q5_haryana[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_hp <- round(weighted.mean(summary_q5$q5_hp[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_jk <- round(weighted.mean(summary_q5$q5_jk[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_jharkhand <- round(weighted.mean(summary_q5$q5_jharkhand[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_karnataka <- round(weighted.mean(summary_q5$q5_karnataka[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_kerala <- round(weighted.mean(summary_q5$q5_kerala[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_ladakh <- round(weighted.mean(summary_q5$q5_ladakh[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_lakshadweep <- round(weighted.mean(summary_q5$q5_lakshadweep[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_mp <- round(weighted.mean(summary_q5$q5_mp[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_maharashtra <- round(weighted.mean(summary_q5$q5_maharashtra[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_manipur <- round(weighted.mean(summary_q5$q5_manipur[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_meghalaya <- round(weighted.mean(summary_q5$q5_meghalaya[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_mizoram <- round(weighted.mean(summary_q5$q5_mizoram[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_nagaland <- round(weighted.mean(summary_q5$q5_nagaland[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_delhi <- round(weighted.mean(summary_q5$q5_delhi[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_none <- round(weighted.mean(summary_q5$q5_none[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_odisha <- round(weighted.mean(summary_q5$q5_odisha[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_puducherry <- round(weighted.mean(summary_q5$q5_puducherry[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_punjab <- round(weighted.mean(summary_q5$q5_punjab[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_rajasthan <- round(weighted.mean(summary_q5$q5_rajasthan[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_sikkim <- round(weighted.mean(summary_q5$q5_sikkim[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_tn <- round(weighted.mean(summary_q5$q5_tn[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_telangana <- round(weighted.mean(summary_q5$q5_telangana[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_tripura <- round(weighted.mean(summary_q5$q5_tripura[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_up <- round(weighted.mean(summary_q5$q5_up[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_uttarakhand <- round(weighted.mean(summary_q5$q5_uttarakhand[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)
q5aspt_weighted_mean_wb <- round(weighted.mean(summary_q5$q5_wb[summary_q5$sdg_tier=="Aspirant"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Aspirant"])*100,2)

##Performers
q5perf_weighted_mean_anislands <- round(weighted.mean(summary_q5$q5_anislands[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_andhra <- round(weighted.mean(summary_q5$q5_andhra[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_arunachal <- round(weighted.mean(summary_q5$q5_arunachal[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_assam <- round(weighted.mean(summary_q5$q5_assam[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_bihar <- round(weighted.mean(summary_q5$q5_bihar[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_chandigarh <- round(weighted.mean(summary_q5$q5_chandigarh[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_chhattisgarh <- round(weighted.mean(summary_q5$q5_chhattisgarh[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_dnhdd <- round(weighted.mean(summary_q5$q5_dnhdd[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_goa <- round(weighted.mean(summary_q5$q5_goa[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_gujarat <- round(weighted.mean(summary_q5$q5_gujarat[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_haryana <- round(weighted.mean(summary_q5$q5_haryana[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_hp <- round(weighted.mean(summary_q5$q5_hp[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_jk <- round(weighted.mean(summary_q5$q5_jk[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_jharkhand <- round(weighted.mean(summary_q5$q5_jharkhand[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_karnataka <- round(weighted.mean(summary_q5$q5_karnataka[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_kerala <- round(weighted.mean(summary_q5$q5_kerala[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_ladakh <- round(weighted.mean(summary_q5$q5_ladakh[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_lakshadweep <- round(weighted.mean(summary_q5$q5_lakshadweep[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_mp <- round(weighted.mean(summary_q5$q5_mp[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_maharashtra <- round(weighted.mean(summary_q5$q5_maharashtra[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_manipur <- round(weighted.mean(summary_q5$q5_manipur[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_meghalaya <- round(weighted.mean(summary_q5$q5_meghalaya[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_mizoram <- round(weighted.mean(summary_q5$q5_mizoram[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_nagaland <- round(weighted.mean(summary_q5$q5_nagaland[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_delhi <- round(weighted.mean(summary_q5$q5_delhi[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_none <- round(weighted.mean(summary_q5$q5_none[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_odisha <- round(weighted.mean(summary_q5$q5_odisha[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_puducherry <- round(weighted.mean(summary_q5$q5_puducherry[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_punjab <- round(weighted.mean(summary_q5$q5_punjab[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_rajasthan <- round(weighted.mean(summary_q5$q5_rajasthan[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_sikkim <- round(weighted.mean(summary_q5$q5_sikkim[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_tn <- round(weighted.mean(summary_q5$q5_tn[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_telangana <- round(weighted.mean(summary_q5$q5_telangana[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_tripura <- round(weighted.mean(summary_q5$q5_tripura[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_up <- round(weighted.mean(summary_q5$q5_up[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_uttarakhand <- round(weighted.mean(summary_q5$q5_uttarakhand[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)
q5perf_weighted_mean_wb <- round(weighted.mean(summary_q5$q5_wb[summary_q5$sdg_tier=="Performer"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Performer"])*100,2)

##Frontrunner
q5frnt_weighted_mean_anislands <- round(weighted.mean(summary_q5$q5_anislands[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_andhra <- round(weighted.mean(summary_q5$q5_andhra[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_arunachal <- round(weighted.mean(summary_q5$q5_arunachal[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_assam <- round(weighted.mean(summary_q5$q5_assam[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_bihar <- round(weighted.mean(summary_q5$q5_bihar[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_chandigarh <- round(weighted.mean(summary_q5$q5_chandigarh[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_chhattisgarh <- round(weighted.mean(summary_q5$q5_chhattisgarh[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_dnhdd <- round(weighted.mean(summary_q5$q5_dnhdd[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_goa <- round(weighted.mean(summary_q5$q5_goa[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_gujarat <- round(weighted.mean(summary_q5$q5_gujarat[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_haryana <- round(weighted.mean(summary_q5$q5_haryana[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_hp <- round(weighted.mean(summary_q5$q5_hp[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_jk <- round(weighted.mean(summary_q5$q5_jk[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_jharkhand <- round(weighted.mean(summary_q5$q5_jharkhand[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_karnataka <- round(weighted.mean(summary_q5$q5_karnataka[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_kerala <- round(weighted.mean(summary_q5$q5_kerala[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_ladakh <- round(weighted.mean(summary_q5$q5_ladakh[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_lakshadweep <- round(weighted.mean(summary_q5$q5_lakshadweep[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_mp <- round(weighted.mean(summary_q5$q5_mp[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_maharashtra <- round(weighted.mean(summary_q5$q5_maharashtra[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_manipur <- round(weighted.mean(summary_q5$q5_manipur[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_meghalaya <- round(weighted.mean(summary_q5$q5_meghalaya[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_mizoram <- round(weighted.mean(summary_q5$q5_mizoram[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_nagaland <- round(weighted.mean(summary_q5$q5_nagaland[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_delhi <- round(weighted.mean(summary_q5$q5_delhi[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_none <- round(weighted.mean(summary_q5$q5_none[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_odisha <- round(weighted.mean(summary_q5$q5_odisha[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_puducherry <- round(weighted.mean(summary_q5$q5_puducherry[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_punjab <- round(weighted.mean(summary_q5$q5_punjab[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_rajasthan <- round(weighted.mean(summary_q5$q5_rajasthan[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_sikkim <- round(weighted.mean(summary_q5$q5_sikkim[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_tn <- round(weighted.mean(summary_q5$q5_tn[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_telangana <- round(weighted.mean(summary_q5$q5_telangana[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_tripura <- round(weighted.mean(summary_q5$q5_tripura[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_up <- round(weighted.mean(summary_q5$q5_up[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_uttarakhand <- round(weighted.mean(summary_q5$q5_uttarakhand[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)
q5frnt_weighted_mean_wb <- round(weighted.mean(summary_q5$q5_wb[summary_q5$sdg_tier=="Frontrunner"], summary_q5$sdg_weight[summary_q5$sdg_tier=="Frontrunner"])*100,2)

#forming separate vectors
q5aspt_plot <- c(q5aspt_weighted_mean_anislands, q5aspt_weighted_mean_andhra, q5aspt_weighted_mean_arunachal, q5aspt_weighted_mean_assam, q5aspt_weighted_mean_bihar, q5aspt_weighted_mean_chandigarh, q5aspt_weighted_mean_chhattisgarh, q5aspt_weighted_mean_delhi, q5aspt_weighted_mean_dnhdd, q5aspt_weighted_mean_goa, q5aspt_weighted_mean_gujarat, q5aspt_weighted_mean_haryana, q5aspt_weighted_mean_hp, q5aspt_weighted_mean_jharkhand, q5aspt_weighted_mean_jk, q5aspt_weighted_mean_karnataka, q5aspt_weighted_mean_kerala, q5aspt_weighted_mean_ladakh, q5aspt_weighted_mean_lakshadweep, q5aspt_weighted_mean_maharashtra, q5aspt_weighted_mean_manipur, q5aspt_weighted_mean_meghalaya, q5aspt_weighted_mean_mizoram, q5aspt_weighted_mean_mp, q5aspt_weighted_mean_nagaland, q5aspt_weighted_mean_none, q5aspt_weighted_mean_odisha, q5aspt_weighted_mean_puducherry, q5aspt_weighted_mean_punjab, q5aspt_weighted_mean_rajasthan, q5aspt_weighted_mean_sikkim, q5aspt_weighted_mean_telangana, q5aspt_weighted_mean_tn, q5aspt_weighted_mean_tripura, q5aspt_weighted_mean_up, q5aspt_weighted_mean_uttarakhand, q5aspt_weighted_mean_wb)

q5perf_plot <- c(q5perf_weighted_mean_anislands, q5perf_weighted_mean_andhra, q5perf_weighted_mean_arunachal, q5perf_weighted_mean_assam, q5perf_weighted_mean_bihar, q5perf_weighted_mean_chandigarh, q5perf_weighted_mean_chhattisgarh, q5perf_weighted_mean_delhi, q5perf_weighted_mean_dnhdd, q5perf_weighted_mean_goa, q5perf_weighted_mean_gujarat, q5perf_weighted_mean_haryana, q5perf_weighted_mean_hp, q5perf_weighted_mean_jharkhand, q5perf_weighted_mean_jk, q5perf_weighted_mean_karnataka, q5perf_weighted_mean_kerala, q5perf_weighted_mean_ladakh, q5perf_weighted_mean_lakshadweep, q5perf_weighted_mean_maharashtra, q5perf_weighted_mean_manipur, q5perf_weighted_mean_meghalaya, q5perf_weighted_mean_mizoram, q5perf_weighted_mean_mp, q5perf_weighted_mean_nagaland, q5perf_weighted_mean_none, q5perf_weighted_mean_odisha, q5perf_weighted_mean_puducherry, q5perf_weighted_mean_punjab, q5perf_weighted_mean_rajasthan, q5perf_weighted_mean_sikkim, q5perf_weighted_mean_telangana, q5perf_weighted_mean_tn, q5perf_weighted_mean_tripura, q5perf_weighted_mean_up, q5perf_weighted_mean_uttarakhand, q5perf_weighted_mean_wb)

q5frnt_plot <- c(q5frnt_weighted_mean_anislands, q5frnt_weighted_mean_andhra, q5frnt_weighted_mean_arunachal, q5frnt_weighted_mean_assam, q5frnt_weighted_mean_bihar, q5frnt_weighted_mean_chandigarh, q5frnt_weighted_mean_chhattisgarh, q5frnt_weighted_mean_delhi, q5frnt_weighted_mean_dnhdd, q5frnt_weighted_mean_goa, q5frnt_weighted_mean_gujarat, q5frnt_weighted_mean_haryana, q5frnt_weighted_mean_hp, q5frnt_weighted_mean_jharkhand, q5frnt_weighted_mean_jk, q5frnt_weighted_mean_karnataka, q5frnt_weighted_mean_kerala, q5frnt_weighted_mean_ladakh, q5frnt_weighted_mean_lakshadweep, q5frnt_weighted_mean_maharashtra, q5frnt_weighted_mean_manipur, q5frnt_weighted_mean_meghalaya, q5frnt_weighted_mean_mizoram, q5frnt_weighted_mean_mp, q5frnt_weighted_mean_nagaland, q5frnt_weighted_mean_none, q5frnt_weighted_mean_odisha, q5frnt_weighted_mean_puducherry, q5frnt_weighted_mean_punjab, q5frnt_weighted_mean_rajasthan, q5frnt_weighted_mean_sikkim, q5frnt_weighted_mean_telangana, q5frnt_weighted_mean_tn, q5frnt_weighted_mean_tripura, q5frnt_weighted_mean_up, q5frnt_weighted_mean_uttarakhand, q5frnt_weighted_mean_wb)

#creating common labels
q5full_plot_labels <- c("AN", "AP", "AR", "AS", "BR", "CH", "CG", "DL", "DNH & DD", "GA", "GJ", "HR", "HP", "JH", "JK", "KA", "KL", "LA", "LD", "MH", "MN", "ML", "MZ", "MP", "NL", "None", "OR", "PY", "PB", "RJ", "SK", "TG", "TN", "TR", "UP", "UK", "WB")

#Invoking GGplot
##aspirant states
q5aspt_plot_dta <- data.frame (q5aspt_plot, q5full_plot_labels) 
q5aspt_plot_dta$wrapped_labels = str_wrap(q5aspt_plot_dta$q5full_plot_labels, width = 10)
q5aspt_plot <- ggplot(q5aspt_plot_dta, aes(x=q5full_plot_labels, y=q5aspt_plot, fill = q5full_plot_labels)) +
  geom_bar(stat="identity", width= 1, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q5aspt_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,40)) +
  scale_x_discrete(labels = function(q5full_plot_labels) str_wrap(q5full_plot_labels, width = 30)) +
  labs(x="",y="Percent", title = "Aspirant States")+
  newtheme

##Performer States
q5perf_plot_dta <- data.frame (q5perf_plot, q5full_plot_labels) 
q5perf_plot_dta$wrapped_labels = str_wrap(q5perf_plot_dta$q5full_plot_labels, width = 10)
q5perf_plot <- ggplot(q5perf_plot_dta, aes(x=q5full_plot_labels, y=q5perf_plot, fill = q5full_plot_labels)) +
  geom_bar(stat="identity", width= 1, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q5perf_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,40)) +
  scale_x_discrete(labels = function(q5full_plot_labels) str_wrap(q5full_plot_labels, width = 30)) +
  labs(x="",y="Percent", title = "Performer States")+
  newtheme

##Frontrunner States
q5frnt_plot_dta <- data.frame (q5frnt_plot, q5full_plot_labels) 
q5frnt_plot_dta$wrapped_labels = str_wrap(q5frnt_plot_dta$q5full_plot_labels, width = 10)
q5frnt_plot <- ggplot(q5frnt_plot_dta, aes(x=q5full_plot_labels, y=q5frnt_plot, fill = q5full_plot_labels)) +
  geom_bar(stat="identity", width= 1, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q5frnt_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,40)) +
  scale_x_discrete(labels = function(q5full_plot_labels) str_wrap(q5full_plot_labels, width = 30)) +
  labs(x="",y="Percent", title = "Frontrunner States")+
  newtheme

#Stacking all plots vertically
grid.newpage()
grid.draw(rbind(ggplotGrob(q5aspt_plot), ggplotGrob(q5perf_plot), ggplotGrob(q5frnt_plot), size = "last"))
```
\newpage

## Question 6: Aggregate Graph

Please select one State that you think has been under-appreciated for its success in pandemic management. (States selected in previous answers can be repeated)  

\vspace{6mm}
```{r, echo = FALSE, fig.height=10,fig.width=18, warning=FALSE}
q6full_mean_anislands <- round(weighted.mean(summary_q6$q6_anislands, summary_q6$state_weight)*100,2)
q6full_mean_andhra <- round(weighted.mean(summary_q6$q6_andhra, summary_q6$state_weight)*100,2)
q6full_mean_arunachal <- round(weighted.mean(summary_q6$q6_arunachal, summary_q6$state_weight)*100,2)
q6full_mean_assam <- round(weighted.mean(summary_q6$q6_assam, summary_q6$state_weight)*100,2)
q6full_mean_bihar <- round(weighted.mean(summary_q6$q6_bihar, summary_q6$state_weight)*100,2)
q6full_mean_chandigarh <- round(weighted.mean(summary_q6$q6_chandigarh, summary_q6$state_weight)*100,2)
q6full_mean_chhattisgarh <- round(weighted.mean(summary_q6$q6_chhattisgarh, summary_q6$state_weight)*100,2)
q6full_mean_dnhdd <- round(weighted.mean(summary_q6$q6_dnhdd, summary_q6$state_weight)*100,2)
q6full_mean_goa <- round(weighted.mean(summary_q6$q6_goa, summary_q6$state_weight)*100,2)
q6full_mean_gujarat <- round(weighted.mean(summary_q6$q6_gujarat, summary_q6$state_weight)*100,2)
q6full_mean_haryana <- round(weighted.mean(summary_q6$q6_haryana, summary_q6$state_weight)*100,2)
q6full_mean_hp <- round(weighted.mean(summary_q6$q6_hp, summary_q6$state_weight)*100,2)
q6full_mean_jk <- round(weighted.mean(summary_q6$q6_jk, summary_q6$state_weight)*100,2)
q6full_mean_jharkhand <- round(weighted.mean(summary_q6$q6_jharkhand, summary_q6$state_weight)*100,2)
q6full_mean_karnataka <- round(weighted.mean(summary_q6$q6_karnataka, summary_q6$state_weight)*100,2)
q6full_mean_kerala <- round(weighted.mean(summary_q6$q6_kerala, summary_q6$state_weight)*100,2)
q6full_mean_ladakh <- round(weighted.mean(summary_q6$q6_ladakh, summary_q6$state_weight)*100,2)
q6full_mean_lakshadweep <- round(weighted.mean(summary_q6$q6_lakshadweep, summary_q6$state_weight)*100,2)
q6full_mean_mp <- round(weighted.mean(summary_q6$q6_mp, summary_q6$state_weight)*100,2)
q6full_mean_maharashtra <- round(weighted.mean(summary_q6$q6_maharashtra, summary_q6$state_weight)*100,2)
q6full_mean_manipur <- round(weighted.mean(summary_q6$q6_manipur, summary_q6$state_weight)*100,2)
q6full_mean_meghalaya <- round(weighted.mean(summary_q6$q6_meghalaya, summary_q6$state_weight)*100,2)
q6full_mean_mizoram <- round(weighted.mean(summary_q6$q6_mizoram, summary_q6$state_weight)*100,2)
q6full_mean_nagaland <- round(weighted.mean(summary_q6$q6_nagaland, summary_q6$state_weight)*100,2)
q6full_mean_delhi <- round(weighted.mean(summary_q6$q6_delhi, summary_q6$state_weight)*100,2)
q6full_mean_none <- round(weighted.mean(summary_q6$q6_none, summary_q6$state_weight)*100,2)
q6full_mean_odisha <- round(weighted.mean(summary_q6$q6_odisha, summary_q6$state_weight)*100,2)
q6full_mean_puducherry <- round(weighted.mean(summary_q6$q6_puducherry, summary_q6$state_weight)*100,2)
q6full_mean_punjab <- round(weighted.mean(summary_q6$q6_punjab, summary_q6$state_weight)*100,2)
q6full_mean_rajasthan <- round(weighted.mean(summary_q6$q6_rajasthan, summary_q6$state_weight)*100,2)
q6full_mean_sikkim <- round(weighted.mean(summary_q6$q6_sikkim, summary_q6$state_weight)*100,2)
q6full_mean_tn <- round(weighted.mean(summary_q6$q6_tn, summary_q6$state_weight)*100,2)
q6full_mean_telangana <- round(weighted.mean(summary_q6$q6_telangana, summary_q6$state_weight)*100,2)
q6full_mean_tripura <- round(weighted.mean(summary_q6$q6_tripura, summary_q6$state_weight)*100,2)
q6full_mean_up <- round(weighted.mean(summary_q6$q6_up, summary_q6$state_weight)*100,2)
q6full_mean_uttarakhand <- round(weighted.mean(summary_q6$q6_uttarakhand, summary_q6$state_weight)*100,2)
q6full_mean_wb <- round(weighted.mean(summary_q6$q6_wb, summary_q6$state_weight)*100,2)

q6full_plot <- c(q6full_mean_anislands, q6full_mean_andhra, q6full_mean_arunachal, q6full_mean_assam, q6full_mean_bihar, q6full_mean_chandigarh, q6full_mean_chhattisgarh, q6full_mean_delhi, q6full_mean_dnhdd, q6full_mean_goa, q6full_mean_gujarat, q6full_mean_haryana, q6full_mean_hp, q6full_mean_jharkhand, q6full_mean_jk, q6full_mean_karnataka, q6full_mean_kerala, q6full_mean_ladakh, q6full_mean_lakshadweep, q6full_mean_maharashtra, q6full_mean_manipur, q6full_mean_meghalaya, q6full_mean_mizoram, q6full_mean_mp, q6full_mean_nagaland, q6full_mean_none, q6full_mean_odisha, q6full_mean_puducherry, q6full_mean_punjab, q6full_mean_rajasthan, q6full_mean_sikkim, q6full_mean_telangana, q6full_mean_tn, q6full_mean_tripura, q6full_mean_up, q6full_mean_uttarakhand, q6full_mean_wb)


q6full_plot_labels <- c("AN", "AP", "AR", "AS", "BR", "CH", "CG", "DL", "DNH & DD", "GA", "GJ", "HR", "HP", "JH", "JK", "KA", "KL", "LA", "LD", "MH", "MN", "ML", "MZ", "MP", "NL", "None", "OR", "PY", "PB", "RJ", "SK", "TG", "TN", "TR", "UP", "UK", "WB")

q6full_plot_dta <- data.frame (q6full_plot, q6full_plot_labels) 
q6full_plot_dta$wrapped_labels = str_wrap(q6full_plot_dta$q6full_plot_labels, width = 10)
q6full_plot <- ggplot(q6full_plot_dta, aes(x=q6full_plot_labels, y=q6full_plot, fill = q6full_plot_labels)) +
  geom_bar(stat="identity", width= 1, show.legend = FALSE) + 
 geom_text(aes(label=paste0(sprintf("%0.2f", q6full_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,40)) +
  scale_x_discrete(labels = function(q6full_plot_labels) str_wrap(q6full_plot_labels, width = 30)) +
  labs(x="",y="Percent")+
  newtheme
q6full_plot      
```
\newpage
## Question 6: Aggregate Graph: Accounting for Officers' Bias 

Please select one State that you think has been under-appreciated for its success in pandemic management. (States selected in previous answers can be repeated)  

117 officers out of 452 felt that their own state was under-appreciated for its successful pandemic management. These officers may be biased in their response. The following graph excludes all biased responses for question 6.

\vspace{6mm}
```{r, echo = FALSE, fig.height=10,fig.width=18, warning=FALSE}
q6full_mean_anislands <- round(weighted.mean(summary_q6_unbiased$q6_anislands, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_andhra <- round(weighted.mean(summary_q6_unbiased$q6_andhra, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_arunachal <- round(weighted.mean(summary_q6_unbiased$q6_arunachal, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_assam <- round(weighted.mean(summary_q6_unbiased$q6_assam, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_bihar <- round(weighted.mean(summary_q6_unbiased$q6_bihar, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_chandigarh <- round(weighted.mean(summary_q6_unbiased$q6_chandigarh, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_chhattisgarh <- round(weighted.mean(summary_q6_unbiased$q6_chhattisgarh, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_dnhdd <- round(weighted.mean(summary_q6_unbiased$q6_dnhdd, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_goa <- round(weighted.mean(summary_q6_unbiased$q6_goa, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_gujarat <- round(weighted.mean(summary_q6_unbiased$q6_gujarat, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_haryana <- round(weighted.mean(summary_q6_unbiased$q6_haryana, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_hp <- round(weighted.mean(summary_q6_unbiased$q6_hp, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_jk <- round(weighted.mean(summary_q6_unbiased$q6_jk, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_jharkhand <- round(weighted.mean(summary_q6_unbiased$q6_jharkhand, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_karnataka <- round(weighted.mean(summary_q6_unbiased$q6_karnataka, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_kerala <- round(weighted.mean(summary_q6_unbiased$q6_kerala, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_ladakh <- round(weighted.mean(summary_q6_unbiased$q6_ladakh, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_lakshadweep <- round(weighted.mean(summary_q6_unbiased$q6_lakshadweep, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_mp <- round(weighted.mean(summary_q6_unbiased$q6_mp, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_maharashtra <- round(weighted.mean(summary_q6_unbiased$q6_maharashtra, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_manipur <- round(weighted.mean(summary_q6_unbiased$q6_manipur, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_meghalaya <- round(weighted.mean(summary_q6_unbiased$q6_meghalaya, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_mizoram <- round(weighted.mean(summary_q6_unbiased$q6_mizoram, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_nagaland <- round(weighted.mean(summary_q6_unbiased$q6_nagaland, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_delhi <- round(weighted.mean(summary_q6_unbiased$q6_delhi, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_none <- round(weighted.mean(summary_q6_unbiased$q6_none, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_odisha <- round(weighted.mean(summary_q6_unbiased$q6_odisha, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_puducherry <- round(weighted.mean(summary_q6_unbiased$q6_puducherry, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_punjab <- round(weighted.mean(summary_q6_unbiased$q6_punjab, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_rajasthan <- round(weighted.mean(summary_q6_unbiased$q6_rajasthan, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_sikkim <- round(weighted.mean(summary_q6_unbiased$q6_sikkim, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_tn <- round(weighted.mean(summary_q6_unbiased$q6_tn, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_telangana <- round(weighted.mean(summary_q6_unbiased$q6_telangana, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_tripura <- round(weighted.mean(summary_q6_unbiased$q6_tripura, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_up <- round(weighted.mean(summary_q6_unbiased$q6_up, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_uttarakhand <- round(weighted.mean(summary_q6_unbiased$q6_uttarakhand, summary_q6_unbiased$state_weight)*100,2)
q6full_mean_wb <- round(weighted.mean(summary_q6_unbiased$q6_wb, summary_q6_unbiased$state_weight)*100,2)

q6full_plot <- c(q6full_mean_anislands, q6full_mean_andhra, q6full_mean_arunachal, q6full_mean_assam, q6full_mean_bihar, q6full_mean_chandigarh, q6full_mean_chhattisgarh, q6full_mean_delhi, q6full_mean_dnhdd, q6full_mean_goa, q6full_mean_gujarat, q6full_mean_haryana, q6full_mean_hp, q6full_mean_jharkhand, q6full_mean_jk, q6full_mean_karnataka, q6full_mean_kerala, q6full_mean_ladakh, q6full_mean_lakshadweep, q6full_mean_maharashtra, q6full_mean_manipur, q6full_mean_meghalaya, q6full_mean_mizoram, q6full_mean_mp, q6full_mean_nagaland, q6full_mean_none, q6full_mean_odisha, q6full_mean_puducherry, q6full_mean_punjab, q6full_mean_rajasthan, q6full_mean_sikkim, q6full_mean_telangana, q6full_mean_tn, q6full_mean_tripura, q6full_mean_up, q6full_mean_uttarakhand, q6full_mean_wb)


q6full_plot_labels <- c("AN", "AP", "AR", "AS", "BR", "CH", "CG", "DL", "DNH & DD", "GA", "GJ", "HR", "HP", "JH", "JK", "KA", "KL", "LA", "LD", "MH", "MN", "ML", "MZ", "MP", "NL", "None", "OR", "PY", "PB", "RJ", "SK", "TG", "TN", "TR", "UP", "UK", "WB")

q6full_plot_dta <- data.frame (q6full_plot, q6full_plot_labels) 
q6full_plot_dta$wrapped_labels = str_wrap(q6full_plot_dta$q6full_plot_labels, width = 10)
q6full_plot <- ggplot(q6full_plot_dta, aes(x=q6full_plot_labels, y=q6full_plot, fill = q6full_plot_labels)) +
  geom_bar(stat="identity", width= 1, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q6full_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,40)) +
  scale_x_discrete(labels = function(q6full_plot_labels) str_wrap(q6full_plot_labels, width = 30)) +
  labs(x="",y="Percent")+
  newtheme
q6full_plot      
```
\newpage

## Question 6: Disaggregated by Age

Please select one State that you think has been under-appreciated for its success in pandemic management. (States selected in previous answers can be repeated)  

\vspace{6mm}
```{r, echo = FALSE, fig.height=20,fig.width=18, warning=FALSE}
#Age
q6young_mean_anislands <- round(weighted.mean(summary_q6_young$q6_anislands, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_andhra <- round(weighted.mean(summary_q6_young$q6_andhra, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_arunachal <- round(weighted.mean(summary_q6_young$q6_arunachal, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_assam <- round(weighted.mean(summary_q6_young$q6_assam, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_bihar <- round(weighted.mean(summary_q6_young$q6_bihar, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_chandigarh <- round(weighted.mean(summary_q6_young$q6_chandigarh, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_chhattisgarh <- round(weighted.mean(summary_q6_young$q6_chhattisgarh, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_dnhdd <- round(weighted.mean(summary_q6_young$q6_dnhdd, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_goa <- round(weighted.mean(summary_q6_young$q6_goa, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_gujarat <- round(weighted.mean(summary_q6_young$q6_gujarat, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_haryana <- round(weighted.mean(summary_q6_young$q6_haryana, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_hp <- round(weighted.mean(summary_q6_young$q6_hp, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_jk <- round(weighted.mean(summary_q6_young$q6_jk, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_jharkhand <- round(weighted.mean(summary_q6_young$q6_jharkhand, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_karnataka <- round(weighted.mean(summary_q6_young$q6_karnataka, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_kerala <- round(weighted.mean(summary_q6_young$q6_kerala, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_ladakh <- round(weighted.mean(summary_q6_young$q6_ladakh, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_lakshadweep <- round(weighted.mean(summary_q6_young$q6_lakshadweep, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_mp <- round(weighted.mean(summary_q6_young$q6_mp, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_maharashtra <- round(weighted.mean(summary_q6_young$q6_maharashtra, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_manipur <- round(weighted.mean(summary_q6_young$q6_manipur, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_meghalaya <- round(weighted.mean(summary_q6_young$q6_meghalaya, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_mizoram <- round(weighted.mean(summary_q6_young$q6_mizoram, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_nagaland <- round(weighted.mean(summary_q6_young$q6_nagaland, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_delhi <- round(weighted.mean(summary_q6_young$q6_delhi, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_none <- round(weighted.mean(summary_q6_young$q6_none, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_odisha <- round(weighted.mean(summary_q6_young$q6_odisha, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_puducherry <- round(weighted.mean(summary_q6_young$q6_puducherry, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_punjab <- round(weighted.mean(summary_q6_young$q6_punjab, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_rajasthan <- round(weighted.mean(summary_q6_young$q6_rajasthan, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_sikkim <- round(weighted.mean(summary_q6_young$q6_sikkim, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_tn <- round(weighted.mean(summary_q6_young$q6_tn, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_telangana <- round(weighted.mean(summary_q6_young$q6_telangana, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_tripura <- round(weighted.mean(summary_q6_young$q6_tripura, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_up <- round(weighted.mean(summary_q6_young$q6_up, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_uttarakhand <- round(weighted.mean(summary_q6_young$q6_uttarakhand, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_wb <- round(weighted.mean(summary_q6_young$q6_wb, summary_q6_young$state_young_weight, na.rm = TRUE)*100,2)

q6young_plot <- c(q6young_mean_anislands, q6young_mean_andhra, q6young_mean_arunachal, q6young_mean_assam, q6young_mean_bihar, q6young_mean_chandigarh, q6young_mean_chhattisgarh, q6young_mean_delhi, q6young_mean_dnhdd, q6young_mean_goa, q6young_mean_gujarat, q6young_mean_haryana, q6young_mean_hp, q6young_mean_jharkhand, q6young_mean_jk, q6young_mean_karnataka, q6young_mean_kerala, q6young_mean_ladakh, q6young_mean_lakshadweep, q6young_mean_maharashtra, q6young_mean_manipur, q6young_mean_meghalaya, q6young_mean_mizoram, q6young_mean_mp, q6young_mean_nagaland, q6young_mean_none, q6young_mean_odisha, q6young_mean_puducherry, q6young_mean_punjab, q6young_mean_rajasthan, q6young_mean_sikkim, q6young_mean_telangana, q6young_mean_tn, q6young_mean_tripura, q6young_mean_up, q6young_mean_uttarakhand, q6young_mean_wb)

q6young_plot_labels <- c("AN", "AP", "AR", "AS", "BR", "CH", "CG", "DL", "DNH & DD", "GA", "GJ", "HR", "HP", "JH", "JK", "KA", "KL", "LA", "LD", "MH", "MN", "ML", "MZ", "MP", "NL", "None", "OR", "PY", "PB", "RJ", "SK", "TG", "TN", "TR", "UP", "UK", "WB")

q6young_plot_dta <- data.frame (q6young_plot, q6young_plot_labels) 
q6young_plot_dta$wrapped_labels = str_wrap(q6young_plot_dta$q6young_plot_labels, width = 10)
q6young_plot <- ggplot(q6young_plot_dta, aes(x=q6young_plot_labels, y=q6young_plot, fill = q6young_plot_labels)) +
  geom_bar(stat="identity", width= 1, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q6young_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,40)) +
  scale_x_discrete(labels = function(q6young_plot_labels) str_wrap(q6young_plot_labels, width = 30)) +
  labs(x="",y="Percent", title = "2012 and After")+
  newtheme

q6old_mean_anislands <- round(weighted.mean(summary_q6_old$q6_anislands, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_andhra <- round(weighted.mean(summary_q6_old$q6_andhra, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_arunachal <- round(weighted.mean(summary_q6_old$q6_arunachal, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_assam <- round(weighted.mean(summary_q6_old$q6_assam, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_bihar <- round(weighted.mean(summary_q6_old$q6_bihar, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_chandigarh <- round(weighted.mean(summary_q6_old$q6_chandigarh, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_chhattisgarh <- round(weighted.mean(summary_q6_old$q6_chhattisgarh, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_dnhdd <- round(weighted.mean(summary_q6_old$q6_dnhdd, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_goa <- round(weighted.mean(summary_q6_old$q6_goa, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_gujarat <- round(weighted.mean(summary_q6_old$q6_gujarat, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_haryana <- round(weighted.mean(summary_q6_old$q6_haryana, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_hp <- round(weighted.mean(summary_q6_old$q6_hp, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_jk <- round(weighted.mean(summary_q6_old$q6_jk, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_jharkhand <- round(weighted.mean(summary_q6_old$q6_jharkhand, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_karnataka <- round(weighted.mean(summary_q6_old$q6_karnataka, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_kerala <- round(weighted.mean(summary_q6_old$q6_kerala, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_ladakh <- round(weighted.mean(summary_q6_old$q6_ladakh, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_lakshadweep <- round(weighted.mean(summary_q6_old$q6_lakshadweep, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_mp <- round(weighted.mean(summary_q6_old$q6_mp, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_maharashtra <- round(weighted.mean(summary_q6_old$q6_maharashtra, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_manipur <- round(weighted.mean(summary_q6_old$q6_manipur, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_meghalaya <- round(weighted.mean(summary_q6_old$q6_meghalaya, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_mizoram <- round(weighted.mean(summary_q6_old$q6_mizoram, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_nagaland <- round(weighted.mean(summary_q6_old$q6_nagaland, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_delhi <- round(weighted.mean(summary_q6_old$q6_delhi, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_none <- round(weighted.mean(summary_q6_old$q6_none, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_odisha <- round(weighted.mean(summary_q6_old$q6_odisha, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_puducherry <- round(weighted.mean(summary_q6_old$q6_puducherry, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_punjab <- round(weighted.mean(summary_q6_old$q6_punjab, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_rajasthan <- round(weighted.mean(summary_q6_old$q6_rajasthan, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_sikkim <- round(weighted.mean(summary_q6_old$q6_sikkim, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_tn <- round(weighted.mean(summary_q6_old$q6_tn, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_telangana <- round(weighted.mean(summary_q6_old$q6_telangana, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_tripura <- round(weighted.mean(summary_q6_old$q6_tripura, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_up <- round(weighted.mean(summary_q6_old$q6_up, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_uttarakhand <- round(weighted.mean(summary_q6_old$q6_uttarakhand, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_wb <- round(weighted.mean(summary_q6_old$q6_wb, summary_q6_old$state_old_weight, na.rm = TRUE)*100,2)

q6old_plot <- c(q6old_mean_anislands, q6old_mean_andhra, q6old_mean_arunachal, q6old_mean_assam, q6old_mean_bihar, q6old_mean_chandigarh, q6old_mean_chhattisgarh, q6old_mean_delhi, q6old_mean_dnhdd, q6old_mean_goa, q6old_mean_gujarat, q6old_mean_haryana, q6old_mean_hp, q6old_mean_jharkhand, q6old_mean_jk, q6old_mean_karnataka, q6old_mean_kerala, q6old_mean_ladakh, q6old_mean_lakshadweep, q6old_mean_maharashtra, q6old_mean_manipur, q6old_mean_meghalaya, q6old_mean_mizoram, q6old_mean_mp, q6old_mean_nagaland, q6old_mean_none, q6old_mean_odisha, q6old_mean_puducherry, q6old_mean_punjab, q6old_mean_rajasthan, q6old_mean_sikkim, q6old_mean_telangana, q6old_mean_tn, q6old_mean_tripura, q6old_mean_up, q6old_mean_uttarakhand, q6old_mean_wb)

q6old_plot_labels <- c("AN", "AP", "AR", "AS", "BR", "CH", "CG", "DL", "DNH & DD", "GA", "GJ", "HR", "HP", "JH", "JK", "KA", "KL", "LA", "LD", "MH", "MN", "ML", "MZ", "MP", "NL", "None", "OR", "PY", "PB", "RJ", "SK", "TG", "TN", "TR", "UP", "UK", "WB")

q6old_plot_dta <- data.frame (q6old_plot, q6old_plot_labels) 
q6old_plot_dta$wrapped_labels = str_wrap(q6old_plot_dta$q6old_plot_labels, width = 10)
q6old_plot <- ggplot(q6old_plot_dta, aes(x=q6old_plot_labels, y=q6old_plot, fill = q6old_plot_labels)) +
  geom_bar(stat="identity", width= 1, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q6old_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,40)) +
  scale_x_discrete(labels = function(q6old_plot_labels) str_wrap(q6old_plot_labels, width = 30)) +
  labs(x="",y="Percent", title = "2011 and Before")+
  newtheme

q6former_mean_anislands <- summary_q6_former$q6_anislands*100
q6former_mean_andhra <- summary_q6_former$q6_andhra*100
q6former_mean_arunachal <- summary_q6_former$q6_arunachal*100
q6former_mean_assam <- summary_q6_former$q6_assam*100
q6former_mean_bihar <- summary_q6_former$q6_bihar*100
q6former_mean_chandigarh <- summary_q6_former$q6_chandigarh*100
q6former_mean_chhattisgarh <- summary_q6_former$q6_chhattisgarh*100
q6former_mean_delhi <- summary_q6_former$q6_delhi*100
q6former_mean_dnhdd <- summary_q6_former$q6_dnhdd*100
q6former_mean_goa <- summary_q6_former$q6_goa*100
q6former_mean_gujarat <- summary_q6_former$q6_gujarat*100
q6former_mean_haryana <- summary_q6_former$q6_haryana*100
q6former_mean_hp <- summary_q6_former$q6_hp*100
q6former_mean_jharkhand <- summary_q6_former$q6_jharkhand*100
q6former_mean_jk <- summary_q6_former$q6_jk*100
q6former_mean_karnataka <- summary_q6_former$q6_karnataka*100
q6former_mean_kerala <- summary_q6_former$q6_kerala*100
q6former_mean_lakshadweep <- summary_q6_former$q6_lakshadweep*100
q6former_mean_ladakh <- summary_q6_former$q6_ladakh*100
q6former_mean_maharashtra <- summary_q6_former$q6_maharashtra*100
q6former_mean_manipur <- summary_q6_former$q6_manipur*100
q6former_mean_meghalaya <- summary_q6_former$q6_meghalaya*100
q6former_mean_mizoram <- summary_q6_former$q6_mizoram*100
q6former_mean_mp <- summary_q6_former$q6_mp*100
q6former_mean_nagaland <- summary_q6_former$q6_nagaland*100
q6former_mean_none <- summary_q6_former$q6_none*100
q6former_mean_odisha <- summary_q6_former$q6_odisha*100
q6former_mean_puducherry <- summary_q6_former$q6_puducherry*100
q6former_mean_punjab <-summary_q6_former$q6_punjab*100
q6former_mean_rajasthan <- summary_q6_former$q6_rajasthan*100
q6former_mean_sikkim <- summary_q6_former$q6_sikkim*100
q6former_mean_telangana <- summary_q6_former$q6_telangana*100
q6former_mean_tn <- summary_q6_former$q6_tn*100
q6former_mean_tripura <- summary_q6_former$q6_tripura*100
q6former_mean_up <- summary_q6_former$q6_up*100
q6former_mean_uttarakhand <- summary_q6_former$q6_uttarakhand*100
q6former_mean_wb <- summary_q6_former$q6_wb*100


q6former_plot <- c(q6former_mean_anislands, q6former_mean_andhra, q6former_mean_arunachal, q6former_mean_assam, q6former_mean_bihar, q6former_mean_chandigarh, q6former_mean_chhattisgarh, q6former_mean_delhi, q6former_mean_dnhdd, q6former_mean_goa, q6former_mean_gujarat, q6former_mean_haryana, q6former_mean_hp, q6former_mean_jharkhand, q6former_mean_jk, q6former_mean_karnataka, q6former_mean_kerala, q6former_mean_ladakh, q6former_mean_lakshadweep, q6former_mean_maharashtra, q6former_mean_manipur, q6former_mean_meghalaya, q6former_mean_mizoram, q6former_mean_mp, q6former_mean_nagaland, q6former_mean_none, q6former_mean_odisha, q6former_mean_puducherry, q6former_mean_punjab, q6former_mean_rajasthan, q6former_mean_sikkim, q6former_mean_telangana, q6former_mean_tn, q6former_mean_tripura, q6former_mean_up, q6former_mean_uttarakhand, q6former_mean_wb)

q6former_plot_labels <- c("AN", "AP", "AR", "AS", "BR", "CH", "CG", "DL", "DNH & DD", "GA", "GJ", "HR", "HP", "JH", "JK", "KA", "KL", "LA", "LD", "MH", "MN", "ML", "MZ", "MP", "NL", "None", "OR", "PY", "PB", "RJ", "SK", "TG", "TN", "TR", "UP", "UK", "WB")

q6former_plot_dta <- data.frame (q6former_plot, q6former_plot_labels) 
q6former_plot_dta$wrapped_labels = str_wrap(q6former_plot_dta$q6former_plot_labels, width = 10)
q6former_plot <- ggplot(q6former_plot_dta, aes(x=q6former_plot_labels, y=q6former_plot, fill = q6former_plot_labels)) +
  geom_bar(stat="identity", width= 1, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q6former_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,40)) +
  scale_x_discrete(labels = function(q6former_plot_labels) str_wrap(q6former_plot_labels, width = 30)) +
  labs(x="",y="Percent", title = "Former Officers")+
  newtheme
plot6_fullage <- plot_grid(q6young_plot,q6old_plot,q6former_plot, nrow=3)
plot6_fullage
```
\newpage

## Question 6: Disaggregated by Age: Accounting for Officers' Bias

Please select one State that you think has been under-appreciated for its success in pandemic management. (States selected in previous answers can be repeated)  

100 officers out of the 248 officers who joined the IAS in 2012 or later felt that their own state has been under-appreciated for its successful pandemic management. 71 of the 204 officers who joined the IAS in 2011 or before, and 24 former officers were similarly biased in their responses to this question. The following graphs exclude these biased responses. 

\vspace{6mm}
```{r, echo = FALSE, fig.height=20,fig.width=18, warning=FALSE}
#Age
q6young_mean_anislands <- round(weighted.mean(summary_q6_young_unbiased$q6_anislands, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_andhra <- round(weighted.mean(summary_q6_young_unbiased$q6_andhra, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_arunachal <- round(weighted.mean(summary_q6_young_unbiased$q6_arunachal, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_assam <- round(weighted.mean(summary_q6_young_unbiased$q6_assam, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_bihar <- round(weighted.mean(summary_q6_young_unbiased$q6_bihar, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_chandigarh <- round(weighted.mean(summary_q6_young_unbiased$q6_chandigarh, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_chhattisgarh <- round(weighted.mean(summary_q6_young_unbiased$q6_chhattisgarh, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_dnhdd <- round(weighted.mean(summary_q6_young_unbiased$q6_dnhdd, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_goa <- round(weighted.mean(summary_q6_young_unbiased$q6_goa, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_gujarat <- round(weighted.mean(summary_q6_young_unbiased$q6_gujarat, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_haryana <- round(weighted.mean(summary_q6_young_unbiased$q6_haryana, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_hp <- round(weighted.mean(summary_q6_young_unbiased$q6_hp, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_jk <- round(weighted.mean(summary_q6_young_unbiased$q6_jk, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_jharkhand <- round(weighted.mean(summary_q6_young_unbiased$q6_jharkhand, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_karnataka <- round(weighted.mean(summary_q6_young_unbiased$q6_karnataka, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_kerala <- round(weighted.mean(summary_q6_young_unbiased$q6_kerala, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_ladakh <- round(weighted.mean(summary_q6_young_unbiased$q6_ladakh, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_lakshadweep <- round(weighted.mean(summary_q6_young_unbiased$q6_lakshadweep, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_mp <- round(weighted.mean(summary_q6_young_unbiased$q6_mp, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_maharashtra <- round(weighted.mean(summary_q6_young_unbiased$q6_maharashtra, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_manipur <- round(weighted.mean(summary_q6_young_unbiased$q6_manipur, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_meghalaya <- round(weighted.mean(summary_q6_young_unbiased$q6_meghalaya, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_mizoram <- round(weighted.mean(summary_q6_young_unbiased$q6_mizoram, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_nagaland <- round(weighted.mean(summary_q6_young_unbiased$q6_nagaland, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_delhi <- round(weighted.mean(summary_q6_young_unbiased$q6_delhi, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_none <- round(weighted.mean(summary_q6_young_unbiased$q6_none, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_odisha <- round(weighted.mean(summary_q6_young_unbiased$q6_odisha, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_puducherry <- round(weighted.mean(summary_q6_young_unbiased$q6_puducherry, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_punjab <- round(weighted.mean(summary_q6_young_unbiased$q6_punjab, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_rajasthan <- round(weighted.mean(summary_q6_young_unbiased$q6_rajasthan, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_sikkim <- round(weighted.mean(summary_q6_young_unbiased$q6_sikkim, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_tn <- round(weighted.mean(summary_q6_young_unbiased$q6_tn, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_telangana <- round(weighted.mean(summary_q6_young_unbiased$q6_telangana, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_tripura <- round(weighted.mean(summary_q6_young_unbiased$q6_tripura, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_up <- round(weighted.mean(summary_q6_young_unbiased$q6_up, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_uttarakhand <- round(weighted.mean(summary_q6_young_unbiased$q6_uttarakhand, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)
q6young_mean_wb <- round(weighted.mean(summary_q6_young_unbiased$q6_wb, summary_q6_young_unbiased$state_young_weight, na.rm = TRUE)*100,2)

q6young_plot <- c(q6young_mean_anislands, q6young_mean_andhra, q6young_mean_arunachal, q6young_mean_assam, q6young_mean_bihar, q6young_mean_chandigarh, q6young_mean_chhattisgarh, q6young_mean_delhi, q6young_mean_dnhdd, q6young_mean_goa, q6young_mean_gujarat, q6young_mean_haryana, q6young_mean_hp, q6young_mean_jharkhand, q6young_mean_jk, q6young_mean_karnataka, q6young_mean_kerala, q6young_mean_ladakh, q6young_mean_lakshadweep, q6young_mean_maharashtra, q6young_mean_manipur, q6young_mean_meghalaya, q6young_mean_mizoram, q6young_mean_mp, q6young_mean_nagaland, q6young_mean_none, q6young_mean_odisha, q6young_mean_puducherry, q6young_mean_punjab, q6young_mean_rajasthan, q6young_mean_sikkim, q6young_mean_telangana, q6young_mean_tn, q6young_mean_tripura, q6young_mean_up, q6young_mean_uttarakhand, q6young_mean_wb)

q6young_plot_labels <- c("AN", "AP", "AR", "AS", "BR", "CH", "CG", "DL", "DNH & DD", "GA", "GJ", "HR", "HP", "JH", "JK", "KA", "KL", "LA", "LD", "MH", "MN", "ML", "MZ", "MP", "NL", "None", "OR", "PY", "PB", "RJ", "SK", "TG", "TN", "TR", "UP", "UK", "WB")

q6young_plot_dta <- data.frame (q6young_plot, q6young_plot_labels) 
q6young_plot_dta$wrapped_labels = str_wrap(q6young_plot_dta$q6young_plot_labels, width = 10)
q6young_plot <- ggplot(q6young_plot_dta, aes(x=q6young_plot_labels, y=q6young_plot, fill = q6young_plot_labels)) +
  geom_bar(stat="identity", width= 1, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q6young_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,40)) +
  scale_x_discrete(labels = function(q6young_plot_labels) str_wrap(q6young_plot_labels, width = 30)) +
  labs(x="",y="Percent", title = "2012 and After")+
  newtheme

q6old_mean_anislands <- round(weighted.mean(summary_q6_old_unbiased$q6_anislands, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_andhra <- round(weighted.mean(summary_q6_old_unbiased$q6_andhra, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_arunachal <- round(weighted.mean(summary_q6_old_unbiased$q6_arunachal, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_assam <- round(weighted.mean(summary_q6_old_unbiased$q6_assam, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_bihar <- round(weighted.mean(summary_q6_old_unbiased$q6_bihar, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_chandigarh <- round(weighted.mean(summary_q6_old_unbiased$q6_chandigarh, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_chhattisgarh <- round(weighted.mean(summary_q6_old_unbiased$q6_chhattisgarh, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_dnhdd <- round(weighted.mean(summary_q6_old_unbiased$q6_dnhdd, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_goa <- round(weighted.mean(summary_q6_old_unbiased$q6_goa, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_gujarat <- round(weighted.mean(summary_q6_old_unbiased$q6_gujarat, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_haryana <- round(weighted.mean(summary_q6_old_unbiased$q6_haryana, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_hp <- round(weighted.mean(summary_q6_old_unbiased$q6_hp, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_jk <- round(weighted.mean(summary_q6_old_unbiased$q6_jk, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_jharkhand <- round(weighted.mean(summary_q6_old_unbiased$q6_jharkhand, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_karnataka <- round(weighted.mean(summary_q6_old_unbiased$q6_karnataka, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_kerala <- round(weighted.mean(summary_q6_old_unbiased$q6_kerala, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_ladakh <- round(weighted.mean(summary_q6_old_unbiased$q6_ladakh, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_lakshadweep <- round(weighted.mean(summary_q6_old_unbiased$q6_lakshadweep, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_mp <- round(weighted.mean(summary_q6_old_unbiased$q6_mp, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_maharashtra <- round(weighted.mean(summary_q6_old_unbiased$q6_maharashtra, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_manipur <- round(weighted.mean(summary_q6_old_unbiased$q6_manipur, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_meghalaya <- round(weighted.mean(summary_q6_old_unbiased$q6_meghalaya, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_mizoram <- round(weighted.mean(summary_q6_old_unbiased$q6_mizoram, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_nagaland <- round(weighted.mean(summary_q6_old_unbiased$q6_nagaland, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_delhi <- round(weighted.mean(summary_q6_old_unbiased$q6_delhi, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_none <- round(weighted.mean(summary_q6_old_unbiased$q6_none, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_odisha <- round(weighted.mean(summary_q6_old_unbiased$q6_odisha, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_puducherry <- round(weighted.mean(summary_q6_old_unbiased$q6_puducherry, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_punjab <- round(weighted.mean(summary_q6_old_unbiased$q6_punjab, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_rajasthan <- round(weighted.mean(summary_q6_old_unbiased$q6_rajasthan, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_sikkim <- round(weighted.mean(summary_q6_old_unbiased$q6_sikkim, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_tn <- round(weighted.mean(summary_q6_old_unbiased$q6_tn, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_telangana <- round(weighted.mean(summary_q6_old_unbiased$q6_telangana, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_tripura <- round(weighted.mean(summary_q6_old_unbiased$q6_tripura, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_up <- round(weighted.mean(summary_q6_old_unbiased$q6_up, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_uttarakhand <- round(weighted.mean(summary_q6_old_unbiased$q6_uttarakhand, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)
q6old_mean_wb <- round(weighted.mean(summary_q6_old_unbiased$q6_wb, summary_q6_old_unbiased$state_old_weight, na.rm = TRUE)*100,2)

q6old_plot <- c(q6old_mean_anislands, q6old_mean_andhra, q6old_mean_arunachal, q6old_mean_assam, q6old_mean_bihar, q6old_mean_chandigarh, q6old_mean_chhattisgarh, q6old_mean_delhi, q6old_mean_dnhdd, q6old_mean_goa, q6old_mean_gujarat, q6old_mean_haryana, q6old_mean_hp, q6old_mean_jharkhand, q6old_mean_jk, q6old_mean_karnataka, q6old_mean_kerala, q6old_mean_ladakh, q6old_mean_lakshadweep, q6old_mean_maharashtra, q6old_mean_manipur, q6old_mean_meghalaya, q6old_mean_mizoram, q6old_mean_mp, q6old_mean_nagaland, q6old_mean_none, q6old_mean_odisha, q6old_mean_puducherry, q6old_mean_punjab, q6old_mean_rajasthan, q6old_mean_sikkim, q6old_mean_telangana, q6old_mean_tn, q6old_mean_tripura, q6old_mean_up, q6old_mean_uttarakhand, q6old_mean_wb)

q6old_plot_labels <- c("AN", "AP", "AR", "AS", "BR", "CH", "CG", "DL", "DNH & DD", "GA", "GJ", "HR", "HP", "JH", "JK", "KA", "KL", "LA", "LD", "MH", "MN", "ML", "MZ", "MP", "NL", "None", "OR", "PY", "PB", "RJ", "SK", "TG", "TN", "TR", "UP", "UK", "WB")

q6old_plot_dta <- data.frame (q6old_plot, q6old_plot_labels) 
q6old_plot_dta$wrapped_labels = str_wrap(q6old_plot_dta$q6old_plot_labels, width = 10)
q6old_plot <- ggplot(q6old_plot_dta, aes(x=q6old_plot_labels, y=q6old_plot, fill = q6old_plot_labels)) +
  geom_bar(stat="identity", width= 1, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q6old_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,40)) +
  scale_x_discrete(labels = function(q6old_plot_labels) str_wrap(q6old_plot_labels, width = 30)) +
  labs(x="",y="Percent", title = "2011 and Before")+
  newtheme

q6former_mean_anislands <- summary_q6_former_unbiased$q6_anislands*100
q6former_mean_andhra <- summary_q6_former_unbiased$q6_andhra*100
q6former_mean_arunachal <- summary_q6_former_unbiased$q6_arunachal*100
q6former_mean_assam <- summary_q6_former_unbiased$q6_assam*100
q6former_mean_bihar <- summary_q6_former_unbiased$q6_bihar*100
q6former_mean_chandigarh <- summary_q6_former_unbiased$q6_chandigarh*100
q6former_mean_chhattisgarh <- summary_q6_former_unbiased$q6_chhattisgarh*100
q6former_mean_delhi <- summary_q6_former_unbiased$q6_delhi*100
q6former_mean_dnhdd <- summary_q6_former_unbiased$q6_dnhdd*100
q6former_mean_goa <- summary_q6_former_unbiased$q6_goa*100
q6former_mean_gujarat <- summary_q6_former_unbiased$q6_gujarat*100
q6former_mean_haryana <- summary_q6_former_unbiased$q6_haryana*100
q6former_mean_hp <- summary_q6_former_unbiased$q6_hp*100
q6former_mean_jharkhand <- summary_q6_former_unbiased$q6_jharkhand*100
q6former_mean_jk <- summary_q6_former_unbiased$q6_jk*100
q6former_mean_karnataka <- summary_q6_former_unbiased$q6_karnataka*100
q6former_mean_kerala <- summary_q6_former_unbiased$q6_kerala*100
q6former_mean_lakshadweep <- summary_q6_former_unbiased$q6_lakshadweep*100
q6former_mean_ladakh <- summary_q6_former_unbiased$q6_ladakh*100
q6former_mean_maharashtra <- summary_q6_former_unbiased$q6_maharashtra*100
q6former_mean_manipur <- summary_q6_former_unbiased$q6_manipur*100
q6former_mean_meghalaya <- summary_q6_former_unbiased$q6_meghalaya*100
q6former_mean_mizoram <- summary_q6_former_unbiased$q6_mizoram*100
q6former_mean_mp <- summary_q6_former_unbiased$q6_mp*100
q6former_mean_nagaland <- summary_q6_former_unbiased$q6_nagaland*100
q6former_mean_none <- summary_q6_former_unbiased$q6_none*100
q6former_mean_odisha <- summary_q6_former_unbiased$q6_odisha*100
q6former_mean_puducherry <- summary_q6_former_unbiased$q6_puducherry*100
q6former_mean_punjab <-summary_q6_former_unbiased$q6_punjab*100
q6former_mean_rajasthan <- summary_q6_former_unbiased$q6_rajasthan*100
q6former_mean_sikkim <- summary_q6_former_unbiased$q6_sikkim*100
q6former_mean_telangana <- summary_q6_former_unbiased$q6_telangana*100
q6former_mean_tn <- summary_q6_former_unbiased$q6_tn*100
q6former_mean_tripura <- summary_q6_former_unbiased$q6_tripura*100
q6former_mean_up <- summary_q6_former_unbiased$q6_up*100
q6former_mean_uttarakhand <- summary_q6_former_unbiased$q6_uttarakhand*100
q6former_mean_wb <- summary_q6_former_unbiased$q6_wb*100


q6former_plot <- c(q6former_mean_anislands, q6former_mean_andhra, q6former_mean_arunachal, q6former_mean_assam, q6former_mean_bihar, q6former_mean_chandigarh, q6former_mean_chhattisgarh, q6former_mean_delhi, q6former_mean_dnhdd, q6former_mean_goa, q6former_mean_gujarat, q6former_mean_haryana, q6former_mean_hp, q6former_mean_jharkhand, q6former_mean_jk, q6former_mean_karnataka, q6former_mean_kerala, q6former_mean_ladakh, q6former_mean_lakshadweep, q6former_mean_maharashtra, q6former_mean_manipur, q6former_mean_meghalaya, q6former_mean_mizoram, q6former_mean_mp, q6former_mean_nagaland, q6former_mean_none, q6former_mean_odisha, q6former_mean_puducherry, q6former_mean_punjab, q6former_mean_rajasthan, q6former_mean_sikkim, q6former_mean_telangana, q6former_mean_tn, q6former_mean_tripura, q6former_mean_up, q6former_mean_uttarakhand, q6former_mean_wb)

q6former_plot_labels <- c("AN", "AP", "AR", "AS", "BR", "CH", "CG", "DL", "DNH & DD", "GA", "GJ", "HR", "HP", "JH", "JK", "KA", "KL", "LA", "LD", "MH", "MN", "ML", "MZ", "MP", "NL", "None", "OR", "PY", "PB", "RJ", "SK", "TG", "TN", "TR", "UP", "UK", "WB")

q6former_plot_dta <- data.frame (q6former_plot, q6former_plot_labels) 
q6former_plot_dta$wrapped_labels = str_wrap(q6former_plot_dta$q6former_plot_labels, width = 10)
q6former_plot <- ggplot(q6former_plot_dta, aes(x=q6former_plot_labels, y=q6former_plot, fill = q6former_plot_labels)) +
  geom_bar(stat="identity", width= 1, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q6former_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,40)) +
  scale_x_discrete(labels = function(q6former_plot_labels) str_wrap(q6former_plot_labels, width = 30)) +
  labs(x="",y="Percent", title = "Former Officers")+
  newtheme
plot6_fullage <- plot_grid(q6young_plot,q6old_plot,q6former_plot, nrow=3)
plot6_fullage
```
\newpage

## Question 6: Disaggregated by SDG

Please select one State that you think has been under-appreciated for its success in pandemic management. (States selected in previous answers can be repeated)  

\vspace{6mm}
```{r, echo = FALSE, fig.height=20,fig.width=18, warning=FALSE}
summary_q6 <- summary_q6 %>% 
mutate (sdg_tier = ias_processed_dta$sdg)

#Calculating weighted means
##Aspirants
q6aspt_weighted_mean_anislands <- round(weighted.mean(summary_q6$q6_anislands[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_andhra <- round(weighted.mean(summary_q6$q6_andhra[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_arunachal <- round(weighted.mean(summary_q6$q6_arunachal[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_assam <- round(weighted.mean(summary_q6$q6_assam[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_bihar <- round(weighted.mean(summary_q6$q6_bihar[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_chandigarh <- round(weighted.mean(summary_q6$q6_chandigarh[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_chhattisgarh <- round(weighted.mean(summary_q6$q6_chhattisgarh[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_dnhdd <- round(weighted.mean(summary_q6$q6_dnhdd[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_goa <- round(weighted.mean(summary_q6$q6_goa[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_gujarat <- round(weighted.mean(summary_q6$q6_gujarat[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_haryana <-round(weighted.mean(summary_q6$q6_haryana[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_hp <- round(weighted.mean(summary_q6$q6_hp[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_jk <- round(weighted.mean(summary_q6$q6_jk[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_jharkhand <- round(weighted.mean(summary_q6$q6_jharkhand[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_karnataka <- round(weighted.mean(summary_q6$q6_karnataka[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_kerala <- round(weighted.mean(summary_q6$q6_kerala[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_ladakh <- round(weighted.mean(summary_q6$q6_ladakh[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_lakshadweep <- round(weighted.mean(summary_q6$q6_lakshadweep[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_mp <- round(weighted.mean(summary_q6$q6_mp[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_maharashtra <- round(weighted.mean(summary_q6$q6_maharashtra[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_manipur <- round(weighted.mean(summary_q6$q6_manipur[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_meghalaya <- round(weighted.mean(summary_q6$q6_meghalaya[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_mizoram <- round(weighted.mean(summary_q6$q6_mizoram[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_nagaland <- round(weighted.mean(summary_q6$q6_nagaland[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_delhi <- round(weighted.mean(summary_q6$q6_delhi[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_none <- round(weighted.mean(summary_q6$q6_none[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_odisha <- round(weighted.mean(summary_q6$q6_odisha[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_puducherry <- round(weighted.mean(summary_q6$q6_puducherry[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_punjab <- round(weighted.mean(summary_q6$q6_punjab[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_rajasthan <- round(weighted.mean(summary_q6$q6_rajasthan[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_sikkim <- round(weighted.mean(summary_q6$q6_sikkim[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_tn <- round(weighted.mean(summary_q6$q6_tn[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_telangana <- round(weighted.mean(summary_q6$q6_telangana[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_tripura <- round(weighted.mean(summary_q6$q6_tripura[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_up <- round(weighted.mean(summary_q6$q6_up[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_uttarakhand <- round(weighted.mean(summary_q6$q6_uttarakhand[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_wb <- round(weighted.mean(summary_q6$q6_wb[summary_q6$sdg_tier=="Aspirant"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Aspirant"])*100,2)

##Performers
q6perf_weighted_mean_anislands <- round(weighted.mean(summary_q6$q6_anislands[summary_q6$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_andhra <- round(weighted.mean(summary_q6$q6_andhra[summary_q6$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_arunachal <- round(weighted.mean(summary_q6$q6_arunachal[summary_q6$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_assam <- round(weighted.mean(summary_q6$q6_assam[summary_q6$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_bihar <- round(weighted.mean(summary_q6$q6_bihar[summary_q6$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_chandigarh <- round(weighted.mean(summary_q6$q6_chandigarh[summary_q6$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_chhattisgarh <- round(weighted.mean(summary_q6$q6_chhattisgarh[summary_q6$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_dnhdd <- round(weighted.mean(summary_q6$q6_dnhdd[summary_q6$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_goa <- round(weighted.mean(summary_q6$q6_goa[summary_q6$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_gujarat <- round(weighted.mean(summary_q6$q6_gujarat[summary_q6$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_haryana <- round(weighted.mean(summary_q6$q6_haryana[summary_q6$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_hp <- round(weighted.mean(summary_q6$q6_hp[summary_q6$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_jk <- round(weighted.mean(summary_q6$q6_jk[summary_q6$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_jharkhand <- round(weighted.mean(summary_q6$q6_jharkhand[summary_q6$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_karnataka <- round(weighted.mean(summary_q6$q6_karnataka[summary_q6$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_kerala <- round(weighted.mean(summary_q6$q6_kerala[summary_q6$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_ladakh <- round(weighted.mean(summary_q6$q6_ladakh[summary_q6$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_lakshadweep <- round(weighted.mean(summary_q6$q6_lakshadweep[summary_q6$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_mp <- round(weighted.mean(summary_q6$q6_mp[summary_q6$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_maharashtra <- round(weighted.mean(summary_q6$q6_maharashtra[summary_q6$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_manipur <- round(weighted.mean(summary_q6$q6_manipur[summary_q6$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_meghalaya <- round(weighted.mean(summary_q6$q6_meghalaya[summary_q6$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_mizoram <- round(weighted.mean(summary_q6$q6_mizoram[summary_q6$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_nagaland <- round(weighted.mean(summary_q6$q6_nagaland[summary_q6$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_delhi <- round(weighted.mean(summary_q6$q6_delhi[summary_q5$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_none <- round(weighted.mean(summary_q6$q6_none[summary_q5$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_odisha <- round(weighted.mean(summary_q6$q6_odisha[summary_q5$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_puducherry <- round(weighted.mean(summary_q6$q6_puducherry[summary_q5$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_punjab <- round(weighted.mean(summary_q6$q6_punjab[summary_q5$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_rajasthan <- round(weighted.mean(summary_q6$q6_rajasthan[summary_q5$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_sikkim <- round(weighted.mean(summary_q6$q6_sikkim[summary_q5$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_tn <- round(weighted.mean(summary_q6$q6_tn[summary_q5$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_telangana <- round(weighted.mean(summary_q6$q6_telangana[summary_q5$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_tripura <- round(weighted.mean(summary_q6$q6_tripura[summary_q5$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_up <- round(weighted.mean(summary_q6$q6_up[summary_q5$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_uttarakhand <- round(weighted.mean(summary_q6$q6_uttarakhand[summary_q5$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_wb <- round(weighted.mean(summary_q6$q6_wb[summary_q6$sdg_tier=="Performer"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Performer"])*100,2)

##Frontrunner
q6frnt_weighted_mean_anislands <- round(weighted.mean(summary_q6$q6_anislands[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_andhra <- round(weighted.mean(summary_q6$q6_andhra[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_arunachal <- round(weighted.mean(summary_q6$q6_arunachal[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_assam <- round(weighted.mean(summary_q6$q6_assam[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_bihar <- round(weighted.mean(summary_q6$q6_bihar[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_chandigarh <- round(weighted.mean(summary_q6$q6_chandigarh[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_chhattisgarh <- round(weighted.mean(summary_q6$q6_chhattisgarh[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_dnhdd <- round(weighted.mean(summary_q6$q6_dnhdd[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_goa <- round(weighted.mean(summary_q6$q6_goa[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_gujarat <- round(weighted.mean(summary_q6$q6_gujarat[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_haryana <- round(weighted.mean(summary_q6$q6_haryana[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_hp <- round(weighted.mean(summary_q6$q6_hp[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_jk <- round(weighted.mean(summary_q6$q6_jk[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_jharkhand <- round(weighted.mean(summary_q6$q6_jharkhand[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_karnataka <- round(weighted.mean(summary_q6$q6_karnataka[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_kerala <- round(weighted.mean(summary_q6$q6_kerala[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_ladakh <- round(weighted.mean(summary_q6$q6_ladakh[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_lakshadweep <- round(weighted.mean(summary_q6$q6_lakshadweep[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_mp <- round(weighted.mean(summary_q6$q6_mp[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_maharashtra <- round(weighted.mean(summary_q6$q6_maharashtra[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_manipur <- round(weighted.mean(summary_q6$q6_manipur[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_meghalaya <- round(weighted.mean(summary_q6$q6_meghalaya[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_mizoram <- round(weighted.mean(summary_q6$q6_mizoram[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_nagaland <- round(weighted.mean(summary_q6$q6_nagaland[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_delhi <- round(weighted.mean(summary_q6$q6_delhi[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_none <- round(weighted.mean(summary_q6$q6_none[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_odisha <- round(weighted.mean(summary_q6$q6_odisha[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_puducherry <- round(weighted.mean(summary_q6$q6_puducherry[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_punjab <- round(weighted.mean(summary_q6$q6_punjab[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_rajasthan <- round(weighted.mean(summary_q6$q6_rajasthan[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_sikkim <- round(weighted.mean(summary_q6$q6_sikkim[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_tn <- round(weighted.mean(summary_q6$q6_tn[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_telangana <- round(weighted.mean(summary_q6$q6_telangana[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_tripura <- round(weighted.mean(summary_q6$q6_tripura[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_up <- round(weighted.mean(summary_q6$q6_up[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_uttarakhand <- round(weighted.mean(summary_q6$q6_uttarakhand[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_wb <- round(weighted.mean(summary_q6$q6_wb[summary_q6$sdg_tier=="Frontrunner"], summary_q6$sdg_weight[summary_q6$sdg_tier=="Frontrunner"])*100,2)

#forming separate vectors
q6aspt_plot <- c(q6aspt_weighted_mean_anislands, q6aspt_weighted_mean_andhra, q6aspt_weighted_mean_arunachal, q6aspt_weighted_mean_assam, q6aspt_weighted_mean_bihar, q6aspt_weighted_mean_chandigarh, q6aspt_weighted_mean_chhattisgarh, q6aspt_weighted_mean_delhi, q6aspt_weighted_mean_dnhdd, q6aspt_weighted_mean_goa, q6aspt_weighted_mean_gujarat, q6aspt_weighted_mean_haryana, q6aspt_weighted_mean_hp, q6aspt_weighted_mean_jharkhand, q6aspt_weighted_mean_jk, q6aspt_weighted_mean_karnataka, q6aspt_weighted_mean_kerala, q6aspt_weighted_mean_ladakh, q6aspt_weighted_mean_lakshadweep, q6aspt_weighted_mean_maharashtra, q6aspt_weighted_mean_manipur, q6aspt_weighted_mean_meghalaya, q6aspt_weighted_mean_mizoram, q6aspt_weighted_mean_mp, q6aspt_weighted_mean_nagaland, q6aspt_weighted_mean_none, q6aspt_weighted_mean_odisha, q6aspt_weighted_mean_puducherry, q6aspt_weighted_mean_punjab, q6aspt_weighted_mean_rajasthan, q6aspt_weighted_mean_sikkim, q6aspt_weighted_mean_telangana, q6aspt_weighted_mean_tn, q6aspt_weighted_mean_tripura, q6aspt_weighted_mean_up, q6aspt_weighted_mean_uttarakhand, q6aspt_weighted_mean_wb)

q6perf_plot <- c(q6perf_weighted_mean_anislands, q6perf_weighted_mean_andhra, q6perf_weighted_mean_arunachal, q6perf_weighted_mean_assam, q6perf_weighted_mean_bihar, q6perf_weighted_mean_chandigarh, q6perf_weighted_mean_chhattisgarh, q6perf_weighted_mean_delhi, q6perf_weighted_mean_dnhdd, q6perf_weighted_mean_goa, q6perf_weighted_mean_gujarat, q6perf_weighted_mean_haryana, q6perf_weighted_mean_hp, q6perf_weighted_mean_jharkhand, q6perf_weighted_mean_jk, q6perf_weighted_mean_karnataka, q6perf_weighted_mean_kerala, q6perf_weighted_mean_ladakh, q6perf_weighted_mean_lakshadweep, q6perf_weighted_mean_maharashtra, q6perf_weighted_mean_manipur, q6perf_weighted_mean_meghalaya, q6perf_weighted_mean_mizoram, q6perf_weighted_mean_mp, q6perf_weighted_mean_nagaland, q6perf_weighted_mean_none, q6perf_weighted_mean_odisha, q6perf_weighted_mean_puducherry, q6perf_weighted_mean_punjab, q6perf_weighted_mean_rajasthan, q6perf_weighted_mean_sikkim, q6perf_weighted_mean_telangana, q6perf_weighted_mean_tn, q6perf_weighted_mean_tripura, q6perf_weighted_mean_up, q6perf_weighted_mean_uttarakhand, q6perf_weighted_mean_wb)

q6frnt_plot <- c(q6frnt_weighted_mean_anislands, q6frnt_weighted_mean_andhra, q6frnt_weighted_mean_arunachal, q6frnt_weighted_mean_assam, q6frnt_weighted_mean_bihar, q6frnt_weighted_mean_chandigarh, q6frnt_weighted_mean_chhattisgarh, q6frnt_weighted_mean_delhi, q6frnt_weighted_mean_dnhdd, q6frnt_weighted_mean_goa, q6frnt_weighted_mean_gujarat, q6frnt_weighted_mean_haryana, q6frnt_weighted_mean_hp, q6frnt_weighted_mean_jharkhand, q6frnt_weighted_mean_jk, q6frnt_weighted_mean_karnataka, q6frnt_weighted_mean_kerala, q6frnt_weighted_mean_ladakh, q6frnt_weighted_mean_lakshadweep, q6frnt_weighted_mean_maharashtra, q6frnt_weighted_mean_manipur, q6frnt_weighted_mean_meghalaya, q6frnt_weighted_mean_mizoram, q6frnt_weighted_mean_mp, q6frnt_weighted_mean_nagaland, q6frnt_weighted_mean_none, q6frnt_weighted_mean_odisha, q6frnt_weighted_mean_puducherry, q6frnt_weighted_mean_punjab, q6frnt_weighted_mean_rajasthan, q6frnt_weighted_mean_sikkim, q6frnt_weighted_mean_telangana, q6frnt_weighted_mean_tn, q6frnt_weighted_mean_tripura, q6frnt_weighted_mean_up, q6frnt_weighted_mean_uttarakhand, q6frnt_weighted_mean_wb)

#creating common labels
q6full_plot_labels <- c("AN", "AP", "AR", "AS", "BR", "CH", "CG", "DL", "DNH & DD", "GA", "GJ", "HR", "HP", "JH", "JK", "KA", "KL", "LA", "LD", "MH", "MN", "ML", "MZ", "MP", "NL", "None", "OR", "PY", "PB", "RJ", "SK", "TG", "TN", "TR", "UP", "UK", "WB")

#Invoking GGplot
##aspirant states
q6aspt_plot_dta <- data.frame (q6aspt_plot, q6full_plot_labels) 
q6aspt_plot_dta$wrapped_labels = str_wrap(q6aspt_plot_dta$q6full_plot_labels, width = 10)
q6aspt_plot <- ggplot(q6aspt_plot_dta, aes(x=q6full_plot_labels, y=q6aspt_plot, fill = q6full_plot_labels)) +
  geom_bar(stat="identity", width= 1, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q6aspt_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,40)) +
  scale_x_discrete(labels = function(q6full_plot_labels) str_wrap(q6full_plot_labels, width = 30)) +
  labs(x="",y="Percent", title = "Aspirant States")+
  newtheme

##Performer States
q6perf_plot_dta <- data.frame (q6perf_plot, q6full_plot_labels) 
q6perf_plot_dta$wrapped_labels = str_wrap(q6perf_plot_dta$q6full_plot_labels, width = 10)
q6perf_plot <- ggplot(q6perf_plot_dta, aes(x=q6full_plot_labels, y=q6perf_plot, fill = q6full_plot_labels)) +
  geom_bar(stat="identity", width= 1, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q6perf_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,40)) +
  scale_x_discrete(labels = function(q6full_plot_labels) str_wrap(q6full_plot_labels, width = 30)) +
  labs(x="",y="Percent", title = "Performer States")+
  newtheme

##Frontrunner States
q6frnt_plot_dta <- data.frame (q6frnt_plot, q6full_plot_labels) 
q6frnt_plot_dta$wrapped_labels = str_wrap(q6frnt_plot_dta$q6full_plot_labels, width = 10)
q6frnt_plot <- ggplot(q6frnt_plot_dta, aes(x=q6full_plot_labels, y=q6frnt_plot, fill = q6full_plot_labels)) +
  geom_bar(stat="identity", width= 1, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q6frnt_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,40)) +
  scale_x_discrete(labels = function(q6full_plot_labels) str_wrap(q6full_plot_labels, width = 30)) +
  labs(x="",y="Percent", title = "Frontrunner States")+
  newtheme

#Stacking all plots vertically
grid.newpage()
grid.draw(rbind(ggplotGrob(q6aspt_plot), ggplotGrob(q6perf_plot), ggplotGrob(q6frnt_plot), size = "last"))
```
\newpage
## Question 6: Disaggregated by SDG: Accounting for Officers' Bias

Please select one State that you think has been under-appreciated for its success in pandemic management. (States selected in previous answers can be repeated)  

Responses by officers who indicated their own states as being under-appreciated have been excluded from the following graph. 

\vspace{6mm}
```{r, echo = FALSE, fig.height=20,fig.width=18, warning=FALSE}
summary_q6_unbiased <- summary_q6_unbiased %>% 
  mutate (sdg_tier = ias_processed_dta$sdg)

#Calculating weighted means
##Aspirants
q6aspt_weighted_mean_anislands <- round(weighted.mean(summary_q6_unbiased$q6_anislands[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_andhra <- round(weighted.mean(summary_q6_unbiased$q6_andhra[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_arunachal <- round(weighted.mean(summary_q6_unbiased$q6_arunachal[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_assam <- round(weighted.mean(summary_q6_unbiased$q6_assam[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_bihar <- round(weighted.mean(summary_q6_unbiased$q6_bihar[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_chandigarh <- round(weighted.mean(summary_q6_unbiased$q6_chandigarh[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_chhattisgarh <- round(weighted.mean(summary_q6_unbiased$q6_chhattisgarh[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_dnhdd <- round(weighted.mean(summary_q6_unbiased$q6_dnhdd[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_goa <- round(weighted.mean(summary_q6_unbiased$q6_goa[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_gujarat <- round(weighted.mean(summary_q6_unbiased$q6_gujarat[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_haryana <-round(weighted.mean(summary_q6_unbiased$q6_haryana[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_hp <- round(weighted.mean(summary_q6_unbiased$q6_hp[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_jk <- round(weighted.mean(summary_q6_unbiased$q6_jk[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_jharkhand <- round(weighted.mean(summary_q6_unbiased$q6_jharkhand[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_karnataka <- round(weighted.mean(summary_q6_unbiased$q6_karnataka[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_kerala <- round(weighted.mean(summary_q6_unbiased$q6_kerala[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_ladakh <- round(weighted.mean(summary_q6_unbiased$q6_ladakh[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_lakshadweep <- round(weighted.mean(summary_q6_unbiased$q6_lakshadweep[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_mp <- round(weighted.mean(summary_q6_unbiased$q6_mp[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_maharashtra <- round(weighted.mean(summary_q6_unbiased$q6_maharashtra[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_manipur <- round(weighted.mean(summary_q6_unbiased$q6_manipur[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_meghalaya <- round(weighted.mean(summary_q6_unbiased$q6_meghalaya[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_mizoram <- round(weighted.mean(summary_q6_unbiased$q6_mizoram[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_nagaland <- round(weighted.mean(summary_q6_unbiased$q6_nagaland[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_delhi <- round(weighted.mean(summary_q6_unbiased$q6_delhi[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_none <- round(weighted.mean(summary_q6_unbiased$q6_none[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_odisha <- round(weighted.mean(summary_q6_unbiased$q6_odisha[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_puducherry <- round(weighted.mean(summary_q6_unbiased$q6_puducherry[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_punjab <- round(weighted.mean(summary_q6_unbiased$q6_punjab[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_rajasthan <- round(weighted.mean(summary_q6_unbiased$q6_rajasthan[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_sikkim <- round(weighted.mean(summary_q6_unbiased$q6_sikkim[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_tn <- round(weighted.mean(summary_q6_unbiased$q6_tn[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_telangana <- round(weighted.mean(summary_q6_unbiased$q6_telangana[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_tripura <- round(weighted.mean(summary_q6_unbiased$q6_tripura[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_up <- round(weighted.mean(summary_q6_unbiased$q6_up[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_uttarakhand <- round(weighted.mean(summary_q6_unbiased$q6_uttarakhand[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)
q6aspt_weighted_mean_wb <- round(weighted.mean(summary_q6_unbiased$q6_wb[summary_q6_unbiased$sdg_tier=="Aspirant"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Aspirant"])*100,2)

##Performers
q6perf_weighted_mean_anislands <- round(weighted.mean(summary_q6_unbiased$q6_anislands[summary_q6_unbiased$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_andhra <- round(weighted.mean(summary_q6_unbiased$q6_andhra[summary_q6_unbiased$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_arunachal <- round(weighted.mean(summary_q6_unbiased$q6_arunachal[summary_q6_unbiased$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_assam <- round(weighted.mean(summary_q6_unbiased$q6_assam[summary_q6_unbiased$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_bihar <- round(weighted.mean(summary_q6_unbiased$q6_bihar[summary_q6_unbiased$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_chandigarh <- round(weighted.mean(summary_q6_unbiased$q6_chandigarh[summary_q6_unbiased$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_chhattisgarh <- round(weighted.mean(summary_q6_unbiased$q6_chhattisgarh[summary_q6_unbiased$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_dnhdd <- round(weighted.mean(summary_q6_unbiased$q6_dnhdd[summary_q6_unbiased$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_goa <- round(weighted.mean(summary_q6_unbiased$q6_goa[summary_q6_unbiased$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_gujarat <- round(weighted.mean(summary_q6_unbiased$q6_gujarat[summary_q6_unbiased$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_haryana <- round(weighted.mean(summary_q6_unbiased$q6_haryana[summary_q6_unbiased$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_hp <- round(weighted.mean(summary_q6_unbiased$q6_hp[summary_q6_unbiased$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_jk <- round(weighted.mean(summary_q6_unbiased$q6_jk[summary_q6_unbiased$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_jharkhand <- round(weighted.mean(summary_q6_unbiased$q6_jharkhand[summary_q6_unbiased$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_karnataka <- round(weighted.mean(summary_q6_unbiased$q6_karnataka[summary_q6_unbiased$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_kerala <- round(weighted.mean(summary_q6_unbiased$q6_kerala[summary_q6_unbiased$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_ladakh <- round(weighted.mean(summary_q6_unbiased$q6_ladakh[summary_q6_unbiased$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_lakshadweep <- round(weighted.mean(summary_q6_unbiased$q6_lakshadweep[summary_q6_unbiased$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_mp <- round(weighted.mean(summary_q6_unbiased$q6_mp[summary_q6_unbiased$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_maharashtra <- round(weighted.mean(summary_q6_unbiased$q6_maharashtra[summary_q6_unbiased$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_manipur <- round(weighted.mean(summary_q6_unbiased$q6_manipur[summary_q6_unbiased$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_meghalaya <- round(weighted.mean(summary_q6_unbiased$q6_meghalaya[summary_q6_unbiased$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_mizoram <- round(weighted.mean(summary_q6_unbiased$q6_mizoram[summary_q6_unbiased$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_nagaland <- round(weighted.mean(summary_q6_unbiased$q6_nagaland[summary_q6_unbiased$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_delhi <- round(weighted.mean(summary_q6_unbiased$q6_delhi[summary_q5$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_none <- round(weighted.mean(summary_q6_unbiased$q6_none[summary_q5$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_odisha <- round(weighted.mean(summary_q6_unbiased$q6_odisha[summary_q5$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_puducherry <- round(weighted.mean(summary_q6_unbiased$q6_puducherry[summary_q5$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_punjab <- round(weighted.mean(summary_q6_unbiased$q6_punjab[summary_q5$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_rajasthan <- round(weighted.mean(summary_q6_unbiased$q6_rajasthan[summary_q5$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_sikkim <- round(weighted.mean(summary_q6_unbiased$q6_sikkim[summary_q5$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_tn <- round(weighted.mean(summary_q6_unbiased$q6_tn[summary_q5$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_telangana <- round(weighted.mean(summary_q6_unbiased$q6_telangana[summary_q5$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_tripura <- round(weighted.mean(summary_q6_unbiased$q6_tripura[summary_q5$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_up <- round(weighted.mean(summary_q6_unbiased$q6_up[summary_q5$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_uttarakhand <- round(weighted.mean(summary_q6_unbiased$q6_uttarakhand[summary_q5$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)
q6perf_weighted_mean_wb <- round(weighted.mean(summary_q6_unbiased$q6_wb[summary_q6_unbiased$sdg_tier=="Performer"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Performer"])*100,2)

##Frontrunner
q6frnt_weighted_mean_anislands <- round(weighted.mean(summary_q6_unbiased$q6_anislands[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_andhra <- round(weighted.mean(summary_q6_unbiased$q6_andhra[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_arunachal <- round(weighted.mean(summary_q6_unbiased$q6_arunachal[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_assam <- round(weighted.mean(summary_q6_unbiased$q6_assam[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_bihar <- round(weighted.mean(summary_q6_unbiased$q6_bihar[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_chandigarh <- round(weighted.mean(summary_q6_unbiased$q6_chandigarh[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_chhattisgarh <- round(weighted.mean(summary_q6_unbiased$q6_chhattisgarh[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_dnhdd <- round(weighted.mean(summary_q6_unbiased$q6_dnhdd[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_goa <- round(weighted.mean(summary_q6_unbiased$q6_goa[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_gujarat <- round(weighted.mean(summary_q6_unbiased$q6_gujarat[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_haryana <- round(weighted.mean(summary_q6_unbiased$q6_haryana[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_hp <- round(weighted.mean(summary_q6_unbiased$q6_hp[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_jk <- round(weighted.mean(summary_q6_unbiased$q6_jk[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_jharkhand <- round(weighted.mean(summary_q6_unbiased$q6_jharkhand[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_karnataka <- round(weighted.mean(summary_q6_unbiased$q6_karnataka[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_kerala <- round(weighted.mean(summary_q6_unbiased$q6_kerala[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_ladakh <- round(weighted.mean(summary_q6_unbiased$q6_ladakh[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_lakshadweep <- round(weighted.mean(summary_q6_unbiased$q6_lakshadweep[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_mp <- round(weighted.mean(summary_q6_unbiased$q6_mp[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_maharashtra <- round(weighted.mean(summary_q6_unbiased$q6_maharashtra[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_manipur <- round(weighted.mean(summary_q6_unbiased$q6_manipur[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_meghalaya <- round(weighted.mean(summary_q6_unbiased$q6_meghalaya[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_mizoram <- round(weighted.mean(summary_q6_unbiased$q6_mizoram[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_nagaland <- round(weighted.mean(summary_q6_unbiased$q6_nagaland[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_delhi <- round(weighted.mean(summary_q6_unbiased$q6_delhi[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_none <- round(weighted.mean(summary_q6_unbiased$q6_none[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_odisha <- round(weighted.mean(summary_q6_unbiased$q6_odisha[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_puducherry <- round(weighted.mean(summary_q6_unbiased$q6_puducherry[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_punjab <- round(weighted.mean(summary_q6_unbiased$q6_punjab[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_rajasthan <- round(weighted.mean(summary_q6_unbiased$q6_rajasthan[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_sikkim <- round(weighted.mean(summary_q6_unbiased$q6_sikkim[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_tn <- round(weighted.mean(summary_q6_unbiased$q6_tn[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_telangana <- round(weighted.mean(summary_q6_unbiased$q6_telangana[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_tripura <- round(weighted.mean(summary_q6_unbiased$q6_tripura[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_up <- round(weighted.mean(summary_q6_unbiased$q6_up[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_uttarakhand <- round(weighted.mean(summary_q6_unbiased$q6_uttarakhand[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)
q6frnt_weighted_mean_wb <- round(weighted.mean(summary_q6_unbiased$q6_wb[summary_q6_unbiased$sdg_tier=="Frontrunner"], summary_q6_unbiased$sdg_weight[summary_q6_unbiased$sdg_tier=="Frontrunner"])*100,2)

#forming separate vectors
q6aspt_plot <- c(q6aspt_weighted_mean_anislands, q6aspt_weighted_mean_andhra, q6aspt_weighted_mean_arunachal, q6aspt_weighted_mean_assam, q6aspt_weighted_mean_bihar, q6aspt_weighted_mean_chandigarh, q6aspt_weighted_mean_chhattisgarh, q6aspt_weighted_mean_delhi, q6aspt_weighted_mean_dnhdd, q6aspt_weighted_mean_goa, q6aspt_weighted_mean_gujarat, q6aspt_weighted_mean_haryana, q6aspt_weighted_mean_hp, q6aspt_weighted_mean_jharkhand, q6aspt_weighted_mean_jk, q6aspt_weighted_mean_karnataka, q6aspt_weighted_mean_kerala, q6aspt_weighted_mean_ladakh, q6aspt_weighted_mean_lakshadweep, q6aspt_weighted_mean_maharashtra, q6aspt_weighted_mean_manipur, q6aspt_weighted_mean_meghalaya, q6aspt_weighted_mean_mizoram, q6aspt_weighted_mean_mp, q6aspt_weighted_mean_nagaland, q6aspt_weighted_mean_none, q6aspt_weighted_mean_odisha, q6aspt_weighted_mean_puducherry, q6aspt_weighted_mean_punjab, q6aspt_weighted_mean_rajasthan, q6aspt_weighted_mean_sikkim, q6aspt_weighted_mean_telangana, q6aspt_weighted_mean_tn, q6aspt_weighted_mean_tripura, q6aspt_weighted_mean_up, q6aspt_weighted_mean_uttarakhand, q6aspt_weighted_mean_wb)

q6perf_plot <- c(q6perf_weighted_mean_anislands, q6perf_weighted_mean_andhra, q6perf_weighted_mean_arunachal, q6perf_weighted_mean_assam, q6perf_weighted_mean_bihar, q6perf_weighted_mean_chandigarh, q6perf_weighted_mean_chhattisgarh, q6perf_weighted_mean_delhi, q6perf_weighted_mean_dnhdd, q6perf_weighted_mean_goa, q6perf_weighted_mean_gujarat, q6perf_weighted_mean_haryana, q6perf_weighted_mean_hp, q6perf_weighted_mean_jharkhand, q6perf_weighted_mean_jk, q6perf_weighted_mean_karnataka, q6perf_weighted_mean_kerala, q6perf_weighted_mean_ladakh, q6perf_weighted_mean_lakshadweep, q6perf_weighted_mean_maharashtra, q6perf_weighted_mean_manipur, q6perf_weighted_mean_meghalaya, q6perf_weighted_mean_mizoram, q6perf_weighted_mean_mp, q6perf_weighted_mean_nagaland, q6perf_weighted_mean_none, q6perf_weighted_mean_odisha, q6perf_weighted_mean_puducherry, q6perf_weighted_mean_punjab, q6perf_weighted_mean_rajasthan, q6perf_weighted_mean_sikkim, q6perf_weighted_mean_telangana, q6perf_weighted_mean_tn, q6perf_weighted_mean_tripura, q6perf_weighted_mean_up, q6perf_weighted_mean_uttarakhand, q6perf_weighted_mean_wb)

q6frnt_plot <- c(q6frnt_weighted_mean_anislands, q6frnt_weighted_mean_andhra, q6frnt_weighted_mean_arunachal, q6frnt_weighted_mean_assam, q6frnt_weighted_mean_bihar, q6frnt_weighted_mean_chandigarh, q6frnt_weighted_mean_chhattisgarh, q6frnt_weighted_mean_delhi, q6frnt_weighted_mean_dnhdd, q6frnt_weighted_mean_goa, q6frnt_weighted_mean_gujarat, q6frnt_weighted_mean_haryana, q6frnt_weighted_mean_hp, q6frnt_weighted_mean_jharkhand, q6frnt_weighted_mean_jk, q6frnt_weighted_mean_karnataka, q6frnt_weighted_mean_kerala, q6frnt_weighted_mean_ladakh, q6frnt_weighted_mean_lakshadweep, q6frnt_weighted_mean_maharashtra, q6frnt_weighted_mean_manipur, q6frnt_weighted_mean_meghalaya, q6frnt_weighted_mean_mizoram, q6frnt_weighted_mean_mp, q6frnt_weighted_mean_nagaland, q6frnt_weighted_mean_none, q6frnt_weighted_mean_odisha, q6frnt_weighted_mean_puducherry, q6frnt_weighted_mean_punjab, q6frnt_weighted_mean_rajasthan, q6frnt_weighted_mean_sikkim, q6frnt_weighted_mean_telangana, q6frnt_weighted_mean_tn, q6frnt_weighted_mean_tripura, q6frnt_weighted_mean_up, q6frnt_weighted_mean_uttarakhand, q6frnt_weighted_mean_wb)

#creating common labels
q6full_plot_labels <- c("AN", "AP", "AR", "AS", "BR", "CH", "CG", "DL", "DNH & DD", "GA", "GJ", "HR", "HP", "JH", "JK", "KA", "KL", "LA", "LD", "MH", "MN", "ML", "MZ", "MP", "NL", "None", "OR", "PY", "PB", "RJ", "SK", "TG", "TN", "TR", "UP", "UK", "WB")

#Invoking GGplot
##aspirant states
q6aspt_plot_dta <- data.frame (q6aspt_plot, q6full_plot_labels) 
q6aspt_plot_dta$wrapped_labels = str_wrap(q6aspt_plot_dta$q6full_plot_labels, width = 10)
q6aspt_plot <- ggplot(q6aspt_plot_dta, aes(x=q6full_plot_labels, y=q6aspt_plot, fill = q6full_plot_labels)) +
  geom_bar(stat="identity", width= 1, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q6aspt_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,40)) +
  scale_x_discrete(labels = function(q6full_plot_labels) str_wrap(q6full_plot_labels, width = 30)) +
  labs(x="",y="Percent", title = "Aspirant States")+
  newtheme

##Performer States
q6perf_plot_dta <- data.frame (q6perf_plot, q6full_plot_labels) 
q6perf_plot_dta$wrapped_labels = str_wrap(q6perf_plot_dta$q6full_plot_labels, width = 10)
q6perf_plot <- ggplot(q6perf_plot_dta, aes(x=q6full_plot_labels, y=q6perf_plot, fill = q6full_plot_labels)) +
  geom_bar(stat="identity", width= 1, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q6perf_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,40)) +
  scale_x_discrete(labels = function(q6full_plot_labels) str_wrap(q6full_plot_labels, width = 30)) +
  labs(x="",y="Percent", title = "Performer States")+
  newtheme

##Frontrunner States
q6frnt_plot_dta <- data.frame (q6frnt_plot, q6full_plot_labels) 
q6frnt_plot_dta$wrapped_labels = str_wrap(q6frnt_plot_dta$q6full_plot_labels, width = 10)
q6frnt_plot <- ggplot(q6frnt_plot_dta, aes(x=q6full_plot_labels, y=q6frnt_plot, fill = q6full_plot_labels)) +
  geom_bar(stat="identity", width= 1, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q6frnt_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,40)) +
  scale_x_discrete(labels = function(q6full_plot_labels) str_wrap(q6full_plot_labels, width = 30)) +
  labs(x="",y="Percent", title = "Frontrunner States")+
  newtheme

#Stacking all plots vertically
grid.newpage()
grid.draw(rbind(ggplotGrob(q6aspt_plot), ggplotGrob(q6perf_plot), ggplotGrob(q6frnt_plot), size = "last"))
```
\newpage
## Question 7: Aggregate Graph

Some examples of successful management of the challenges posed by the pandemic show that civil servants can perform even under very difficult circumstances. Why is this situation not the norm? Choose the option that you consider more important. 

\vspace{6mm}
```{r}
#Aggregate
q7full_mean_ones <- round(weighted.mean(summary_state_analysis$X130ones, summary_state_analysis$state_weight)*100,2) 
q7full_mean_twos <- round(weighted.mean(summary_state_analysis$X130twos, summary_state_analysis$state_weight)*100,2)
q7full_plot <- c(q7full_mean_ones, q7full_mean_twos) 
q7full_plot_labels <- c("Resources and autonomy can always be generated if only the system were to positively acknowledge initiative and motivation as a rule", "The system simply does not provide the resources and autonomy required to succeed.")
q7full_plot_dta <- data.frame(q7full_plot, q7full_plot_labels) 
q7full_plot_dta$wrapped_labels = str_wrap(q7full_plot_dta$q7full_plot_labels, width = 10)
q7full_plot <- ggplot(q7full_plot_dta, aes(x=q7full_plot_labels, y=q7full_plot, fill = q7full_plot_labels)) +
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q7full_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,100)) + 
  scale_x_discrete(labels = function(q7full_plot_labels) str_wrap(q7full_plot_labels, width = 40)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent") +
  newtheme
q7full_plot
```
\newpage

## Question 7: Disaggregated by Age

Some examples of successful management of the challenges posed by the pandemic show that civil servants can perform even under very difficult circumstances. Why is this situation not the norm? Choose the option that you consider more important. 

\vspace{6mm}
```{r echo = FALSE, fig.height=10,fig.width=18}
#Age 
q7_plotlabels <- c("Resources and autonomy can always be generated if only the system were to positively acknowledge \n initiative and motivation as a rule", "The system simply does not provide the resources and autonomy required to succeed.")
q7young_mean_ones <- round(weighted.mean(summary_state_analysis_young$X130ones, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2) 
q7young_mean_twos <- round(weighted.mean(summary_state_analysis_young$X130twos, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2)
q7_young_plot<-c(q7young_mean_ones,q7young_mean_twos)
q7_young_plotdta <- data.frame(q7_young_plot, q7_plotlabels) 
q7_young_plotdta$wrapped_labels = str_wrap(q7_young_plotdta$q7_plotlabels, width = 10)
q7_young_plot <- ggplot(q7_young_plotdta, aes(x = q7_plotlabels, y = q7_young_plot, fill = q7_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q7_young_plot),"%"), vjust=-0.3), size=7.5)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "2012 and After") +
  disaggtheme

q7old_mean_ones <- round(weighted.mean(summary_state_analysis_old$X130ones, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2) 
q7old_mean_twos <- round(weighted.mean(summary_state_analysis_old$X130twos, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2)
q7_old_plot<-c(q7old_mean_ones,q7old_mean_twos)
q7_old_plotdta <- data.frame(q7_old_plot, q7_plotlabels) 
q7_old_plotdta <- data.frame(q7_old_plot, q7_plotlabels) 
q7_old_plotdta$wrapped_labels = str_wrap(q7_old_plotdta$q7_plotlabels, width = 10)
q7_old_plot <- ggplot(q7_old_plotdta, aes(x = q7_plotlabels, y = q7_old_plot, fill = q7_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q7_old_plot),"%"), vjust=-0.3), size=7.5)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "2011 and Before") +
  disaggtheme

q7_former_plot<-c(summary_state_former$X130ones*100, summary_state_former$X130twos*100)
q7_former_plotdta <- data.frame(q7_former_plot, q7_plotlabels) 
q7_former_plotdta$wrapped_labels = str_wrap(q7_former_plotdta$q7_plotlabels, width = 10)

q7_former_plot <- ggplot(q7_former_plotdta, aes(x = q7_plotlabels, y = q7_former_plot, fill = q7_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q7_former_plot),"%"), vjust=-0.3), size=7.5)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "Former Officers") +
  disaggtheme

legend7 <- cowplot::get_legend(q7_former_plot) 
q7_former_plot <- q7_former_plot +theme(legend.position = "none")
plot7_fullage <- plot_grid(q7_young_plot,q7_old_plot,q7_former_plot,
                           nrow = 1)
plot7_fullage <- plot_grid(plot7_fullage, legend7, nrow = 2, rel_heights=c(5,2)) 
plot7_fullage
```
\newpage

## Question 7: Disaggregated by SDG

Some examples of successful management of the challenges posed by the pandemic show that civil servants can perform even under very difficult circumstances. Why is this situation not the norm? Choose the option that you consider more important. 

\vspace{6mm}
```{r, echo = FALSE, fig.height=10,fig.width=18}
#Calculating weighted means
q7aspt_mean_ones <- round(weighted.mean(summary_state_analysis$X130ones[summary_state_analysis$sdg_tier=="Aspirant"],
summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2) 
q7aspt_mean_twos <- round(weighted.mean(summary_state_analysis$X130twos[summary_state_analysis$sdg_tier=="Aspirant"],
summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)

q7perf_mean_ones <- round(weighted.mean(summary_state_analysis$X130ones[summary_state_analysis$sdg_tier=="Performer"],
summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2) 
q7perf_mean_twos <- round(weighted.mean(summary_state_analysis$X130twos[summary_state_analysis$sdg_tier=="Performer"],
summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)

q7frnt_mean_ones <- round(weighted.mean(summary_state_analysis$X130ones[summary_state_analysis$sdg_tier=="Frontrunner"],
summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2) 
q7frnt_mean_twos <- round(weighted.mean(summary_state_analysis$X130twos[summary_state_analysis$sdg_tier=="Frontrunner"],
summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)

#Forming vectors
q7aspt_plot <- c(q7aspt_mean_ones, q7aspt_mean_twos) 
q7perf_plot <- c(q7perf_mean_ones, q7perf_mean_twos)
q7frnt_plot <- c(q7frnt_mean_ones, q7frnt_mean_twos)
q7full_plot_labels <- c("Resources and autonomy can always be generated if only the system were to positively acknowledge \n initiative and motivation as a rule", "The system simply does not provide the resources and autonomy required to succeed.") 

#Constructing Data Frames
q7aspt_plot_dta <- data.frame(q7aspt_plot, q7full_plot_labels) 
q7perf_plot_dta <- data.frame(q7perf_plot, q7full_plot_labels) 
q7frnt_plot_dta <- data.frame(q7frnt_plot, q7full_plot_labels) 

#Wrapping labels
q7aspt_plot_dta$wrapped_labels = str_wrap(q7aspt_plot_dta$q7full_plot_label, width = 10)
q7perf_plot_dta$wrapped_labels = str_wrap(q7perf_plot_dta$q7full_plot_label, width = 10)
q7frnt_plot_dta$wrapped_labels = str_wrap(q7frnt_plot_dta$q7full_plot_label, width = 10)

#Invoking ggplot
q7aspt_plot <- ggplot(q7aspt_plot_dta, aes(x=q7full_plot_labels, y=q7aspt_plot, fill = q7full_plot_labels)) +
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q7aspt_plot),"%"), vjust=-0.3), size=7.5) +
  scale_y_continuous(limits = c(0,100)) +  
  scale_x_discrete(labels= c("","")) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "Aspirant States") +
  disaggtheme

q7perf_plot <- ggplot(q7perf_plot_dta, aes(x=q7full_plot_labels, y=q7perf_plot, fill = q7full_plot_labels)) +
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q7perf_plot),"%"), vjust=-0.3), size=7.5) +
  scale_y_continuous(limits = c(0,100)) +  
  scale_x_discrete(labels= c("","")) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "Performer States") +
  disaggtheme

q7frnt_plot_temp <- ggplot(q7frnt_plot_dta, aes(x=q7full_plot_labels, y=q7frnt_plot, fill = q7full_plot_labels)) +
  geom_bar(stat="identity", width= 0.5, show.legend = TRUE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q7frnt_plot),"%"), vjust=-0.3), size=7.5) +
  scale_y_continuous(limits = c(0,100)) +  
  scale_x_discrete(labels= c("","")) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "Frontrunner States") +
  disaggtheme

legend7 <- cowplot::get_legend(q7frnt_plot_temp)
q7frnt_plot <- q7frnt_plot_temp +theme(legend.position = "none")
q7_fullsdg <- plot_grid(q7aspt_plot,q7perf_plot,q7frnt_plot, nrow=1)
q7_fullsdg <- plot_grid(q7_fullsdg,legend7, nrow = 2, rel_heights=c(5,2))
q7_fullsdg
```
\newpage

## Question 8: Aggregate Graph

The government has been criticised for permitting large gatherings (during election campaigning and religious/cultural events like the kumbh mela) that may have accelerated the surge. Which of the following statements would you agree with most?

\vspace{6mm}
```{r}
#Aggregate
q8full_mean_ones <- round(weighted.mean(summary_state_analysis$X131ones, summary_state_analysis$state_weight)*100,2) 
q8full_mean_twos <- round(weighted.mean(summary_state_analysis$X131twos, summary_state_analysis$state_weight)*100,2) 
q8full_mean_threes <- round(weighted.mean(summary_state_analysis$X131threes, summary_state_analysis$state_weight)*100,2)
q8full_mean_fours <- round(weighted.mean(summary_state_analysis$X131fours, summary_state_analysis$state_weight)*100,2)
q8full_plot <- c(q8full_mean_ones, q8full_mean_twos, q8full_mean_threes, q8full_mean_fours) 
q8full_plot_labels <- c("Knowing the risks involved, such events should not have been scheduled at all.","The risks from these events were too high. They could have been managed better (perhaps by staggering the events or by curtailing participation).","The surge was caused by a natural progression of the virus. Prohibiting these events would not have prevented this surge.", "These events are of high cultural and democratic importance. There was no choice but to take the risk.") 
q8full_plot_dta <- data.frame(q8full_plot, q8full_plot_labels) 
q8full_plot_dta$wrapped_labels = str_wrap(q8full_plot_dta$q8full_plot_labels, width = 50)
q8full_plot <- ggplot(q8full_plot_dta, aes(x=q8full_plot_labels, y=q8full_plot, fill = q8full_plot_labels)) +
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q8full_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,100)) +
  scale_x_discrete(labels = function(q8full_plot_labels) str_wrap(q8full_plot_labels, width = 20)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent") +
  newtheme
q8full_plot
```
\newpage

## Question 8: Disaggregated by Age

The government has been criticised for permitting large gatherings (during election campaigning and religious/cultural events like the kumbh mela) that may have accelerated the surge. Which of the following statements would you agree with most?

\vspace{6mm}
```{r echo = FALSE, fig.height=10,fig.width=18}
#Age
q8_plotlabels <- c("Knowing the risks involved, such events should not have been scheduled at all.","The risks from these events were too high. They could have been managed better \n (perhaps by staggering the events or by curtailing participation).","The surge was caused by a natural progression of the virus. Prohibiting these events would not have \n prevented this surge.", "These events are of high cultural and democratic importance. There was no choice but to take the risk.")

q8young_mean_ones <- round(weighted.mean(summary_state_analysis_young$X131ones, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2) 
q8young_mean_twos <- round(weighted.mean(summary_state_analysis_young$X131twos, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2)
q8young_mean_threes <- round(weighted.mean(summary_state_analysis_young$X131threes, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2)
q8young_mean_fours <- round(weighted.mean(summary_state_analysis_young$X131fours, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2)
q8_young_plot<-c(q8young_mean_ones,q8young_mean_twos,q8young_mean_threes,q8young_mean_fours)
q8_young_plotdta <- data.frame(q8_young_plot, q8_plotlabels) 
q8_young_plotdta$wrapped_labels = str_wrap(q8_young_plotdta$q8_plotlabels, width = 10)

q8_young_plot <- ggplot(q8_young_plotdta, aes(x = q8_plotlabels, y = q8_young_plot, fill = q8_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q8_young_plot),"%"), vjust=-0.3), size=6.5)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "2012 and After") +
  disaggtheme

q8old_mean_ones <- round(weighted.mean(summary_state_analysis_old$X131ones, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2) 
q8old_mean_twos <- round(weighted.mean(summary_state_analysis_old$X131twos, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2)
q8old_mean_threes <- round(weighted.mean(summary_state_analysis_old$X131threes, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2)
q8old_mean_fours <- round(weighted.mean(summary_state_analysis_old$X131fours, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2)
q8_old_plot<-c(q8old_mean_ones,q8old_mean_twos,q8old_mean_threes,q8old_mean_fours)
q8_old_plotdta <- data.frame(q8_old_plot, q8_plotlabels) 
q8_old_plotdta$wrapped_labels = str_wrap(q8_old_plotdta$q8_plotlabels, width = 10)

q8_old_plot <- ggplot(q8_old_plotdta, aes(x = q8_plotlabels, y = q8_old_plot, fill = q8_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q8_old_plot),"%"), vjust=-0.3), size=6.5)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "2011 and Before") +
  disaggtheme

q8_former_plot<-c(summary_state_former$X131ones*100, summary_state_former$X131twos*100, summary_state_former$X131threes*100, summary_state_former$X131fours*100)
q8_former_plotdta <- data.frame(q8_former_plot, q8_plotlabels) 
q8_former_plotdta$wrapped_labels = str_wrap(q8_former_plotdta$q8_plotlabels, width = 10)

q8_former_plot <- ggplot(q8_former_plotdta, aes(x = q8_plotlabels, y = q8_former_plot, fill = q8_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q8_former_plot),"%"), vjust=-0.3), size=6.5)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "Former Officers") +
  disaggtheme

legend8 <- cowplot::get_legend(q8_former_plot) 
q8_former_plot <- q8_former_plot +theme(legend.position = "none")
plot8_fullage <- plot_grid(q8_young_plot,q8_old_plot,q8_former_plot,
                             nrow = 1)
plot8_fullage <- plot_grid(plot8_fullage, legend8, nrow = 2, rel_heights=c(5,2)) 
plot8_fullage
```
\newpage

## Question 8: Disaggregated by SDG

The government has been criticised for permitting large gatherings (during election campaigning and religious/cultural events like the kumbh mela) that may have accelerated the surge. Which of the following statements would you agree with most?

\vspace{6mm}
```{r, echo = FALSE, fig.height=10,fig.width=18}
#Calculating weighted means
q8aspt_mean_ones <- round(weighted.mean(summary_state_analysis$X131ones[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)
q8aspt_mean_twos <- round(weighted.mean(summary_state_analysis$X131twos[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)
q8aspt_mean_threes <- round(weighted.mean(summary_state_analysis$X131threes[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)
q8aspt_mean_fours <- round(weighted.mean(summary_state_analysis$X131fours[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)

q8frnt_mean_ones <- round(weighted.mean(summary_state_analysis$X131ones[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)
q8frnt_mean_twos <- round(weighted.mean(summary_state_analysis$X131twos[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)
q8frnt_mean_threes <- round(weighted.mean(summary_state_analysis$X131threes[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)
q8frnt_mean_fours <- round(weighted.mean(summary_state_analysis$X131fours[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)

q8perf_mean_ones <- round(weighted.mean(summary_state_analysis$X131ones[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)
q8perf_mean_twos <- round(weighted.mean(summary_state_analysis$X131twos[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)
q8perf_mean_threes <- round(weighted.mean(summary_state_analysis$X131threes[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)
q8perf_mean_fours <- round(weighted.mean(summary_state_analysis$X131fours[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)

#Forming vectors 
q8aspt_plot <- c(q8aspt_mean_ones, q8aspt_mean_twos, q8aspt_mean_threes, q8aspt_mean_fours)
q8frnt_plot <- c(q8frnt_mean_ones, q8frnt_mean_twos, q8frnt_mean_threes, q8frnt_mean_fours)
q8perf_plot <- c(q8perf_mean_ones, q8perf_mean_twos, q8perf_mean_threes, q8perf_mean_fours)

q8full_plot_labels <- c("Knowing the risks involved, such events should not have been scheduled at all.","The risks from these events were too high. They could have been managed better \n (perhaps by staggering the events or by curtailing participation).","The surge was caused by a natural progression of the virus. Prohibiting these events would not have \n prevented this surge.", "These events are of high cultural and democratic importance. There was no choice but to take the risk.") 

#constructing data frames
q8aspt_plot_dta <- data.frame(q8aspt_plot, q8full_plot_labels)
q8frnt_plot_dta <- data.frame(q8frnt_plot, q8full_plot_labels)
q8perf_plot_dta <- data.frame(q8perf_plot, q8full_plot_labels)

#wrapping labels
q8aspt_plot_dta$wrapped_labels = str_wrap(q8aspt_plot_dta$q8full_plot_labels, width = 50)
q8frnt_plot_dta$wrapped_labels = str_wrap(q8frnt_plot_dta$q8full_plot_labels, width = 50)
q8perf_plot_dta$wrapped_labels = str_wrap(q8perf_plot_dta$q8full_plot_labels, width = 50)

#Invoking ggplot
q8aspt_plot <- ggplot(q8aspt_plot_dta, aes(x=q8full_plot_labels, y=q8aspt_plot, fill = q8full_plot_labels)) +
  geom_bar(stat="identity", width=0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q8aspt_plot),"%"), vjust=-0.3), size=6.5) +
  scale_y_continuous(limits = c(0,100))  +
  labs(x="",y="Percent")  +
  scale_x_discrete(labels= c("","","","","")) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(title ="Aspirant States") +
  disaggtheme

q8perf_plot <- ggplot(q8perf_plot_dta, aes(x=q8full_plot_labels, y=q8perf_plot, fill = q8full_plot_labels)) +
  geom_bar(stat="identity", width=0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q8perf_plot),"%"), vjust=-0.3), size=6.5) +
  scale_y_continuous(limits = c(0,100)) +
  labs(x="",y="Percent") +
  scale_x_discrete(labels= c("","","","","")) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(title = "Performer States") +
  disaggtheme

q8frnt_plot_temp <- ggplot(q8frnt_plot_dta, aes(x=q8full_plot_labels, y=q8frnt_plot, fill = q8full_plot_labels)) +
  geom_bar(stat="identity", width=0.5, show.legend = TRUE) + 
  geom_text(aes(label=scales::percent(q8frnt_plot/100)), vjust=-0.3, size=6.5) +
  scale_y_continuous(limits = c(0,100)) +
  labs(x="",y="Percent") +
  scale_x_discrete(labels= c("","","","","")) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(title = "Frontrunner States") +
  disaggtheme

legend8 <- cowplot::get_legend(q8frnt_plot_temp)
q8frnt_plot <- q8frnt_plot_temp +theme(legend.position = "none")
q8_fullsdg <- plot_grid(q8aspt_plot,q8perf_plot,q8frnt_plot, nrow=1)
q8_fullsdg <- plot_grid(q8_fullsdg,legend8, nrow = 2, rel_heights=c(5,2))
q8_fullsdg
```
\newpage

## Question 9: Aggregate Graph 

The unprecedented nature of this pandemic has meant that policy has had to constantly evolve and change to confront the challenges. Explanations for changes have rarely been given to the public. In this context, which statement would you agree with more?

\vspace{6mm}
```{r}
#Aggregate
q9full_mean_ones <- round(weighted.mean(summary_state_analysis$X132ones, summary_state_analysis$state_weight)*100,2) 
q9full_mean_twos <- round(weighted.mean(summary_state_analysis$X132twos, summary_state_analysis$state_weight)*100,2)
q9full_plot <- c(q9full_mean_ones, q9full_mean_twos) 
q9full_plot_labels <- c("Given the lack of consensus in our democracy, any other course of action would have resulted in unnecessary chaos and confusion among the public.","Transparency and greater consultation in policy making could have secured more positive results in terms of greater trust and cooperation from the public.")
q9full_plot_dta <- data.frame(q9full_plot, q9full_plot_labels) 
q9full_plot_dta$wrapped_labels = str_wrap(q9full_plot_dta$q9full_plot_labels, width = 10)
q9full_plot <- ggplot(q9full_plot_dta, aes(x=q9full_plot_labels, y=q9full_plot, fill = q9full_plot_labels)) +
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q9full_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,100)) + 
  scale_x_discrete(labels = function(q9full_plot_labels) str_wrap(q9full_plot_labels, width = 40)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent") +
  newtheme
q9full_plot
```
\newpage

## Question 9: Disaggregated by Age

The unprecedented nature of this pandemic has meant that policy has had to constantly evolve and change to confront the challenges. Explanations for changes have rarely been given to the public. In this context, which statement would you agree with more?

\vspace{6mm}
```{r echo = FALSE, fig.height=10,fig.width=18}
#Age
q9_plotlabels <- c("Given the lack of consensus in our democracy, any other course of action would have resulted in \n unnecessary chaos and confusion among the public.","Transparency and greater consultation in policy making could have secured more positive results in terms of \n greater trust and cooperation from the public.")

q9young_mean_ones <- round(weighted.mean(summary_state_analysis_young$X132ones, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2) 
q9young_mean_twos <- round(weighted.mean(summary_state_analysis_young$X132twos, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2)
q9_young_plot<-c(q9young_mean_ones,q9young_mean_twos)
q9_young_plotdta <- data.frame(q9_young_plot, q9_plotlabels) 
q9_young_plotdta$wrapped_labels = str_wrap(q9_young_plotdta$q9_plotlabels, width = 10)

q9_young_plot <- ggplot(q9_young_plotdta, aes(x = q9_plotlabels, y = q9_young_plot, fill = q9_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q9_young_plot),"%"), vjust=-0.3), size=7)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "2012 and After") +
  disaggtheme

q9old_mean_ones <- round(weighted.mean(summary_state_analysis_old$X132ones, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2) 
q9old_mean_twos <- round(weighted.mean(summary_state_analysis_old$X132twos, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2)
q9_old_plot<-c(q9old_mean_ones,q9old_mean_twos)
q9_old_plotdta <- data.frame(q9_old_plot, q9_plotlabels) 
q9_old_plotdta$wrapped_labels = str_wrap(q9_old_plotdta$q9_plotlabels, width = 10)

q9_old_plot <- ggplot(q9_old_plotdta, aes(x = q9_plotlabels, y = q9_old_plot, fill = q9_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q9_old_plot),"%"), vjust=-0.3), size=7)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "2011 and Before") +
  disaggtheme

q9_former_plot<-c(summary_state_former$X132ones*100, summary_state_former$X132twos*100)
q9_former_plotdta <- data.frame(q9_former_plot, q9_plotlabels) 
q9_former_plotdta$wrapped_labels = str_wrap(q9_former_plotdta$q9_plotlabels, width = 10)

q9_former_plot <- ggplot(q9_former_plotdta, aes(x = q9_plotlabels, y = q9_former_plot, fill = q9_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q9_former_plot),"%"), vjust=-0.3), size=7)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "Former Officers") +
  disaggtheme

legend9 <- cowplot::get_legend(q9_former_plot) 
q9_former_plot <- q9_former_plot +theme(legend.position = "none")
plot9_fullage <- plot_grid(q9_young_plot,q9_old_plot,q9_former_plot,
                             nrow = 1)
plot9_fullage <- plot_grid(plot9_fullage, legend9, nrow = 2, rel_heights=c(5,2)) 
plot9_fullage
```
\newpage

## Question 9: Disaggregated by SDG

The unprecedented nature of this pandemic has meant that policy has had to constantly evolve and change to confront the challenges. Explanations for changes have rarely been given to the public. In this context, which statement would you agree with more?

\vspace{6mm}
```{r, echo = FALSE, fig.height=10,fig.width=18}
#Calculating weighted means
q9aspt_mean_ones <- round(weighted.mean(summary_state_analysis$X132ones[summary_state_analysis$sdg_tier=="Aspirant"],
summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2) 
q9aspt_mean_twos <- round(weighted.mean(summary_state_analysis$X132twos[summary_state_analysis$sdg_tier=="Aspirant"],
summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)

q9perf_mean_ones <- round(weighted.mean(summary_state_analysis$X132ones[summary_state_analysis$sdg_tier=="Performer"],
summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2) 
q9perf_mean_twos <- round(weighted.mean(summary_state_analysis$X132twos[summary_state_analysis$sdg_tier=="Performer"],
summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)

q9frnt_mean_ones <- round(weighted.mean(summary_state_analysis$X132ones[summary_state_analysis$sdg_tier=="Frontrunner"],
summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2) 
q9frnt_mean_twos <- round(weighted.mean(summary_state_analysis$X132twos[summary_state_analysis$sdg_tier=="Frontrunner"],
summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)

#Forming vectors
q9aspt_plot <- c(q9aspt_mean_ones, q9aspt_mean_twos) 
q9perf_plot <- c(q9perf_mean_ones, q9perf_mean_twos)
q9frnt_plot <- c(q9frnt_mean_ones, q9frnt_mean_twos)
q9full_plot_labels <- c("Given the lack of consensus in our democracy, any other course of action would have resulted in \n unnecessary chaos and confusion among the public.","Transparency and greater consultation in policy making could have secured more positive results in terms of \n greater trust and cooperation from the public.")

#Constructing Data Frames
q9aspt_plot_dta <- data.frame(q9aspt_plot, q9full_plot_labels) 
q9perf_plot_dta <- data.frame(q9perf_plot, q9full_plot_labels) 
q9frnt_plot_dta <- data.frame(q9frnt_plot, q9full_plot_labels) 

#Wrapping labels
q9aspt_plot_dta$wrapped_labels = str_wrap(q9aspt_plot_dta$q9full_plot_label, width = 10)
q9perf_plot_dta$wrapped_labels = str_wrap(q9perf_plot_dta$q9full_plot_label, width = 10)
q9frnt_plot_dta$wrapped_labels = str_wrap(q9frnt_plot_dta$q9full_plot_label, width = 10)

#Invoking ggplot
q9aspt_plot <- ggplot(q9aspt_plot_dta, aes(x=q9full_plot_labels, y=q9aspt_plot, fill = q9full_plot_labels)) +
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q9aspt_plot),"%"), vjust=-0.3), size=7) +
  scale_y_continuous(limits = c(0,100)) +  
  scale_x_discrete(labels= c("","","","","")) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "Aspirant States") +
  disaggtheme

q9perf_plot <- ggplot(q9perf_plot_dta, aes(x=q9full_plot_labels, y=q9perf_plot, fill = q9full_plot_labels)) +
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q9perf_plot),"%"), vjust=-0.3), size=7) +
  scale_y_continuous(limits = c(0,100)) +  
  scale_x_discrete(labels= c("","","","","")) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "Performer States") +
  disaggtheme

q9frnt_plot_temp <- ggplot(q9frnt_plot_dta, aes(x=q9full_plot_labels, y=q9frnt_plot, fill = q9full_plot_labels)) +
  geom_bar(stat="identity", width= 0.5, show.legend = TRUE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q9frnt_plot),"%"), vjust=-0.3), size=7) +
  scale_y_continuous(limits = c(0,100)) +  
  scale_x_discrete(labels= c("","","","","")) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "Frontrunner States") +
  disaggtheme

legend9 <- cowplot::get_legend(q9frnt_plot_temp)
q9frnt_plot <- q9frnt_plot_temp +theme(legend.position = "none")
q9_fullsdg <- plot_grid(q9aspt_plot,q9perf_plot,q9frnt_plot, nrow=1)
q9_fullsdg <- plot_grid(q9_fullsdg,legend9, nrow = 2, rel_heights=c(5,2))
q9_fullsdg
```
\newpage

## Question 10: Aggregate Graph

India’s vaccine procurement policy has undergone multiple changes in a short span of time. What, in your opinion, best explains these frequent changes?

\vspace{6mm}
```{r}
#Aggregate
q10full_mean_ones <- round(weighted.mean(summary_state_analysis$X133ones, summary_state_analysis$state_weight)*100,2) 
q10full_mean_twos <- round(weighted.mean(summary_state_analysis$X133twos, summary_state_analysis$state_weight)*100,2) 
q10full_mean_threes <- round(weighted.mean(summary_state_analysis$X133threes, summary_state_analysis$state_weight)*100,2)
q10full_plot <- c(q10full_mean_ones, q10full_mean_twos, q10full_mean_threes) 
q10full_plot_labels <- c("During the pandemic, policy has exhibited a rational response to changing evidence and information about the pandemic.","Even though the pandemic posed unique challenges, policy making could still be characterised as ad hoc, responding to political imperatives, public pressure and judicial pronouncements.","In the pandemic context policy making has followed a natural and inevitable course given the diverse, federal nature of our country.") 
q10full_plot_dta <- data.frame(q10full_plot, q10full_plot_labels) 
q10full_plot_dta$wrapped_labels = str_wrap(q10full_plot_dta$q10full_plot_labels, width = 10)
q10full_plot <- ggplot(q10full_plot_dta, aes(x=q10full_plot_labels, y=q10full_plot, fill = q10full_plot_labels)) +
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q10full_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,100)) +
  scale_x_discrete(labels = function(q10full_plot_labels) str_wrap(q10full_plot_labels, width = 30)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent") +
  newtheme
q10full_plot
```
\newpage

## Question 10: Disaggregated by Age

India’s vaccine procurement policy has undergone multiple changes in a short span of time. What, in your opinion, best explains these frequent changes?

\vspace{6mm}
```{r echo = FALSE, fig.height=10,fig.width=18}
q10_plotlabels <- c("During the pandemic, policy has exhibited a rational response to changing evidence and information \n about the pandemic.","Even though the pandemic posed unique challenges, policy making could still be characterised as ad hoc, \n responding to political imperatives, public pressure and judicial pronouncements.","In the pandemic context policy making has followed a natural and inevitable course given \n the diverse, federal nature of our country.")

q10young_mean_ones <- round(weighted.mean(summary_state_analysis_young$X133ones, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2) 
q10young_mean_twos <- round(weighted.mean(summary_state_analysis_young$X133twos, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2)
q10young_mean_threes <- round(weighted.mean(summary_state_analysis_young$X133threes, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2)
q10_young_plot<-c(q10young_mean_ones,q10young_mean_twos,q10young_mean_threes)
q10_young_plotdta <- data.frame(q10_young_plot, q10_plotlabels) 
q10_young_plotdta$wrapped_labels = str_wrap(q10_young_plotdta$q10_plotlabels, width = 10)

q10_young_plot <- ggplot(q10_young_plotdta, aes(x = q10_plotlabels, y = q10_young_plot, fill = q10_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q10_young_plot),"%"), vjust=-0.3), size=6)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "2012 and After") +
  disaggtheme

q10old_mean_ones <- round(weighted.mean(summary_state_analysis_old$X133ones, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2) 
q10old_mean_twos <- round(weighted.mean(summary_state_analysis_old$X133twos, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2)
q10old_mean_threes <- round(weighted.mean(summary_state_analysis_old$X133threes, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2)
q10_old_plot<-c(q10old_mean_ones,q10old_mean_twos,q10old_mean_threes)
q10_old_plotdta <- data.frame(q10_old_plot, q10_plotlabels) 
q10_old_plotdta$wrapped_labels = str_wrap(q10_old_plotdta$q10_plotlabels, width = 10)

q10_old_plot <- ggplot(q10_old_plotdta, aes(x = q10_plotlabels, y = q10_old_plot, fill = q10_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q10_old_plot),"%"), vjust=-0.3), size=6)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "2011 and Before") +
  disaggtheme

q10_former_plot<-c(summary_state_former$X133ones*100, summary_state_former$X133twos*100, summary_state_former$X133threes*100)
q10_former_plotdta <- data.frame(q10_former_plot, q10_plotlabels) 
q10_former_plotdta$wrapped_labels = str_wrap(q10_former_plotdta$q10_plotlabels, width = 10)

q10_former_plot <- ggplot(q10_former_plotdta, aes(x = q10_plotlabels, y = q10_former_plot, fill = q10_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q10_former_plot),"%"), vjust=-0.3), size=6)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "Former Officers") +
  disaggtheme

legend10 <- cowplot::get_legend(q10_former_plot) 
q10_former_plot <- q10_former_plot +theme(legend.position = "none")
plot10_fullage <- plot_grid(q10_young_plot,q10_old_plot,q10_former_plot,
                             nrow = 1)
plot10_fullage <- plot_grid(plot10_fullage, legend10, nrow = 2, rel_heights=c(5,2)) 
plot10_fullage
```
\newpage

## Question 10: Disaggregated by SDG

India’s vaccine procurement policy has undergone multiple changes in a short span of time. What, in your opinion, best explains these frequent changes?

\vspace{6mm}

```{r, echo = FALSE, fig.height=10,fig.width=18}
#Calculating weighted means
q10aspt_mean_ones <- round(weighted.mean(summary_state_analysis$X133ones[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)
q10aspt_mean_twos <- round(weighted.mean(summary_state_analysis$X133twos[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)
q10aspt_mean_threes <- round(weighted.mean(summary_state_analysis$X133threes[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)

q10frnt_mean_ones <- round(weighted.mean(summary_state_analysis$X133ones[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)
q10frnt_mean_twos <- round(weighted.mean(summary_state_analysis$X133twos[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)
q10frnt_mean_threes <- round(weighted.mean(summary_state_analysis$X133threes[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)

q10perf_mean_ones <- round(weighted.mean(summary_state_analysis$X133ones[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)
q10perf_mean_twos <- round(weighted.mean(summary_state_analysis$X133twos[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)
q10perf_mean_threes <- round(weighted.mean(summary_state_analysis$X133threes[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)

#Forming vectors 
q10aspt_plot <- c(q10aspt_mean_ones, q10aspt_mean_twos, q10aspt_mean_threes)
q10frnt_plot <- c(q10frnt_mean_ones, q10frnt_mean_twos, q10frnt_mean_threes)
q10perf_plot <- c(q10perf_mean_ones, q10perf_mean_twos, q10perf_mean_threes)

q10full_plot_labels <- c("During the pandemic, policy has exhibited a rational response to changing evidence and information \n about the pandemic.","Even though the pandemic posed unique challenges, policy making could still be characterised as ad hoc, \n responding to political imperatives, public pressure and judicial pronouncements.","In the pandemic context policy making has followed a natural and inevitable course given \n the diverse, federal nature of our country.")

#constructing data frames
q10aspt_plot_dta <- data.frame(q10aspt_plot, q10full_plot_labels)
q10frnt_plot_dta <- data.frame(q10frnt_plot, q10full_plot_labels)
q10perf_plot_dta <- data.frame(q10perf_plot, q10full_plot_labels)

#wrapping labels
q10aspt_plot_dta$wrapped_labels = str_wrap(q10aspt_plot_dta$q10full_plot_labels, width = 50)
q10frnt_plot_dta$wrapped_labels = str_wrap(q10frnt_plot_dta$q10full_plot_labels, width = 50)
q10perf_plot_dta$wrapped_labels = str_wrap(q10perf_plot_dta$q10full_plot_labels, width = 50)

#Invoking ggplot
q10aspt_plot <- ggplot(q10aspt_plot_dta, aes(x=q10full_plot_labels, y=q10aspt_plot, fill = q10full_plot_labels)) +
  geom_bar(stat="identity", width=0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q10aspt_plot),"%"), vjust=-0.3), size=6) +
  scale_y_continuous(limits = c(0,100))  +
  labs(x="",y="Percent")  +
  scale_x_discrete(labels= c("","","","","")) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(title ="Aspirant States") +
  disaggtheme

q10perf_plot <- ggplot(q10perf_plot_dta, aes(x=q10full_plot_labels, y=q10perf_plot, fill = q10full_plot_labels)) +
  geom_bar(stat="identity", width=0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q10perf_plot),"%"), vjust=-0.3), size=6) +
  scale_y_continuous(limits = c(0,100)) +
  labs(x="",y="Percent") +
  scale_x_discrete(labels= c("","","","","")) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(title = "Performer States") +
  disaggtheme

q10frnt_plot_temp <- ggplot(q10frnt_plot_dta, aes(x=q10full_plot_labels, y=q10frnt_plot, fill = q10full_plot_labels)) +
  geom_bar(stat="identity", width=0.5, show.legend = TRUE) + 
  geom_text(aes(label=scales::percent(q10frnt_plot/100)), vjust=-0.3, size=6) +
  scale_y_continuous(limits = c(0,100)) +
  labs(x="",y="Percent") +
  scale_x_discrete(labels= c("","","","","")) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(title = "Frontrunner States") +
  disaggtheme

legend10<- cowplot::get_legend(q10frnt_plot_temp)
q10frnt_plot <- q10frnt_plot_temp +theme(legend.position = "none")
q10_fullsdg <- plot_grid(q10aspt_plot,q10perf_plot,q10frnt_plot, nrow=1)
q10_fullsdg <- plot_grid(q10_fullsdg,legend10, nrow = 2, rel_heights=c(5,2))
q10_fullsdg
```
\newpage

## Question 11: Aggregate Graph

Successful vaccination policy across most of the world has prioritised high risk segments (such as the aged, those with comorbidities, and frontline workers) followed by a rapid coverage of a minimum threshold number in the general population. Which statement in your opinion best characterises India’s implementation of such a vaccination policy?

\vspace{6mm}
```{r}
#Aggregate
q11full_mean_ones <- round(weighted.mean(summary_state_analysis$X134ones, summary_state_analysis$state_weight)*100,2) 
q11full_mean_twos <- round(weighted.mean(summary_state_analysis$X134twos, summary_state_analysis$state_weight)*100,2) 
q11full_mean_threes <- round(weighted.mean(summary_state_analysis$X134threes, summary_state_analysis$state_weight)*100,2)
q11full_mean_fours <- round(weighted.mean(summary_state_analysis$X134fours, summary_state_analysis$state_weight)*100,2)
q11full_plot <- c(q11full_mean_ones, q11full_mean_twos, q11full_mean_threes, q11full_mean_fours) 
q11full_plot_labels <- c("India has successfully followed this nationally laid down trajectory of vaccine implementation.", "Our vaccination efforts have been adequate in following this trajectory though some states could have done better.", "Our vaccination policy implementation has been less than satisfactory because of poor performance at state level.", "Our vaccination policy implementation has been poor due to lack of clear and consistent national direction.") 
q11full_plot_dta <- data.frame(q11full_plot, q11full_plot_labels) 
q11full_plot_dta$wrapped_labels = str_wrap(q11full_plot_dta$q11full_plot_labels, width = 50)
q11full_plot <- ggplot(q11full_plot_dta, aes(x=q11full_plot_labels, y=q11full_plot, fill = q11full_plot_labels)) +
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q11full_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,100)) +
  scale_x_discrete(labels = function(q11full_plot_labels) str_wrap(q11full_plot_labels, width = 20)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent") +
  newtheme
q11full_plot
```
\newpage

## Question 11: Dis-ggregated by Age

Successful vaccination policy across most of the world has prioritised high risk segments (such as the aged, those with comorbidities, and frontline workers) followed by a rapid coverage of a minimum threshold number in the general population. Which statement in your opinion best characterises India’s implementation of such a vaccination policy?

\vspace{6mm}
```{r echo = FALSE, fig.height=10,fig.width=18}
#Age
q11_plotlabels <- c("India has successfully followed this nationally laid down trajectory of vaccine implementation.", "Our vaccination efforts have been adequate in following this trajectory though some states could \n have done better.", "Our vaccination policy implementation has been less than satisfactory because of poor performance \n at state level.", "Our vaccination policy implementation has been poor due to lack of clear and consistent national direction.")

q11young_mean_ones <- round(weighted.mean(summary_state_analysis_young$X134ones, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2) 
q11young_mean_twos <- round(weighted.mean(summary_state_analysis_young$X134twos, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2)
q11young_mean_threes <- round(weighted.mean(summary_state_analysis_young$X134threes, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2)
q11young_mean_fours <- round(weighted.mean(summary_state_analysis_young$X134fours, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2)
q11_young_plot<-c(q11young_mean_ones,q11young_mean_twos,q11young_mean_threes,q11young_mean_fours)
q11_young_plotdta <- data.frame(q11_young_plot, q11_plotlabels) 
q11_young_plotdta$wrapped_labels = str_wrap(q11_young_plotdta$q11_plotlabels, width = 10)

q11_young_plot <- ggplot(q11_young_plotdta, aes(x = q11_plotlabels, y = q11_young_plot, fill = q11_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q11_young_plot),"%"), vjust=-0.3), size=6)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "2012 and After") +
  disaggtheme

q11old_mean_ones <- round(weighted.mean(summary_state_analysis_old$X134ones, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2) 
q11old_mean_twos <- round(weighted.mean(summary_state_analysis_old$X134twos, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2)
q11old_mean_threes <- round(weighted.mean(summary_state_analysis_old$X134threes, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2)
q11old_mean_fours <- round(weighted.mean(summary_state_analysis_old$X134fours, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2)
q11_old_plot<-c(q11old_mean_ones,q11old_mean_twos,q11old_mean_threes,q11old_mean_fours)
q11_old_plotdta <- data.frame(q11_old_plot, q11_plotlabels) 
q11_old_plotdta$wrapped_labels = str_wrap(q11_old_plotdta$q11_plotlabels, width = 10)

q11_old_plot <- ggplot(q11_old_plotdta, aes(x = q11_plotlabels, y = q11_old_plot, fill = q11_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q11_old_plot),"%"), vjust=-0.3), size=6)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "2011 and Before") +
  disaggtheme

q11_former_plot<-c(summary_state_former$X134ones*100, summary_state_former$X134twos*100, summary_state_former$X134threes*100, summary_state_former$X134fours*100)
q11_former_plotdta <- data.frame(q11_former_plot, q11_plotlabels) 
q11_former_plotdta$wrapped_labels = str_wrap(q11_former_plotdta$q11_plotlabels, width = 10)

q11_former_plot <- ggplot(q11_former_plotdta, aes(x = q11_plotlabels, y = q11_former_plot, fill = q11_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q11_former_plot),"%"), vjust=-0.3), size=6)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "Former Officers") +
  disaggtheme

legend11 <- cowplot::get_legend(q11_former_plot) 
q11_former_plot <- q11_former_plot +theme(legend.position = "none")
plot11_fullage <- plot_grid(q11_young_plot,q11_old_plot,q11_former_plot,
                             nrow = 1)
plot11_fullage <- plot_grid(plot11_fullage, legend11, nrow = 2, rel_heights=c(5,2)) 
plot11_fullage
```
\newpage

## Question 11: Dis-ggregated by SDG

Successful vaccination policy across most of the world has prioritised high risk segments (such as the aged, those with comorbidities, and frontline workers) followed by a rapid coverage of a minimum threshold number in the general population. Which statement in your opinion best characterises India’s implementation of such a vaccination policy?

\vspace{6mm}
```{r, echo = FALSE, fig.height=10,fig.width=18}
#Calculating weighted means
q11aspt_mean_ones <- round(weighted.mean(summary_state_analysis$X134ones[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)
q11aspt_mean_twos <- round(weighted.mean(summary_state_analysis$X134twos[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)
q11aspt_mean_threes <- round(weighted.mean(summary_state_analysis$X134threes[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)
q11aspt_mean_fours <- round(weighted.mean(summary_state_analysis$X134fours[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)

q11frnt_mean_ones <- round(weighted.mean(summary_state_analysis$X134ones[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)
q11frnt_mean_twos <- round(weighted.mean(summary_state_analysis$X134twos[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)
q11frnt_mean_threes <- round(weighted.mean(summary_state_analysis$X134threes[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)
q11frnt_mean_fours <- round(weighted.mean(summary_state_analysis$X134fours[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)

q11perf_mean_ones <- round(weighted.mean(summary_state_analysis$X134ones[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)
q11perf_mean_twos <- round(weighted.mean(summary_state_analysis$X134twos[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)
q11perf_mean_threes <- round(weighted.mean(summary_state_analysis$X134threes[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)
q11perf_mean_fours <- round(weighted.mean(summary_state_analysis$X134fours[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)

#Forming vectors 
q11aspt_plot <- c(q11aspt_mean_ones, q11aspt_mean_twos, q11aspt_mean_threes, q11aspt_mean_fours)
q11frnt_plot <- c(q11frnt_mean_ones, q11frnt_mean_twos, q11frnt_mean_threes, q11frnt_mean_fours)
q11perf_plot <- c(q11perf_mean_ones, q11perf_mean_twos, q11perf_mean_threes, q11perf_mean_fours)

q11full_plot_labels <- c("India has successfully followed this nationally laid down trajectory of vaccine implementation.", "Our vaccination efforts have been adequate in following this trajectory though some states could \n have done better.", "Our vaccination policy implementation has been less than satisfactory because of poor performance \n at state level.", "Our vaccination policy implementation has been poor due to lack of clear and consistent national direction.") 

#constructing data frames
q11aspt_plot_dta <- data.frame(q11aspt_plot, q11full_plot_labels)
q11frnt_plot_dta <- data.frame(q11frnt_plot, q11full_plot_labels)
q11perf_plot_dta <- data.frame(q11perf_plot, q11full_plot_labels)

#wrapping labels
q11aspt_plot_dta$wrapped_labels = str_wrap(q11aspt_plot_dta$q11full_plot_labels, width = 50)
q11frnt_plot_dta$wrapped_labels = str_wrap(q11frnt_plot_dta$q11full_plot_labels, width = 50)
q11perf_plot_dta$wrapped_labels = str_wrap(q11perf_plot_dta$q11full_plot_labels, width = 50)

#Invoking ggplot
q11aspt_plot <- ggplot(q11aspt_plot_dta, aes(x=q11full_plot_labels, y=q11aspt_plot, fill = q11full_plot_labels)) +
  geom_bar(stat="identity", width=0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q11aspt_plot),"%"), vjust=-0.3), size=6) +
  scale_y_continuous(limits = c(0,100))  +
  labs(x="",y="Percent")  +
  scale_x_discrete(labels= c("","","","","")) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(title = "Aspirant States") +
  disaggtheme

q11perf_plot <- ggplot(q11perf_plot_dta, aes(x=q11full_plot_labels, y=q11perf_plot, fill = q11full_plot_labels)) +
  geom_bar(stat="identity", width=0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q11perf_plot),"%"), vjust=-0.3), size=6) +
  scale_y_continuous(limits = c(0,100)) +
  labs(x="",y="Percent") +
  scale_x_discrete(labels= c("","","","","")) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(title = "Performer States") +
  disaggtheme

q11frnt_plot_temp <- ggplot(q11frnt_plot_dta, aes(x=q11full_plot_labels, y=q11frnt_plot, fill = q11full_plot_labels)) +
  geom_bar(stat="identity", width=0.5, show.legend = TRUE) + 
  geom_text(aes(label=scales::percent(q11frnt_plot/100)), vjust=-0.3, size=6) +
  scale_y_continuous(limits = c(0,100)) +
  labs(x="",y="Percent") +
  scale_x_discrete(labels= c("","","","","")) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(title = "Frontrunner States") +
  disaggtheme

legend11 <- cowplot::get_legend(q11frnt_plot_temp)
q11frnt_plot <- q11frnt_plot_temp +theme(legend.position = "none")
q11_fullsdg <- plot_grid(q11aspt_plot,q11perf_plot,q11frnt_plot, nrow=1)
q11_fullsdg <- plot_grid(q11_fullsdg,legend11, nrow = 2, rel_heights=c(5,2))
q11_fullsdg
```
\newpage

## Question 12: Aggregate Graph 

Choose the option that best describes the overriding feeling among IAS officers during the peak of the second wave when the scale and human consequences of the Covid-19 pandemic across many parts of the country were palpable to all.

\vspace{6mm}
```{r}
q12full_mean_ones <- round(weighted.mean(summary_state_analysis$X135ones, summary_state_analysis$state_weight)*100,2) 
q12full_mean_twos <- round(weighted.mean(summary_state_analysis$X135twos, summary_state_analysis$state_weight)*100,2) 
q12full_mean_threes <- round(weighted.mean(summary_state_analysis$X135threes, summary_state_analysis$state_weight)*100,2)
q12full_mean_fours <- round(weighted.mean(summary_state_analysis$X135fours, summary_state_analysis$state_weight)*100,2)
q12full_plot <- c(q12full_mean_ones, q12full_mean_twos, q12full_mean_threes, q12full_mean_fours) 
q12full_plot_labels <- c("We could at least use our networks to render some assistance at an individual level.", "We should have done so much more to improve the system when we had the time.", "We were as deprived and helpless as the ordinary citizen, in the face of this utter collapse of the health care system.", "We were proud that our colleagues were able to deliver so much despite such adverse circumstances.") 
q12full_plot_dta <- data.frame(q12full_plot, q12full_plot_labels) 
q12full_plot_dta$wrapped_labels = str_wrap(q12full_plot_dta$q12full_plot_labels, width = 50)
q12full_plot <- ggplot(q12full_plot_dta, aes(x=q12full_plot_labels, y=q12full_plot, fill = q12full_plot_labels)) +
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q12full_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,100)) +
  scale_x_discrete(labels = function(q12full_plot_labels) str_wrap(q12full_plot_labels, width = 20)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent") +
  newtheme
q12full_plot
```
\newpage

## Question 12: Disaggregated by Age

Choose the option that best describes the overriding feeling among IAS officers during the peak of the second wave when the scale and human consequences of the Covid-19 pandemic across many parts of the country were palpable to all.

\vspace{6mm}
```{r echo = FALSE, fig.height=10,fig.width=18}
q12_plotlabels <- c("We could at least use our networks to render some assistance at an individual level.", "We should have done so much more to improve the system when we had the time.", "We were as deprived and helpless as the ordinary citizen, in the face of this utter collapse of the \n health care system.", "We were proud that our colleagues were able to deliver so much despite such adverse circumstances.")

q12young_mean_ones <- round(weighted.mean(summary_state_analysis_young$X135ones, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2) 
q12young_mean_twos <- round(weighted.mean(summary_state_analysis_young$X135twos, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2)
q12young_mean_threes <- round(weighted.mean(summary_state_analysis_young$X135threes, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2)
q12young_mean_fours <- round(weighted.mean(summary_state_analysis_young$X135fours, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2)
q12_young_plot<-c(q12young_mean_ones,q12young_mean_twos,q12young_mean_threes,q12young_mean_fours)
q12_young_plotdta <- data.frame(q12_young_plot, q12_plotlabels) 
q12_young_plotdta$wrapped_labels = str_wrap(q12_young_plotdta$q12_plotlabels, width = 10)

q12_young_plot <- ggplot(q12_young_plotdta, aes(x = q12_plotlabels, y = q12_young_plot, fill = q12_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q12_young_plot),"%"), vjust=-0.3), size=6)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "2012 and After") +
  disaggtheme

q12old_mean_ones <- round(weighted.mean(summary_state_analysis_old$X135ones, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2) 
q12old_mean_twos <- round(weighted.mean(summary_state_analysis_old$X135twos, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2)
q12old_mean_threes <- round(weighted.mean(summary_state_analysis_old$X135threes, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2)
q12old_mean_fours <- round(weighted.mean(summary_state_analysis_old$X135fours, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2)
q12_old_plot<-c(q12old_mean_ones,q12old_mean_twos,q12old_mean_threes,q12old_mean_fours)
q12_old_plotdta <- data.frame(q12_old_plot, q12_plotlabels) 
q12_old_plotdta$wrapped_labels = str_wrap(q12_old_plotdta$q12_plotlabels, width = 10)

q12_old_plot <- ggplot(q12_old_plotdta, aes(x = q12_plotlabels, y = q12_old_plot, fill = q12_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q12_old_plot),"%"), vjust=-0.3), size=6)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "2011 and Before") +
  disaggtheme

q12_former_plot<-c(summary_state_former$X135ones*100, summary_state_former$X135twos*100, summary_state_former$X135threes*100, summary_state_former$X135fours*100)
q12_former_plotdta <- data.frame(q12_former_plot, q12_plotlabels) 
q12_former_plotdta$wrapped_labels = str_wrap(q12_former_plotdta$q12_plotlabels, width = 10)

q12_former_plot <- ggplot(q12_former_plotdta, aes(x = q12_plotlabels, y = q12_former_plot, fill = q12_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q12_former_plot),"%"), vjust=-0.3), size=6)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "Former Officers") +
  disaggtheme

legend12 <- cowplot::get_legend(q12_former_plot) 
q12_former_plot <- q12_former_plot +theme(legend.position = "none")
plot12_fullage <- plot_grid(q12_young_plot,q12_old_plot,q12_former_plot,
                             nrow = 1)
plot12_fullage <- plot_grid(plot12_fullage, legend12, nrow = 2, rel_heights=c(5,2)) 
plot12_fullage
```
\newpage

## Question 12: Disaggregated by SDG

Choose the option that best describes the overriding feeling among IAS officers during the peak of the second wave when the scale and human consequences of the Covid-19 pandemic across many parts of the country were palpable to all.

\vspace{6mm}
```{r, echo = FALSE, fig.height=10,fig.width=18}
#Calculating weighted means
q12aspt_mean_ones <- round(weighted.mean(summary_state_analysis$X135ones[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)
q12aspt_mean_twos <- round(weighted.mean(summary_state_analysis$X135twos[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)
q12aspt_mean_threes <- round(weighted.mean(summary_state_analysis$X135threes[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)
q12aspt_mean_fours <- round(weighted.mean(summary_state_analysis$X135fours[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)

q12frnt_mean_ones <- round(weighted.mean(summary_state_analysis$X135ones[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)
q12frnt_mean_twos <- round(weighted.mean(summary_state_analysis$X135twos[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)
q12frnt_mean_threes <- round(weighted.mean(summary_state_analysis$X135threes[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)
q12frnt_mean_fours <- round(weighted.mean(summary_state_analysis$X135fours[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)

q12perf_mean_ones <- round(weighted.mean(summary_state_analysis$X135ones[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)
q12perf_mean_twos <- round(weighted.mean(summary_state_analysis$X135twos[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)
q12perf_mean_threes <- round(weighted.mean(summary_state_analysis$X135threes[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)
q12perf_mean_fours <- round(weighted.mean(summary_state_analysis$X135fours[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)

#Forming vectors 
q12aspt_plot <- c(q12aspt_mean_ones, q12aspt_mean_twos, q12aspt_mean_threes, q12aspt_mean_fours)
q12frnt_plot <- c(q12frnt_mean_ones, q12frnt_mean_twos, q12frnt_mean_threes, q12frnt_mean_fours)
q12perf_plot <- c(q12perf_mean_ones, q12perf_mean_twos, q12perf_mean_threes, q12perf_mean_fours)

q12full_plot_labels <- c("We could at least use our networks to render some assistance at an individual level.", "We should have done so much more to improve the system when we had the time.", "We were as deprived and helpless as the ordinary citizen, in the face of this utter collapse of the \n health care system.", "We were proud that our colleagues were able to deliver so much despite such adverse circumstances.")

#constructing data frames
q12aspt_plot_dta <- data.frame(q12aspt_plot, q12full_plot_labels)
q12frnt_plot_dta <- data.frame(q12frnt_plot, q12full_plot_labels)
q12perf_plot_dta <- data.frame(q12perf_plot, q12full_plot_labels)

#wrapping labels
q12aspt_plot_dta$wrapped_labels = str_wrap(q12aspt_plot_dta$q12full_plot_labels, width = 50)
q12frnt_plot_dta$wrapped_labels = str_wrap(q12frnt_plot_dta$q12full_plot_labels, width = 50)
q12perf_plot_dta$wrapped_labels = str_wrap(q12perf_plot_dta$q12full_plot_labels, width = 50)

#Invoking ggplot
q12aspt_plot <- ggplot(q12aspt_plot_dta, aes(x=q12full_plot_labels, y=q12aspt_plot, fill = q12full_plot_labels)) +
  geom_bar(stat="identity", width=0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q12aspt_plot),"%"), vjust=-0.3), size=6) +
  scale_y_continuous(limits = c(0,100))  +
  labs(x="",y="Percent")  +
  scale_x_discrete(labels= c("","","","","")) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(title ="Aspirant States") +
  disaggtheme

q12perf_plot <- ggplot(q12perf_plot_dta, aes(x=q12full_plot_labels, y=q12perf_plot, fill = q12full_plot_labels)) +
  geom_bar(stat="identity", width=0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q12perf_plot),"%"), vjust=-0.3), size=6) +
  scale_y_continuous(limits = c(0,100)) +
  labs(x="",y="Percent") +
  scale_x_discrete(labels= c("","","","","")) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(title = "Performer States") +
  disaggtheme

q12frnt_plot_temp <- ggplot(q12frnt_plot_dta, aes(x=q12full_plot_labels, y=q12frnt_plot, fill = q12full_plot_labels)) +
  geom_bar(stat="identity", width=0.5, show.legend = TRUE) + 
  geom_text(aes(label=scales::percent(q12frnt_plot/100)), vjust=-0.3, size=6) +
  scale_y_continuous(limits = c(0,100)) +
  labs(x="",y="Percent") +
  scale_x_discrete(labels= c("","","","","")) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(title = "Frontrunner States") +
  disaggtheme

legend12 <- cowplot::get_legend(q12frnt_plot_temp)
q12frnt_plot <- q12frnt_plot_temp +theme(legend.position = "none")
q12_fullsdg <- plot_grid(q12aspt_plot,q12perf_plot,q12frnt_plot, nrow=1)
q12_fullsdg <- plot_grid(q12_fullsdg,legend12, nrow = 2, rel_heights=c(5,2))
q12_fullsdg
```
\newpage

## Question 14: Aggregate Graph

The government support for India’s huge vaccine production capacity appears to have been limited compared to many other countries. Pick the option that you think is the most important reason.  

\vspace{6mm}
```{r}
q14full_mean_ones <- round(weighted.mean(summary_state_analysis$X137ones, summary_state_analysis$state_weight)*100,2) 
q14full_mean_twos <- round(weighted.mean(summary_state_analysis$X137twos, summary_state_analysis$state_weight)*100,2) 
q14full_mean_threes <- round(weighted.mean(summary_state_analysis$X137threes, summary_state_analysis$state_weight)*100,2)
q14full_mean_fours <- round(weighted.mean(summary_state_analysis$X137fours, summary_state_analysis$state_weight)*100,2)
q14full_plot <- c(q14full_mean_ones, q14full_mean_twos, q14full_mean_threes, q14full_mean_fours) 
q14full_plot_labels <- c("The government's fiscal situation did not permit such measures.", "The pandemic's limited initial impact led to a view that mass vaccination would not be urgently required in India.", "The private sector in India does not inspire confidence.", "The private sector makes profits and should therefore assume the risk involved.") 
q14full_plot_dta <- data.frame(q14full_plot, q14full_plot_labels) 
q14full_plot_dta$wrapped_labels = str_wrap(q14full_plot_dta$q14full_plot_labels, width = 50)
q14full_plot <- ggplot(q14full_plot_dta, aes(x=q14full_plot_labels, y=q14full_plot, fill = q14full_plot_labels)) +
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=scales::percent(q14full_plot/100)), vjust=-0.3, size=3.5) +
  scale_y_continuous(limits = c(0,100)) +
  scale_x_discrete(labels = function(q14full_plot_labels) str_wrap(q14full_plot_labels, width = 20)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent") +
  newtheme
q14full_plot
```
\newpage

## Question 14: Disaggregated by Age

The government support for India’s huge vaccine production capacity appears to have been limited compared to many other countries. Pick the option that you think is the most important reason.  

\vspace{6mm}
```{r echo = FALSE, fig.height=10,fig.width=18}
q14_plotlabels <- c("The government's fiscal situation did not permit such measures.", "The pandemic's limited initial impact led to a view that mass vaccination would not be urgently \n required in India.", "The private sector in India does not inspire confidence.", "The private sector makes profits and should therefore assume the risk involved.")

q14young_mean_ones <- round(weighted.mean(summary_state_analysis_young$X137ones, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2) 
q14young_mean_twos <- round(weighted.mean(summary_state_analysis_young$X137twos, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2)
q14young_mean_threes <- round(weighted.mean(summary_state_analysis_young$X137threes, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2)
q14young_mean_fours <- round(weighted.mean(summary_state_analysis_young$X137fours, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2)
q14_young_plot<-c(q14young_mean_ones,q14young_mean_twos,q14young_mean_threes,q14young_mean_fours)
q14_young_plotdta <- data.frame(q14_young_plot, q14_plotlabels) 
q14_young_plotdta$wrapped_labels = str_wrap(q14_young_plotdta$q14_plotlabels, width = 10)

q14_young_plot <- ggplot(q14_young_plotdta, aes(x = q14_plotlabels, y = q14_young_plot, fill = q14_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q14_young_plot),"%"), vjust=-0.3), size=6)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "2012 and After") +
  disaggtheme

q14old_mean_ones <- round(weighted.mean(summary_state_analysis_old$X137ones, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2) 
q14old_mean_twos <- round(weighted.mean(summary_state_analysis_old$X137twos, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2)
q14old_mean_threes <- round(weighted.mean(summary_state_analysis_old$X137threes, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2)
q14old_mean_fours <- round(weighted.mean(summary_state_analysis_old$X137fours, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2)
q14_old_plot<-c(q14old_mean_ones,q14old_mean_twos,q14old_mean_threes,q14old_mean_fours)
q14_old_plotdta <- data.frame(q14_old_plot, q14_plotlabels) 
q14_old_plotdta$wrapped_labels = str_wrap(q14_old_plotdta$q14_plotlabels, width = 10)

q14_old_plot <- ggplot(q14_old_plotdta, aes(x = q14_plotlabels, y = q14_old_plot, fill = q14_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q14_old_plot),"%"), vjust=-0.3), size=6)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "2011 and Before") +
  disaggtheme

q14_former_plot<-c(summary_state_former$X137ones*100, summary_state_former$X137twos*100, summary_state_former$X137threes*100, summary_state_former$X137fours*100)
q14_former_plotdta <- data.frame(q14_former_plot, q14_plotlabels) 
q14_former_plotdta$wrapped_labels = str_wrap(q14_former_plotdta$q14_plotlabels, width = 10)

q14_former_plot <- ggplot(q14_former_plotdta, aes(x = q14_plotlabels, y = q14_former_plot, fill = q14_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q14_former_plot),"%"), vjust=-0.3), size=6)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "Former Officers") +
  disaggtheme

legend14 <- cowplot::get_legend(q14_former_plot) 
q14_former_plot <- q14_former_plot +theme(legend.position = "none")
plot14_fullage <- plot_grid(q14_young_plot,q14_old_plot,q14_former_plot,
                             nrow = 1)
plot14_fullage <- plot_grid(plot14_fullage, legend14, nrow = 2, rel_heights=c(5,2)) 
plot14_fullage
```
\newpage

## Question 14: Disaggregated by SDG

The government support for India’s huge vaccine production capacity appears to have been limited compared to many other countries. Pick the option that you think is the most important reason.  

\vspace{6mm}
```{r, echo = FALSE, fig.height=10,fig.width=18}
#Calculating weighted means
q14aspt_mean_ones <- round(weighted.mean(summary_state_analysis$X137ones[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)
q14aspt_mean_twos <- round(weighted.mean(summary_state_analysis$X137twos[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)
q14aspt_mean_threes <- round(weighted.mean(summary_state_analysis$X137threes[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)
q14aspt_mean_fours <- round(weighted.mean(summary_state_analysis$X137fours[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)

q14frnt_mean_ones <- round(weighted.mean(summary_state_analysis$X137ones[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)
q14frnt_mean_twos <- round(weighted.mean(summary_state_analysis$X137twos[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)
q14frnt_mean_threes <- round(weighted.mean(summary_state_analysis$X137threes[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)
q14frnt_mean_fours <- round(weighted.mean(summary_state_analysis$X137fours[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)

q14perf_mean_ones <- round(weighted.mean(summary_state_analysis$X137ones[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)
q14perf_mean_twos <- round(weighted.mean(summary_state_analysis$X137twos[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)
q14perf_mean_threes <- round(weighted.mean(summary_state_analysis$X137threes[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)
q14perf_mean_fours <- round(weighted.mean(summary_state_analysis$X137fours[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)

#Forming vectors 
q14aspt_plot <- c(q14aspt_mean_ones, q14aspt_mean_twos, q14aspt_mean_threes, q14aspt_mean_fours)
q14frnt_plot <- c(q14frnt_mean_ones, q14frnt_mean_twos, q14frnt_mean_threes, q14frnt_mean_fours)
q14perf_plot <- c(q14perf_mean_ones, q14perf_mean_twos, q14perf_mean_threes, q14perf_mean_fours)

q14full_plot_labels <- c("The government's fiscal situation did not permit such measures.", "The pandemic's limited initial impact led to a view that mass vaccination would not be urgently \n required in India.", "The private sector in India does not inspire confidence.", "The private sector makes profits and should therefore assume the risk involved.") 

#constructing data frames
q14aspt_plot_dta <- data.frame(q14aspt_plot, q14full_plot_labels)
q14frnt_plot_dta <- data.frame(q14frnt_plot, q14full_plot_labels)
q14perf_plot_dta <- data.frame(q14perf_plot, q14full_plot_labels)

#wrapping labels
q14aspt_plot_dta$wrapped_labels = str_wrap(q14aspt_plot_dta$q14full_plot_labels, width = 50)
q14frnt_plot_dta$wrapped_labels = str_wrap(q14frnt_plot_dta$q14full_plot_labels, width = 50)
q14perf_plot_dta$wrapped_labels = str_wrap(q14perf_plot_dta$q14full_plot_labels, width = 50)

#Invoking ggplot
q14aspt_plot <- ggplot(q14aspt_plot_dta, aes(x=q14full_plot_labels, y=q14aspt_plot, fill = q14full_plot_labels)) +
  geom_bar(stat="identity", width=0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q14aspt_plot),"%"), vjust=-0.3), size=6) +
  scale_y_continuous(limits = c(0,100))  +
  labs(x="",y="Percent", title = "Aspirant States")  +
  scale_x_discrete(labels= c("","","","","")) +
  scale_fill_brewer(palette="YlGnBu") +
  disaggtheme

q14perf_plot <- ggplot(q14perf_plot_dta, aes(x=q14full_plot_labels, y=q14perf_plot, fill = q14full_plot_labels)) +
  geom_bar(stat="identity", width=0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q14perf_plot),"%"), vjust=-0.3), size=6) +
  scale_y_continuous(limits = c(0,100)) +
  labs(x="",y="Percent", title = "Performer States") +
  scale_x_discrete(labels= c("","","","","")) +
  scale_fill_brewer(palette="YlGnBu") +
  disaggtheme

q14frnt_plot_temp <- ggplot(q14frnt_plot_dta, aes(x=q14full_plot_labels, y=q14frnt_plot, fill = q14full_plot_labels)) +
  geom_bar(stat="identity", width=0.5, show.legend = TRUE) + 
  geom_text(aes(label=scales::percent(q14frnt_plot/100)), vjust=-0.3, size=6) +
  scale_y_continuous(limits = c(0,100)) +
  labs(x="",y="Percent", title = "Frontrunner States") +
  scale_x_discrete(labels= c("","","","","")) +
  scale_fill_brewer(palette="YlGnBu") +
  disaggtheme

legend14 <- cowplot::get_legend(q14frnt_plot_temp)
q14frnt_plot <- q14frnt_plot_temp + theme(legend.position = "none")
q14_fullsdg <- plot_grid(q14aspt_plot,q14perf_plot,q14frnt_plot, nrow=1)
q14_fullsdg <- plot_grid(q14_fullsdg,legend14, nrow = 2, rel_heights=c(5,2))
q14_fullsdg
```
\newpage

## Question 15: Aggregate Graph

To what extent would you agree with the following statement? 
"NGOs and civil society rendered critical assistance to pandemic management in 2020. While they played an important role in the second wave (particularly for oxygen, hospital beds and food relief), increased regulation of their fundraising and activities has come in the way of their playing an even bigger role."

\vspace{6mm}
```{r}
q15full_mean_ones <- round(weighted.mean(summary_state_analysis$X138ones, summary_state_analysis$state_weight)*100,2) 
q15full_mean_twos <- round(weighted.mean(summary_state_analysis$X138twos, summary_state_analysis$state_weight)*100,2) 
q15full_mean_threes <- round(weighted.mean(summary_state_analysis$X138threes, summary_state_analysis$state_weight)*100,2)
q15full_mean_fours <- round(weighted.mean(summary_state_analysis$X138fours, summary_state_analysis$state_weight)*100,2)
q15full_plot <- c(q15full_mean_fours, q15full_mean_twos,q15full_mean_ones, q15full_mean_threes) 
q15full_plot_labels <- c("Strongly disagree", "Slightly disagree", "Slightly agree", "Strongly agree") 
q15full_plot_dta <- data.frame(q15full_plot, q15full_plot_labels) 

q15full_plot_dta$q15full_plot_labels <- factor(q15full_plot_dta$q15full_plot_labels,
                                               levels = c("Strongly disagree", "Slightly disagree", "Slightly agree", "Strongly agree"))
q15full_plot <- ggplot(q15full_plot_dta, aes(x=q15full_plot_labels, y=q15full_plot, fill = q15full_plot_labels)) +
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q15full_plot),"%"), vjust=-0.3), size=3.5) +
  scale_y_continuous(limits = c(0,100)) +  
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent") +
  newtheme
q15full_plot
```
\newpage

## Question 15: Disaggregated by Age

To what extent would you agree with the following statement? 
"NGOs and civil society rendered critical assistance to pandemic management in 2020. While they played an important role in the second wave (particularly for oxygen, hospital beds and food relief), increased regulation of their fundraising and activities has come in the way of their playing an even bigger role."

\vspace{6mm}
```{r echo = FALSE, fig.height=10,fig.width=18}
q15_plotlabels <- c("Slightly agree", "Slightly disagree", "Strongly agree", "Strongly disagree")

q15young_mean_ones <- round(weighted.mean(summary_state_analysis_young$X138ones, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2) 
q15young_mean_twos <- round(weighted.mean(summary_state_analysis_young$X138twos, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2)
q15young_mean_threes <- round(weighted.mean(summary_state_analysis_young$X138threes, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2)
q15young_mean_fours <- round(weighted.mean(summary_state_analysis_young$X138fours, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2)
q15_young_plot<-c(q15young_mean_ones,q15young_mean_twos,q15young_mean_threes,q15young_mean_fours)
q15_young_plotdta <- data.frame(q15_young_plot, q15_plotlabels) 
q15_young_plotdta$wrapped_labels = str_wrap(q15_young_plotdta$q15_plotlabels, width = 10)
q15_young_plotdta$q15_plotlabels <- factor(q15_young_plotdta$q15_plotlabels,
                                               levels = c("Strongly disagree", "Slightly disagree", "Slightly agree", "Strongly agree"))

q15_young_plot <- ggplot(q15_young_plotdta, aes(x = q15_plotlabels, y = q15_young_plot, fill = q15_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q15_young_plot),"%"), vjust=-0.3), size=6)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "2012 and After") +
  disaggtheme

q15old_mean_ones <- round(weighted.mean(summary_state_analysis_old$X138ones, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2) 
q15old_mean_twos <- round(weighted.mean(summary_state_analysis_old$X138twos, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2)
q15old_mean_threes <- round(weighted.mean(summary_state_analysis_old$X138threes, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2)
q15old_mean_fours <- round(weighted.mean(summary_state_analysis_old$X138fours, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2)
q15_old_plot<-c(q15old_mean_ones,q15old_mean_twos,q15old_mean_threes,q15old_mean_fours)
q15_old_plotdta <- data.frame(q15_old_plot, q15_plotlabels) 
q15_old_plotdta$wrapped_labels = str_wrap(q15_old_plotdta$q15_plotlabels, width = 10)
q15_old_plotdta$q15_plotlabels <- factor(q15_old_plotdta$q15_plotlabels,
                                                 levels = c("Strongly disagree", "Slightly disagree", "Slightly agree", "Strongly agree"))

q15_old_plot <- ggplot(q15_old_plotdta, aes(x = q15_plotlabels, y = q15_old_plot, fill = q15_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q15_old_plot),"%"), vjust=-0.3), size=6)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "2011 and Before") +
  disaggtheme

q15_former_plot<-c(summary_state_former$X138ones*100, summary_state_former$X138twos*100, summary_state_former$X138threes*100, summary_state_former$X138fours*100)
q15_former_plotdta <- data.frame(q15_former_plot, q15_plotlabels) 
q15_former_plotdta$wrapped_labels = str_wrap(q15_former_plotdta$q15_plotlabels, width = 10)
q15_former_plotdta$q15_plotlabels <- factor(q15_former_plotdta$q15_plotlabels,
                                             levels = c("Strongly disagree", "Slightly disagree", "Slightly agree", "Strongly agree"))

q15_former_plot <- ggplot(q15_former_plotdta, aes(x = q15_plotlabels, y = q15_former_plot, fill = q15_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q15_former_plot),"%"), vjust=-0.3), size=6)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "Former Officers") +
  disaggtheme

legend15 <- cowplot::get_legend(q15_former_plot) 
q15_former_plot <- q15_former_plot +theme(legend.position = "none")
plot15_fullage <- plot_grid(q15_young_plot,q15_old_plot,q15_former_plot,
                             nrow = 1)
  
plot15_fullage <- plot_grid(plot15_fullage, legend15, nrow = 2, rel_heights=c(5,2)) 
plot15_fullage
```
\newpage

## Question 15: Disaggregated by SDG

To what extent would you agree with the following statement? "NGOs and civil society rendered critical assistance to pandemic management in 2020. While they played an important role in the second wave (particularly for oxygen, hospital beds and food relief), increased regulation of their fundraising and activities has come in the way of their playing an even bigger role."

\vspace{6mm}
```{r, echo = FALSE, fig.height=10,fig.width=18}
#Calculating weighted means
q15aspt_mean_ones <- round(weighted.mean(summary_state_analysis$X138ones[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)
q15aspt_mean_twos <- round(weighted.mean(summary_state_analysis$X138twos[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)
q15aspt_mean_threes <- round(weighted.mean(summary_state_analysis$X138threes[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)
q15aspt_mean_fours <- round(weighted.mean(summary_state_analysis$X138fours[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)

q15perf_mean_ones <- round(weighted.mean(summary_state_analysis$X138ones[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)
q15perf_mean_twos <- round(weighted.mean(summary_state_analysis$X138twos[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)
q15perf_mean_threes <- round(weighted.mean(summary_state_analysis$X138threes[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)
q15perf_mean_fours <- round(weighted.mean(summary_state_analysis$X138fours[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)

q15frnt_mean_ones <- round(weighted.mean(summary_state_analysis$X138ones[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)
q15frnt_mean_twos <- round(weighted.mean(summary_state_analysis$X138twos[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)
q15frnt_mean_threes <- round(weighted.mean(summary_state_analysis$X138threes[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)
q15frnt_mean_fours <- round(weighted.mean(summary_state_analysis$X138fours[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)

#Forming vectors 
q15aspt_plot <- c(q15aspt_mean_ones, q15aspt_mean_twos, q15aspt_mean_threes, q15aspt_mean_fours)
q15perf_plot <- c(q15perf_mean_ones, q15perf_mean_twos, q15perf_mean_threes, q15perf_mean_fours)
q15frnt_plot <- c(q15frnt_mean_ones, q15frnt_mean_twos, q15frnt_mean_threes, q15frnt_mean_fours)

q15full_plot_labels <- c("Slightly agree", "Slightly disagree", "Strongly agree", "Strongly disagree")

#constructing data frames
q15aspt_plot_dta <- data.frame(q15aspt_plot, q15full_plot_labels)
q15perf_plot_dta <- data.frame(q15perf_plot, q15full_plot_labels)
q15frnt_plot_dta <- data.frame(q15frnt_plot, q15full_plot_labels)

#Levelling labels
q15aspt_plot_dta$q15full_plot_labels <- factor(q15aspt_plot_dta$q15full_plot_labels,
                                               levels = c("Strongly disagree", "Slightly disagree", "Slightly agree", "Strongly agree"))

q15perf_plot_dta$q15full_plot_labels <- factor(q15perf_plot_dta$q15full_plot_labels,
                                               levels = c("Strongly disagree", "Slightly disagree", "Slightly agree", "Strongly agree"))

q15frnt_plot_dta$q15full_plot_labels <- factor(q15frnt_plot_dta$q15full_plot_labels,
                                               levels = c("Strongly disagree", "Slightly disagree", "Slightly agree", "Strongly agree"))

#Invoking ggplot
q15aspt_plot <- ggplot(q15aspt_plot_dta, aes(x=q15full_plot_labels, y=q15aspt_plot, fill = q15full_plot_labels)) +
  geom_bar(stat="identity", width=0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q15aspt_plot),"%"), vjust=-0.3), size=6) +
  scale_y_continuous(limits = c(0,100))  +
  labs(x="",y="Percent", title = "Aspirant States")  +
  scale_x_discrete(labels= c("","","","","")) +
  scale_fill_brewer(palette="YlGnBu") +
  disaggtheme

q15perf_plot <- ggplot(q15perf_plot_dta, aes(x=q15full_plot_labels, y=q15perf_plot, fill = q15full_plot_labels)) +
  geom_bar(stat="identity", width=0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q15perf_plot),"%"), vjust=-0.3), size=6) +
  scale_y_continuous(limits = c(0,100)) +
  labs(x="",y="Percent", title = "Performer States") +
  scale_x_discrete(labels= c("","","","","")) +
  scale_fill_brewer(palette="YlGnBu") +
  disaggtheme

q15frnt_plot_temp <- ggplot(q15frnt_plot_dta, aes(x=q15full_plot_labels, y=q15frnt_plot, fill = q15full_plot_labels)) +
  geom_bar(stat="identity", width=0.5, show.legend = TRUE) + 
  geom_text(aes(label=scales::percent(q15frnt_plot/100)), vjust=-0.3, size=6) +
  scale_y_continuous(limits = c(0,100)) +
  labs(x="",y="Percent", title = "Frontrunner States") +
  scale_x_discrete(labels= c("","","","","")) +
  scale_fill_brewer(palette="YlGnBu") +
  disaggtheme

legend15 <- cowplot::get_legend (q15frnt_plot_temp)
q15frnt_plot <- q15frnt_plot_temp + theme(legend.position = "none")
q15_fullsdg <- plot_grid(q15aspt_plot,q15perf_plot,q15frnt_plot, nrow=1)
q15_fullsdg <- plot_grid(q15_fullsdg,legend15, nrow = 2, rel_heights=c(5,2))
q15_fullsdg
```
\newpage

## Question 16: Aggregate Graph

Which of the following statements best describes the media’s coverage of the pandemic?

\vspace{6mm}
```{r}
q16full_mean_ones <- round(weighted.mean(summary_state_analysis$X139ones, summary_state_analysis$state_weight)*100,2) 
q16full_mean_twos <- round(weighted.mean(summary_state_analysis$X139twos, summary_state_analysis$state_weight)*100,2) 
q16full_mean_threes <- round(weighted.mean(summary_state_analysis$X139threes, summary_state_analysis$state_weight)*100,2)
q16full_plot <- c(q16full_mean_ones, q16full_mean_twos, q16full_mean_threes) 
q16full_plot_labels <- c("By focussing on failures in pandemic management, the media has exaggerated the sense of failure and despair.", "The media has failed to capture the full scale and intensity of the disaster.", "The media has made an effort to communicate a realistic picture and rightly drawn attention to the inadequate government response at various places.") 
q16full_plot_dta <- data.frame(q16full_plot, q16full_plot_labels) 
q16full_plot_dta$wrapped_labels = str_wrap(q16full_plot_dta$q16full_plot_labels, width = 10)
q16full_plot <- ggplot(q16full_plot_dta, aes(x=q16full_plot_labels, y=q16full_plot, fill = q16full_plot_labels)) +
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q16full_plot),"%"), vjust=-0.3), size=3.5)+ 
  scale_y_continuous(limits = c(0,100)) +
  scale_x_discrete(labels = function(q16full_plot_labels) str_wrap(q16full_plot_labels, width = 30)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent") +
  newtheme
q16full_plot
```
\newpage

## Question 16: Dis-ggregated by Age

Which of the following statements best describes the media’s coverage of the pandemic?

\vspace{6mm}
```{r echo = FALSE, fig.height=10,fig.width=18}
q16_plotlabels <- c("By focussing on failures in pandemic management, the media has exaggerated the sense of failure \n and despair.", "The media has failed to capture the full scale and intensity of the disaster.", "The media has made an effort to communicate a realistic picture and rightly drawn attention to the \n inadequate government response at various places.")

q16young_mean_ones <- round(weighted.mean(summary_state_analysis_young$X139ones, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2) 
q16young_mean_twos <- round(weighted.mean(summary_state_analysis_young$X139twos, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2)
q16young_mean_threes <- round(weighted.mean(summary_state_analysis_young$X139threes, summary_state_analysis_young$state_young_weight, na.rm = TRUE)*100,2)
q16_young_plot<-c(q16young_mean_ones,q16young_mean_twos,q16young_mean_threes)
q16_young_plotdta <- data.frame(q16_young_plot, q16_plotlabels) 
q16_young_plotdta$wrapped_labels = str_wrap(q16_young_plotdta$q16_plotlabels, width = 10)

q16_young_plot <- ggplot(q16_young_plotdta, aes(x = q16_plotlabels, y = q16_young_plot, fill = q16_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q16_young_plot),"%"), vjust=-0.3), size=5)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "2012 and After") +
  disaggtheme

q16old_mean_ones <- round(weighted.mean(summary_state_analysis_old$X139ones, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2) 
q16old_mean_twos <- round(weighted.mean(summary_state_analysis_old$X139twos, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2)
q16old_mean_threes <- round(weighted.mean(summary_state_analysis_old$X139threes, summary_state_analysis_old$state_old_weight, na.rm = TRUE)*100,2)
q16_old_plot<-c(q16old_mean_ones,q16old_mean_twos,q16old_mean_threes)
q16_old_plotdta <- data.frame(q16_old_plot, q16_plotlabels) 
q16_old_plotdta$wrapped_labels = str_wrap(q16_old_plotdta$q16_plotlabels, width = 10)

q16_old_plot <- ggplot(q16_old_plotdta, aes(x = q16_plotlabels, y = q16_old_plot, fill = q16_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q16_old_plot),"%"), vjust=-0.3), size=5)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "2011 and Before") +
  disaggtheme

q16_former_plot<-c(summary_state_former$X139ones*100, summary_state_former$X139twos*100, summary_state_former$X139threes*100)
q16_former_plotdta <- data.frame(q16_former_plot, q16_plotlabels) 
q16_former_plotdta$wrapped_labels = str_wrap(q16_former_plotdta$q16_plotlabels, width = 10)

q16_former_plot <- ggplot(q16_former_plotdta, aes(x = q16_plotlabels, y = q16_former_plot, fill = q16_plotlabels )) +  
  geom_bar(stat="identity", width= 0.5) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q16_former_plot),"%"), vjust=-0.3), size=5)+ 
  scale_x_discrete(labels= c("","","","",""))+
  scale_y_continuous(limits = c(0,100)) +
  scale_fill_brewer(palette="YlGnBu") +
  labs(x="",y="Percent", title = "Former Officers") +
  disaggtheme

legend16 <- cowplot::get_legend(q16_former_plot) 
q16_former_plot <- q16_former_plot +theme(legend.position = "none")
plot16_fullage <- plot_grid(q16_young_plot,q16_old_plot,q16_former_plot,
                             nrow = 1)
plot16_fullage <- plot_grid(plot16_fullage, legend16, nrow = 2, rel_heights=c(5,2)) 
plot16_fullage
```
\newpage

## Question 16: Disaggregated by SDG

Which of the following statements best describes the media’s coverage of the pandemic?

\vspace{6mm}
```{r, echo = FALSE, fig.height=10, fig.width=18}
#Calculating weighted means
q16aspt_mean_ones <- round(weighted.mean(summary_state_analysis$X139ones[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)
q16aspt_mean_twos <- round(weighted.mean(summary_state_analysis$X139twos[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)
q16aspt_mean_threes <- round(weighted.mean(summary_state_analysis$X139threes[summary_state_analysis$sdg_tier=="Aspirant"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Aspirant"])*100,2)

q16frnt_mean_ones <- round(weighted.mean(summary_state_analysis$X139ones[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)
q16frnt_mean_twos <- round(weighted.mean(summary_state_analysis$X139twos[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)
q16frnt_mean_threes <- round(weighted.mean(summary_state_analysis$X139threes[summary_state_analysis$sdg_tier=="Frontrunner"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Frontrunner"])*100,2)

q16perf_mean_ones <- round(weighted.mean(summary_state_analysis$X139ones[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)
q16perf_mean_twos <- round(weighted.mean(summary_state_analysis$X139twos[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)
q16perf_mean_threes <- round(weighted.mean(summary_state_analysis$X139threes[summary_state_analysis$sdg_tier=="Performer"], summary_state_analysis$sdg_weight[summary_state_analysis$sdg_tier=="Performer"])*100,2)

#Forming vectors 
q16aspt_plot <- c(q16aspt_mean_ones, q16aspt_mean_twos, q16aspt_mean_threes)
q16frnt_plot <- c(q16frnt_mean_ones, q16frnt_mean_twos, q16frnt_mean_threes)
q16perf_plot <- c(q16perf_mean_ones, q16perf_mean_twos, q16perf_mean_threes)

q16full_plot_labels <- c("By focussing on failures in pandemic management, the media has exaggerated the sense of failure \n and despair.", "The media has failed to capture the full scale and intensity of the disaster.", "The media has made an effort to communicate a realistic picture and rightly drawn attention to the \n inadequate government response at \n various places.") 

#constructing data frames
q16aspt_plot_dta <- data.frame(q16aspt_plot, q16full_plot_labels)
q16frnt_plot_dta <- data.frame(q16frnt_plot, q16full_plot_labels)
q16perf_plot_dta <- data.frame(q16perf_plot, q16full_plot_labels)

#wrapping labels
q16aspt_plot_dta$wrapped_labels = str_wrap(q16aspt_plot_dta$q16full_plot_labels, width = 50)
q16frnt_plot_dta$wrapped_labels = str_wrap(q16frnt_plot_dta$q16full_plot_labels, width = 50)
q16perf_plot_dta$wrapped_labels = str_wrap(q16perf_plot_dta$q16full_plot_labels, width = 50)

#Invoking ggplot
q16aspt_plot <- ggplot(q16aspt_plot_dta, aes(x=q16full_plot_labels, y=q16aspt_plot, fill = q16full_plot_labels)) +
  geom_bar(stat="identity", width=0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q16aspt_plot),"%"), vjust=-0.3), size=6) +
  scale_y_continuous(limits = c(0,100))  +
  labs(x="",y="Percent", title ="Aspirant States")  +
  scale_x_discrete(labels= c("","","","","")) +
  scale_fill_brewer(palette="YlGnBu") +
  disaggtheme

q16perf_plot <- ggplot(q16perf_plot_dta, aes(x=q16full_plot_labels, y=q16perf_plot, fill = q16full_plot_labels)) +
  geom_bar(stat="identity", width=0.5, show.legend = FALSE) + 
  geom_text(aes(label=paste0(sprintf("%0.2f", q16perf_plot),"%"), vjust=-0.3), size=6) +
  scale_y_continuous(limits = c(0,100)) +
  labs(x="",y="Percent", title = "Performer States") +
  scale_x_discrete(labels= c("","","","","")) +
  scale_fill_brewer(palette="YlGnBu")  +
  disaggtheme

q16frnt_plot_temp <- ggplot(q16frnt_plot_dta, aes(x=q16full_plot_labels, y=q16frnt_plot, fill = q16full_plot_labels)) +
  geom_bar(stat="identity", width=0.5, show.legend = TRUE) + 
  geom_text(aes(label=scales::percent(q16frnt_plot/100)), vjust=-0.3, size=6) +
  scale_y_continuous(limits = c(0,100)) +
  labs(x="",y="Percent", title = "Frontrunner States") +
  scale_x_discrete(labels= c("","","","","")) +
  scale_fill_brewer(palette="YlGnBu") +
  disaggtheme

legend16<- cowplot::get_legend(q16frnt_plot_temp)
q16frnt_plot <- q16frnt_plot_temp +theme(legend.position = "none", legend.spacing = unit(2.0,'inches'))
q16_fullsdg <- plot_grid(q16aspt_plot,q16perf_plot,q16frnt_plot, nrow=1)
q16_fullsdg <- plot_grid(q16_fullsdg,legend16, nrow = 2, rel_heights=c(5,2))
q16_fullsdg
```